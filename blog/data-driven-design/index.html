<!doctype html><html lang=en><head><meta charset=UTF-8><title>Data Driven Design(DDD)</title><link rel=stylesheet href=/css/style.css><link href=https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/prismjs@1/prism.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-csharp.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-cpp.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-json.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-bash.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-text.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-ini.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-c.min.js></script><link rel=stylesheet href=/css/blogsingle.css></head><body><header><title>How to Develop a Game</title><div class=container><img src=/images/gamelife.jpg alt="Data Driven Design(DDD)" class=banner></div></header><nav class=topnav><div class=container><ul><li><a href=/>Home</a></li><li><a href=/article/>Article</a></li><li><a href=/blog/>Blog</a></li><li><a href=/projects/>Projects</a></li><li><a href=/tool/>Tool & Resource</a></li><li><a href=/reference/>Reference</a></li><li><a href=/about/>About</a></li></ul></div></nav><article class=single_article><div class=title>Data Driven Design(DDD)<div class=meta>PublishDate: 2025-06-01 |
CreateDate: 2025-06-01 |
LastModify: 2025-06-01
| Creator：ljf12825</div></div><div class=content><p>Data-Driven Design（数据驱动设计）在Unity和游戏开发中是一种将逻辑与数据分离的编程范式，它强调用数据来控制行为和流程，而不是把所有逻辑写死在代码中</p><p>尤其在Unity这样一个组件化的引擎中，数据驱动设计可以提高灵活性、可扩展性、可复用性、可配置性，广泛用于角色配置、关卡编辑、AI行为、技能系统、特效系统、任务系统等</p><h2 id=核心思想>核心思想</h2><p>传统方式</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>void</span> Attack()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (type == <span style=color:#e6db74>&#34;Fire&#34;</span>) DoFireAttack();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (type == <span style=color:#e6db74>&#34;Ice&#34;</span>) DoIceAttack();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>上面是硬编码方式，未来加新类型必须改代码</p><p>数据驱动方式</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;attackType&#34;</span>: <span style=color:#e6db74>&#34;Fire&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;damage&#34;</span>: <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;cooldown&#34;</span>: <span style=color:#ae81ff>2.5</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在代码中只需要</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>AttackConfig config = LoadAttackConfig(<span style=color:#e6db74>&#34;Fire&#34;</span>);
</span></span><span style=display:flex><span>Execute(config);
</span></span></code></pre></div><h2 id=在unity中的实践方式>在Unity中的实践方式</h2><table><thead><tr><th>层级</th><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>数据定义</td><td>ScriptableObject / JSON / XML / Excel / CSV</td><td>描述数据结构和配置项</td></tr><tr><td>数据驱动器</td><td>MonoBehaviour / System / Manager</td><td>根据配置文件动态生成游戏逻辑或行为</td></tr><tr><td>运行时绑定</td><td>Addressable / Resources.Load / AssetBundle</td><td>运行时加载配置和资源</td></tr><tr><td>编辑器扩展</td><td>CustomEditor / ScriptedImporter</td><td>使数据更好地可视化配置</td></tr></tbody></table><h2 id=实例>实例</h2><ol><li>ScriptableObject驱动角色技能系统</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#a6e22e>[CreateAssetMenu(fileName = &#34;SkillData&#34;, menuName = &#34;GameData/Skill&#34;)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SkillData</span> : ScriptableObject
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> skillName;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>float</span> damage;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>float</span> cooldonw;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> GameObject effectPrefab;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>技能执行器</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SkillExecutor</span> : MonoBehaviour
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> SkillData skill;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> Cast()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Debug.Log(<span style=color:#e6db74>$&#34;Casting {skill.skillName}&#34;</span>)
</span></span><span style=display:flex><span>        Instantiate(skill.effectPrefab, transform.position, Quaternion.identity);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>JSON配置敌人AI行为</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;enemyType&#34;</span>: <span style=color:#e6db74>&#34;Goblin&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;health&#34;</span>: <span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;aggressive&#34;</span>: <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;attackRange&#34;</span>: <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;patrolPath&#34;</span>: [<span style=color:#e6db74>&#34;(0,0)&#34;</span>, <span style=color:#e6db74>&#34;(5,0)&#34;</span>, <span style=color:#e6db74>&#34;(5, 5)&#34;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>通过反序列化加载为结构体</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EnemyData</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> enemyType;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> health;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> aggressive;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>float</span> attackRange;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Vector3[] patrolPath;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>运行时构建敌人</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EnemySpawner</span> : MonoBehaviour
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> Spawn(<span style=color:#66d9ef>string</span> jsonPath)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> json = File.ReadAllText(jsonPath);
</span></span><span style=display:flex><span>        EnemyData data = JsonUtility.FromJson&lt;EnemyData&gt;(json);
</span></span><span style=display:flex><span>        GameObject enemy = Instantiate(enemyPrefab);
</span></span><span style=display:flex><span>        enemy.GetComponent&lt;EnemyController&gt;().Init(data);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=与addressable--assetbundle搭配>与Addressable / AssetBundle搭配</h2><p>如果使用Addressable / AssetBundle管理资源，可以通过配置文件映射资源路径，使得整个资源系统也数据驱动</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;prefabName&#34;</span>: <span style=color:#e6db74>&#34;EnemyGoblin&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;addressableKey&#34;</span>: <span style=color:#e6db74>&#34;Enemies/Goblin&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>运行时动态加载</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>Addressables.LoadAssetAsync&lt;GameObject&gt;(config.addressableKey);
</span></span></code></pre></div><h2 id=unity中数据驱动设计的典型应用场景>Unity中数据驱动设计的典型应用场景</h2><ul><li>角色属性（等级、血量、攻击力）</li><li>物品数据（ID、名称、描述、稀有度、价格）</li><li>技能表（技能ID、冷却时间、动画、特效）</li><li>任务配置（触发条件、奖励内容）</li><li>UI配置（按钮样式、位置、颜色）</li><li>场景数据（NPC分布、出生点等）</li></ul><p>优势</p><ul><li>高度灵活：不改代码即可更改游戏行为</li><li>可复用性高：一套逻辑可用多个配置</li><li>解耦：数据和逻辑分离，程序和非程序互不干扰</li><li>支持热更：JSON + Addressable更方便做热更系统</li><li>便于测试和迭代：只调数据，不改逻辑</li></ul><p>注意</p><ul><li>性能开销：数据结构过多需管理内存，加载及时性要考虑</li><li>数据管理混乱：强化编辑器支持，规范命名、文件结构</li><li>可测试性下降：建议加断言、数据验证工具</li><li>可读性问题：配置文件冗长时需工具辅助查看</li></ul><h3 id=常见的配置表格式>常见的配置表格式</h3><table><thead><tr><th>格式</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td><strong>CSV</strong></td><td>简单、轻量、跨平台</td><td>不支持嵌套结构，数据易出错</td></tr><tr><td><strong>Excel (XLS/XLSX)</strong></td><td>支持复杂结构，便于策划编辑</td><td>Unity运行时读取需处理依赖或转换</td></tr><tr><td><strong>JSON</strong></td><td>可嵌套、结构清晰，跨语言</td><td>文件体积相对大，读取开销稍大</td></tr><tr><td><strong>XML</strong></td><td>结构化强，支持嵌套</td><td>比JSON繁琐，不够灵活</td></tr><tr><td><strong>ScriptableObject</strong></td><td>Unity原生支持，性能高</td><td>策划不易编辑，编辑器依赖强</td></tr><tr><td><strong>二进制（自定义格式）</strong></td><td>高效、节省空间</td><td>可读性差，调试困难</td></tr></tbody></table><h4 id=csvcomma-separated-values>CSV(Comma-Separated Values)</h4><p>CSV是一种纯文本格式，用逗号<code>,</code>分隔数据，用于表示表格结构的数据</p><ul><li>每一行是一条记录（record）</li><li>每一列是一个字段（field）
例如，一个简单的角色配置CSV文件：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csv data-lang=csv><span style=display:flex><span><span style=color:#e6db74>id</span>,<span style=color:#e6db74>name</span>,<span style=color:#e6db74>hp</span>,<span style=color:#e6db74>attack</span>,<span style=color:#e6db74>defense</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>1001</span>,<span style=color:#e6db74>Warrior</span>,<span style=color:#e6db74>500</span>,<span style=color:#e6db74>70</span>,<span style=color:#e6db74>30</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>1002</span>,<span style=color:#e6db74>Archer</span>,<span style=color:#e6db74>300</span>,<span style=color:#e6db74>100</span>,<span style=color:#e6db74>10</span>
</span></span></code></pre></div><p><strong>规则</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csv data-lang=csv><span style=display:flex><span><span style=color:#e6db74>列1</span>,<span style=color:#e6db74>列2</span>,<span style=color:#e6db74>列3</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>值1</span>,<span style=color:#e6db74>值2</span>,<span style=color:#e6db74>值3</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>值4</span>,<span style=color:#e6db74>值5</span>,<span style=color:#e6db74>值6</span>
</span></span></code></pre></div><p><strong>要素组成</strong></p><table><thead><tr><th>元素</th><th>说明</th></tr></thead><tbody><tr><td><strong>分隔符</strong></td><td>一般是英文逗号 <code>,</code>，也可以是 <code>;</code>、<code>\t</code>（Tab）等，称为“分隔符”</td></tr><tr><td><strong>换行符</strong></td><td>每一行代表一条记录，通常使用 <code>\n</code> 或 <code>\r\n</code> 结尾</td></tr><tr><td><strong>字段</strong></td><td>一行中的每个值称为字段，可以是数字、文本等</td></tr><tr><td><strong>表头</strong></td><td>第一行通常是字段名（列名）</td></tr><tr><td><strong>引号</strong></td><td>如果字段中包含逗号、引号或换行，应使用双引号 <code>"</code> 包住</td></tr><tr><td><strong>转义符</strong></td><td>字段中出现 <code>"</code>，需要写成 <code>""</code>（两个双引号表示一个双引号）</td></tr></tbody></table><ul><li>常见扩展名是<code>.csv</code></li><li>实质是UTF-8编码或ANSI编码的纯文本文件</li></ul><p><strong>建议</strong></p><ul><li>编码：推荐使用UTF-8无BOM编码，支持中文</li><li>分隔符：使用英文逗号<code>,</code>，如果含中文逗号会出错</li><li>字段值：建议全字段加<code>"</code>引号，避免格式问题</li><li>表头：必须有，且列名不能重复</li><li>空行：自动跳过或处理，否则程序容易报错</li><li>换行：字段中如有换行，一定要用<code>"</code>包裹</li></ul><p><strong>CSV的特点</strong></p><table><thead><tr><th>优点</th><th>说明</th></tr></thead><tbody><tr><td>简单直观</td><td>可以用 Excel、Google Sheets 打开、编辑</td></tr><tr><td>小文件</td><td>比 JSON、XML 体积更小，加载快</td></tr><tr><td>易于版本控制</td><td>文本文件可直接使用 Git 管理</td></tr><tr><td>策划友好</td><td>策划可以直接编辑，不依赖 Unity 编辑器</td></tr></tbody></table><table><thead><tr><th>缺点</th><th>说明</th></tr></thead><tbody><tr><td>不支持嵌套结构</td><td>不能直接表示数组、对象等复杂结构</td></tr><tr><td>容易出错</td><td>格式不规范容易出错（多写一个逗号、漏引号）</td></tr><tr><td>类型信息丢失</td><td>所有字段都是字符串，需自行转换成 int、float 等</td></tr><tr><td>转义麻烦</td><td>逗号、换行、双引号等内容要转义</td></tr></tbody></table><h5 id=unity中如何读取csv>Unity中如何读取CSV</h5><p>示例CSV文件（Resource/Configs/Character.csv）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csv data-lang=csv><span style=display:flex><span><span style=color:#e6db74>id</span>,<span style=color:#e6db74>name</span>,<span style=color:#e6db74>hp</span>,<span style=color:#e6db74>attack</span>,<span style=color:#e6db74>defense</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>1001</span>,<span style=color:#e6db74>Warrior</span>,<span style=color:#e6db74>500</span>,<span style=color:#e6db74>70</span>,<span style=color:#e6db74>30</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>1002</span>,<span style=color:#e6db74>Archer</span>,<span style=color:#e6db74>300</span>,<span style=color:#e6db74>100</span>,<span style=color:#e6db74>10</span>
</span></span></code></pre></div><p>对应的C#类</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ChaaracterConfig</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> id;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> hp;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> attack;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> defense;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>CSV读取工具（简化版）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Collections.Generic;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CSVReader</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> List&lt;CharacterConfig&gt; ReadCharacterConfigs(stirng path)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        List&lt;CharacterConfig&gt; configs = <span style=color:#66d9ef>new</span> List&lt;CharacterConfig&gt;();
</span></span><span style=display:flex><span>        TextAsset data = Resources.Load&lt;TextAsset&gt;(path);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span>[] lines = data.text.Split(<span style=color:#e6db74>&#39;\n&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>1</span>; i &lt; lines.Length; i++)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>string</span>.IsNullOrWhiteSpace(lines[i])) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span>[] values = lines[i].Trim().Split(<span style=color:#e6db74>&#39;,&#39;</span>);
</span></span><span style=display:flex><span>            CharacterConfig config = <span style=color:#66d9ef>new</span> CharacterConfig
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                id = <span style=color:#66d9ef>int</span>.Parse(<span style=color:#66d9ef>value</span>[<span style=color:#ae81ff>0</span>]),
</span></span><span style=display:flex><span>                name = values[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                hp = <span style=color:#66d9ef>int</span>.Parse(values[<span style=color:#ae81ff>2</span>]),
</span></span><span style=display:flex><span>                attack = <span style=color:#66d9ef>int</span>.Parse(values[<span style=color:#ae81ff>3</span>]),
</span></span><span style=display:flex><span>                defense = <span style=color:#66d9ef>int</span>.Parse(values[<span style=color:#ae81ff>4</span>])
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>            configs.Add(config);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> configs;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>使用方式</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>List&lt;CharacterConfig&gt; characters = CSVReader.ReadCharacterConfigs(<span style=color:#e6db74>&#34;Configs/Character&#34;</span>);
</span></span></code></pre></div><h5 id=建议>建议</h5><ul><li>类型转换：自定义一个字段解析函数，更加健壮</li><li>编码问题：保存为UTF-8防止中文乱码</li><li>换行和引号：注意转义规则，推荐用<code>\</code>包裹字段</li><li>大量CSV：用工具自动生成C#类和解析器（提高效率，减少错误）</li></ul><h4 id=excelxlsxlsx>Excel(XLS/XLSX)</h4><p><code>.xls</code> 全称Excel Binary File Format，Excel 97-2003的旧格式，基于二进制，不支持新特性
<code>.xlsx</code> 全称Excel Open XML Format，Excel 2007之后的默认格式，基于XML，体积更小，支持更多功能</p><p>推荐使用<code>.xlsx</code>因为：</p><ul><li>支持更大的数据表（行数超过65536）</li><li>更快、更稳定</li><li>更易解析（可通过第三方库读取）</li></ul><h5 id=excel格式的特点用于配置表>Excel格式的特点（用于配置表）</h5><table><thead><tr><th>优点</th><th>描述</th></tr></thead><tbody><tr><td><strong>结构清晰</strong></td><td>表格直观，易于管理字段</td></tr><tr><td><strong>可读性好</strong></td><td>策划可以直接编辑，无需代码知识</td></tr><tr><td><strong>支持复杂数据结构</strong></td><td>多 sheet、合并单元格、数据校验等</td></tr><tr><td><strong>富格式信息</strong></td><td>可做备注、着色、隐藏行列，提升协作效率</td></tr><tr><td><strong>可通过工具自动导出 CSV / JSON / ScriptableObject</strong></td><td></td></tr></tbody></table><table><thead><tr><th>缺点</th><th>描述</th></tr></thead><tbody><tr><td>Unity 运行时<strong>无法直接读取</strong> <code>.xls</code> 或 <code>.xlsx</code>，需要依赖插件或转格式</td><td></td></tr><tr><td>相对复杂</td><td>文件体积比 CSV/JSON 大，处理也更复杂</td></tr><tr><td>跨平台读取麻烦</td><td>Mono/IL2CPP 不原生支持解析 Office 格式</td></tr></tbody></table><h5 id=unity中使用excel的常见方式>Unity中使用Excel的常见方式</h5><p>推荐方式：Excel -> JSON/CSV -> Unity\</p><ol><li>策划编辑<code>.xlsx</code></li><li>程序通过工具自动导出为<code>.json</code>或<code>.csv</code></li><li>Unity运行时解析<code>.json</code>或<code>.csv</code> -> 转为C#对象</li></ol><h5 id=配套工具>配套工具</h5><ol><li>NPOI</li></ol><ul><li>支持在Unity中直接读取<code>.xls</code>，<code>.xlsx</code></li><li>跨平台、免费、开源</li></ul><ol start=2><li>ExcelDataReader</li></ol><ul><li>专注于制度Excel文件，轻量级</li><li>推荐用于工具链而非运行时</li></ul><ol start=3><li>自研导出工具链（Editor脚本）</li></ol><ul><li>Unity编辑器下使用Excel插件读取数据</li><li>自动生成JSON + C#类结构</li><li>可一键批量导入全部表格</li></ul><h5 id=弱类型>弱类型</h5><p>在用Excel配置表做游戏开发时，每一列的“数据类型”并不是自动明确的，因为Excel本质是弱类型的（所有单元格默认都是文本或数字），不像编程语言中那样有严格的类型系统<br>那Unity如何判断配置表中的每一列的类型是什么呢<br><strong>常见方式</strong></p><ol><li>程序根据第一行或第二行手动指定类型</li></ol><p>示例Excel表</p><table><thead><tr><th>name</th><th>hp</th><th>isBoss</th><th>tags</th></tr></thead><tbody><tr><td>string</td><td>int</td><td>bool</td><td>string[]</td></tr><tr><td>Goblin</td><td>200</td><td>false</td><td>weak</td></tr></tbody></table><p>第一行为字段名，第二行为字段类型，第三行开始才是数据</p><ol start=2><li>程序根据字段的值自动推断类型
缺点：不可靠</li></ol><ul><li>无法判断精度（int和float容易搞混）</li><li>值都是字符串时不饿能推断</li><li>解析错误不易发现</li></ul><ol start=3><li>通过外部配置文件指定类型
可以使用一个<code>.json</code>或<code>.xml</code>文件作为类型描述文件</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;MonsterConfig&#34;</span>:
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;int&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;string&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;hp&#34;</span>: <span style=color:#e6db74>&#34;int&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;isBoss&#34;</span>: <span style=color:#e6db74>&#34;bool&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;tags&#34;</span>: <span style=color:#e6db74>&#34;string[]&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>常见字段类型说明</strong></p><table><thead><tr><th>类型</th><th>Excel中的写法</th><th>Unity对应类型</th></tr></thead><tbody><tr><td>int</td><td>100</td><td><code>int</code></td></tr><tr><td>float</td><td>12.5</td><td><code>float</code></td></tr><tr><td>bool</td><td>true / false / 1 / 0</td><td><code>bool</code></td></tr><tr><td>string</td><td>hello</td><td><code>string</code></td></tr><tr><td>int[]</td><td>1</td><td>2</td></tr><tr><td>string[]</td><td>fire</td><td>ice</td></tr><tr><td>enum</td><td>Warrior</td><td>自定义 <code>enum</code></td></tr><tr><td>object</td><td>{&ldquo;x&rdquo;:1,&ldquo;y&rdquo;:2}</td><td>需要自定义解析</td></tr></tbody></table><h4 id=jsonjavascript-object-notation>JSON(JavaScript Object Notation)</h4><p>在Unity游戏开发中，JSON是非常常见的配置表格式，用于轻量级的数据交换和加载配置数据</p><p>JSON是一种结构化的数据格式，它使用键值对（K-V）和数组(Array)来表示数据，语法简洁，易于阅读<br>示例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>101</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Goblin&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;hp&#34;</span>: <span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;skills&#34;</span>: [<span style=color:#e6db74>&#34;slash&#34;</span>, <span style=color:#e6db74>&#34;bite&#34;</span>],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;isBoss&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h5 id=json数据类型>JSON数据类型</h5><table><thead><tr><th>类型</th><th>示例</th></tr></thead><tbody><tr><td>数字</td><td><code>123</code>, <code>-5</code>, <code>3.14</code></td></tr><tr><td>字符串</td><td><code>"hello"</code>, <code>"Goblin"</code></td></tr><tr><td>布尔值</td><td><code>true</code>, <code>false</code></td></tr><tr><td>数组</td><td><code>[1, 2, 3]</code>, <code>["a", "b"]</code></td></tr><tr><td>对象</td><td><code>{ "x": 1, "y": 2 }</code></td></tr><tr><td>null</td><td><code>null</code></td></tr></tbody></table><h5 id=unity中如何使用json>Unity中如何使用JSON</h5><p>Unity中通过<code>JsonUtility</code>或<code>Newtonsoft.Json</code>来处理JSON</p><ol><li><code>JsonUtility</code>（Unity自带，性能好，功能简单）
适合简单的数据结构（基础类型、List、数组、自定义<code>[Serializable]</code>类）
定义类</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#a6e22e>[System.Serializable]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Monster</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> id;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> hp;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span>[] skills;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>解析JSON->对象</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>string</span> json = {<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#e6db74>&#34;id\&#34;:101,\&#34;name\&#34;:\&#34;Goblin\&#34;,\&#34;hp\&#34;:100,\&#34;skills\&#34;:[\&#34;slash\&#34;,\&#34;bite\&#34;]}&#34;</span>;
</span></span><span style=display:flex><span>Monster monster = JsonUtility.FromJson&lt;Monster&gt;(json);
</span></span><span style=display:flex><span>Debug.Log(monster.name); <span style=color:#75715e>// Goblin</span>
</span></span></code></pre></div><p>对象->JSON</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>string</span> newJson = JsonUtility.ToJson(monster, <span style=color:#66d9ef>true</span>); <span style=color:#75715e>// true表示格式化输出</span>
</span></span></code></pre></div><p><code>JsonUtility</code> API</p><p><strong>Static Methods</strong></p><table><thead><tr><th>Method</th><th>Description</th><th>AddOn</th></tr></thead><tbody><tr><td><code>FromJson&lt;T>(string json)</code></td><td>从JSON反序列化成对象</td><td></td></tr><tr><td><code>FromJsonOverwrite(string json, object objectToOverwrite)</code></td><td>从JSON数据反序列化到现有对象</td><td>不会新创建对象</td></tr><tr><td><code>ToJson(object obj ,bool prettyPrint = false)</code></td><td>将对象序列化为JSON字符串</td><td><code>prettyPrint</code>为是否美化输出，true会有换行和缩进</td></tr></tbody></table><p><strong>注意事项</strong></p><ul><li>必须标记<code>[Serializable]</code>才能序列化自定义类（MonoBehaviour/ScriptableObject派生类自动可序列化）</li><li>只能序列化字段，<code>public</code>或<code>[SerializeField] private</code></li><li>不支持字典，需要用两个List代替</li><li>不支持属性（<code>get/set</code>）</li><li>数组/List必须再对象中作为字段存在，不能直接反序列化成List</li></ul><p><strong>示例</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.IO;
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>[System.Serializable]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PlayerData</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> playername;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> score;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SaverManager</span> : MonoBehaviour
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    privte <span style=color:#66d9ef>string</span> filePath;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> Awake()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 持久化路径（跨平台安全）</span>
</span></span><span style=display:flex><span>        filePath = Application.persistentDataPath + <span style=color:#e6db74>&#34;playerData.json&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Save(PlayerData data)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 1.序列化成JSON</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> json = JsonUtility.ToJson(data, <span style=color:#66d9ef>true</span>); <span style=color:#75715e>// true = 格式化输出</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 2.写文件</span>
</span></span><span style=display:flex><span>        File.WriteAllText(filePath, json);
</span></span><span style=display:flex><span>        Debug.Log(<span style=color:#e6db74>&#34;保存成功： &#34;</span> + filePath);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> PlayerData Load()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (File.Exists(filePath))
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 1. 读文件</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> json = File.ReadAllText(filePath);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 2. 反序列化</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> JsonUtility.FromJson&lt;PlayerData&gt;(json);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> nulll;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li><code>Newtonsoft.Json</code>（功能强大，支持Dictionary、List、动态字段等）
需要安装Json.NET for Unity<br>优点：支持Dictionary、泛型、多态等
缺点：外部库，序列化速度比Unity内置的略慢</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> Newtonsoft.Json;
</span></span></code></pre></div><p>解析JSON->对象</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>Monster monster = JsonConvert.DeserializeObject&lt;Monster&gt;(json);
</span></span></code></pre></div><p>对象->JSON</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>string</span> json = JsonConvert.SerializeObject(monster, Formatting.Indented);
</span></span></code></pre></div><p><strong>示例</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> Newtonsoft.Json;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.IO;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Collections.Generic;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SaveManagerNewton</span> : MonoBehaviour
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>string</span> filePath;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> Awake()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        filePath = Application.persistentDataPath + <span style=color:#e6db74>&#34;/playerData.json&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Save(Dictionary&lt;<span style=color:#66d9ef>string</span>, <span style=color:#66d9ef>int</span>&gt; scores)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> json = JsonConvert.SerializeObject(scores, Formatting.Indented);
</span></span><span style=display:flex><span>        File.WriteAllText(filePath, json);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Dictionary&lt;<span style=color:#66d9ef>string</span>, <span style=color:#66d9ef>int</span>&gt; Load()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (File.Exists(filePath))
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> json = File.ReadAllText(filePath);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> JsonConvert.DeserializeObject&lt;Dictionary&lt;<span style=color:#66d9ef>string</span>, <span style=color:#66d9ef>int</span>&gt;&gt;(json);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> Dictionary&lt;<span style=color:#66d9ef>string</span>, <span style=color:#66d9ef>int</span>&gt;();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=xml>XML</h4><p>在Unity游戏开发中，XML也可以作为配置表格式，虽然现在主流是使用JSON或ScriptableObject，但XML仍然常用于：</p><ul><li>早期项目的兼容配置</li><li>与第三方系统（如服务器、编辑器）互通</li><li>高度结构化的数据需求场景</li></ul><table><thead><tr><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>可读性强、结构清晰</td><td>文件体积较大</td></tr><tr><td>支持复杂嵌套</td><td>解析性能差</td></tr><tr><td>C# 自带完整支持（<code>XmlSerializer</code>）</td><td>写法冗长，维护麻烦</td></tr><tr><td>与很多旧系统兼容</td><td>不适合热更数据场景</td></tr></tbody></table><h5 id=示例>示例</h5><p>假设一个怪物配置文件<code>monsters.xml</code>，内容如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;Monsters&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;Monster&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;ID&gt;</span>101<span style=color:#f92672>&lt;/ID&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;Name&gt;</span>Goblin<span style=color:#f92672>&lt;/Name&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;HP&gt;</span>100<span style=color:#f92672>&lt;/HP&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;Attack&gt;</span>30<span style=color:#f92672>&lt;/Attack&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;/Monster&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;Monster&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;ID&gt;</span>102<span style=color:#f92672>&lt;/ID&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;Name&gt;</span>Orc<span style=color:#f92672>&lt;/Name&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;HP&gt;</span>200<span style=color:#f92672>&lt;/HP&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;Attack&gt;</span>50<span style=color:#f92672>&lt;/Attack&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;/Monster&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Monsters&gt;</span>
</span></span></code></pre></div><p>创建C#数据类并添加<code>[XmlElement]</code>标签</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Xml.Serialization;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Collections.Generic;
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>[Serializable]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Monster</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> ID;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> HP;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Attack;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>[XmlRoot(&#34;Monsters)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MonsterList</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#a6e22e>    [XmlElement(&#34;Monster&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> List&lt;Monster&gt; Monsters;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Unity中读取XML文件</p><ol><li>将<code>monster.xml</code>放到<code>Assets/Resources/Data.monsters.xml</code></li><li>使用<code>TextAsset</code>加载，再用<code>XmlSerializer</code>解析</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Xml.Serialization;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.IO;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MonsterXmlLoader</span> : MonoBehaviour
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> Start()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 1. 读取 XML 文件</span>
</span></span><span style=display:flex><span>        TextAsset xmlText = Resources.Load&lt;TextAsset&gt;(<span style=color:#e6db74>&#34;Data/monsters&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 2. XML 序列化器</span>
</span></span><span style=display:flex><span>        XmlSerializer serializer = <span style=color:#66d9ef>new</span> XmlSerializer(<span style=color:#66d9ef>typeof</span>(MonsterList));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 3. 反序列化为 C# 对象</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>using</span> (StringReader reader = <span style=color:#66d9ef>new</span> StringReader(xmlText.text))
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            MonsterList monsterList = serializer.Deserialize(reader) <span style=color:#66d9ef>as</span> MonsterList;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 4. 使用数据</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> m <span style=color:#66d9ef>in</span> monsterList.Monsters)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                Debug.Log(<span style=color:#e6db74>$&#34;ID: {m.ID}, Name: {m.Name}, HP: {m.HP}, ATK: {m.Attack}&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=scriptableobject>ScriptableObject</h4><p><a href=%7B%7Bsite.baseurl%7D%7D/posts/2025-07-11-ScriptableObject/>ScriptableObject</a></p><h4 id=二进制>二进制</h4><p>在Unity游戏开发中，二进制格式配置表是一种高效的配置数据存储加载方式，常用于：</p><ul><li>发布版本中（加密、防反编译、防篡改）</li><li>替代文本格式（JSON/XML/CSV）以提升性能和安全性</li><li>客户端资源本地缓存或热更方案中</li></ul><h5 id=二进制配置>二进制配置</h5><p>将原本的结构化数据（如JSON/XML/CSV）序列化为字节流（<code>byte[]</code>），再通过代码反序列化回来</p><h5 id=常用二进制序列化方法>常用二进制序列化方法</h5><table><thead><tr><th>技术</th><th>说明</th><th>特点</th></tr></thead><tbody><tr><td><strong>BinaryFormatter</strong></td><td>Unity 自带（不推荐使用）</td><td>不安全，已过时</td></tr><tr><td><strong>ProtoBuf</strong></td><td>Google 提出的高效协议</td><td>快速、跨平台，适合大型项目</td></tr><tr><td><strong>MessagePack</strong></td><td>新一代高性能格式</td><td>小巧、快、Unity 支持好</td></tr><tr><td><strong>自定义格式</strong></td><td>自己写 byte[] 结构</td><td>极致优化，维护成本高</td></tr></tbody></table><h5 id=unity中简单的二进制序列化方法binaryformatter示例>Unity中简单的二进制序列化方法（BinaryFormatter示例）</h5><blockquote><p>虽然<code>BinaryFormatter</code>被标记为不安全，但对于离线开发或工具链仍可使用</p></blockquote><ol><li>定义数据类并标记<code>[Serializable]</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#a6e22e>[System.Serializable]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Monster</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> ID;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> HP;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>将数据写入二进制文件（在编辑器工具中使用）</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System.IO;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Runtime.Serialization.Formatter.Binary;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SaveToBinary</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Save(Monster data, <span style=color:#66d9ef>string</span> path)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        BinaryFormatter formatter = <span style=color:#66d9ef>new</span> BinaryFormatter();
</span></span><span style=display:flex><span>        FileStream stream = <span style=color:#66d9ef>new</span> FileStream(path, FileMode.Create);
</span></span><span style=display:flex><span>        formatter.Serialize(stream, data);
</span></span><span style=display:flex><span>        stream.close();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>在Unity中加载<code>.byte</code>文件
将二进制文件保存为<code>Assets/Resources/Data/monster.bytes</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System.IO;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Runtime.Serialization.Formatters.Binary;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LoadBinary</span> : MonoBehaviour
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> Start()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        TextAsset binaryFile = Resources.Load&lt;TextAsset&gt;(<span style=color:#e6db74>&#34;Data/monster&#34;</span>);
</span></span><span style=display:flex><span>        MemoryStream stream = <span style=color:#66d9ef>new</span> MemroyStream(binaryFile.bytes);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        BinaryFormatter formatter = <span style=color:#66d9ef>new</span> BinaryFormatter();
</span></span><span style=display:flex><span>        Monster m = (Monster)formatter.Deserialize(stream);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Debug.Log(<span style=color:#e6db74>$&#34;{m.ID} - {m.Name} - {m.HP}&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h5 id=二进制格式-vs-文本格式>二进制格式 vs 文本格式</h5><table><thead><tr><th>对比项</th><th>文本（CSV/JSON/XML）</th><th>二进制（.bytes）</th></tr></thead><tbody><tr><td><strong>可读性</strong></td><td>人类可读</td><td>不可读</td></tr><tr><td><strong>加载速度</strong></td><td>慢</td><td>快</td></tr><tr><td><strong>体积大小</strong></td><td>较大</td><td>小（压缩）</td></tr><tr><td><strong>安全性</strong></td><td>易被篡改</td><td>可加密、难修改</td></tr><tr><td><strong>调试方便</strong></td><td>可直接打开</td><td>不可直接看内容</td></tr><tr><td><strong>跨平台</strong></td><td>通用标准格式</td><td>需统一解码方案</td></tr></tbody></table><p><strong>使用二进制的场景</strong>\</p><ul><li>发布版本的配置数据（防篡改）</li><li>加载速度要求高的场景（如移动端）</li><li>热更框架集成的格式就是二进制（如Addressables + bytes）</li></ul><h3 id=配置表的加载方式>配置表的加载方式</h3><ol><li>编辑器预处理加载</li></ol><ul><li>将Excel/CSV转为Unity支持的ScriptableObject或JSON</li><li>构建时打包到<code>Resources</code>/<code>StreamingAssets</code>/<code>Addressables</code></li></ul><ol start=2><li>运行时加载</li></ol><ul><li>从<code>StreamingAssets</code>或远程服务器读取JSON/二进制</li><li>支持热更新和多平台兼容</li></ul><ol start=3><li>资源管理系统配合适用</li></ol><ul><li>如Unity的<code>Addressable</code>、<code>Resources.Load()</code>、自定义的资源加载框架等</li></ul><h3 id=数据结构与访问>数据结构与访问</h3><p><strong>示例</strong><br>角色属性配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>1001</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Warrior&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;hp&#34;</span>: <span style=color:#ae81ff>500</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;attack&#34;</span>: <span style=color:#ae81ff>70</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;defense&#34;</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>1002</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Archer&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;hp&#34;</span>: <span style=color:#ae81ff>300</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;attack&#34;</span>: <span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;defense&#34;</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>对应的C#结构体</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#a6e22e>[System.Serializable]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CharacterConfig</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> id;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> hp;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> attack;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> defense;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>加载方式</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>CharacterConfig[] configs = JsonUtility.FromJson&lt;Wrapper&lt;CharacterConfig&gt;&gt;(jsonText).list;
</span></span></code></pre></div><p>辅助封装类</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#a6e22e>[System.Serializable]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Wrapper</span>&lt;T&gt;
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> T[] list;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=进阶做法>进阶做法</h2><ol><li>配置表导入工具链（Excel转JSON/ScriptableObject）</li><li>自动生成C#结构体和索引器</li><li>内存优化（如按需加载、只保留当前关卡配置）</li><li>热更系统集成（版本控制 + CRC校验）</li><li>编辑器工具扩展（策划可视化编辑器）</li></ol></div><nav class=post-nav><a href=/blog/dependency-injection/ class=hover:underline>pre: Dependency Injection(DI)</a>
<a href=/blog/component/ class=hover:underline>next: Component</a></nav></article><aside class=toc><h3>TOC</h3><nav id=TableOfContents><ul><li><ul><li><a href=#核心思想>核心思想</a></li><li><a href=#在unity中的实践方式>在Unity中的实践方式</a></li><li><a href=#实例>实例</a></li><li><a href=#与addressable--assetbundle搭配>与Addressable / AssetBundle搭配</a></li><li><a href=#unity中数据驱动设计的典型应用场景>Unity中数据驱动设计的典型应用场景</a><ul><li><a href=#常见的配置表格式>常见的配置表格式</a><ul><li><a href=#csvcomma-separated-values>CSV(Comma-Separated Values)</a><ul><li><a href=#unity中如何读取csv>Unity中如何读取CSV</a></li><li><a href=#建议>建议</a></li></ul></li><li><a href=#excelxlsxlsx>Excel(XLS/XLSX)</a><ul><li><a href=#excel格式的特点用于配置表>Excel格式的特点（用于配置表）</a></li><li><a href=#unity中使用excel的常见方式>Unity中使用Excel的常见方式</a></li><li><a href=#配套工具>配套工具</a></li><li><a href=#弱类型>弱类型</a></li></ul></li><li><a href=#jsonjavascript-object-notation>JSON(JavaScript Object Notation)</a><ul><li><a href=#json数据类型>JSON数据类型</a></li><li><a href=#unity中如何使用json>Unity中如何使用JSON</a></li></ul></li><li><a href=#xml>XML</a><ul><li><a href=#示例>示例</a></li></ul></li><li><a href=#scriptableobject>ScriptableObject</a></li><li><a href=#二进制>二进制</a><ul><li><a href=#二进制配置>二进制配置</a></li><li><a href=#常用二进制序列化方法>常用二进制序列化方法</a></li><li><a href=#unity中简单的二进制序列化方法binaryformatter示例>Unity中简单的二进制序列化方法（BinaryFormatter示例）</a></li><li><a href=#二进制格式-vs-文本格式>二进制格式 vs 文本格式</a></li></ul></li></ul></li><li><a href=#配置表的加载方式>配置表的加载方式</a></li><li><a href=#数据结构与访问>数据结构与访问</a></li></ul></li><li><a href=#进阶做法>进阶做法</a></li></ul></li></ul></nav></aside><script>document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelectorAll(".single_article h1, .single_article h2, .single_article h3, .single_article h4, .single_article h5, .single_article h6"),e=document.querySelectorAll(".toc a");let t=!1;e.forEach(n=>{n.addEventListener("click",s=>{e.forEach(e=>e.classList.remove("active")),n.classList.add("active"),t=!0,setTimeout(()=>{t=!1},800)})});const s=new IntersectionObserver(n=>{if(t)return;n.forEach(t=>{if(t.isIntersecting){let n=t.target.getAttribute("id");e.forEach(e=>{e.classList.toggle("active",e.getAttribute("href")==="#"+n)})}})},{rootMargin:"-20% 0px -70% 0px",threshold:0});n.forEach(e=>s.observe(e))})</script><footer><div class=container><p>© 2025 Jeff Lee(ljf12825). All rights reserved</p></div></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><script>document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('a[href^="http"]').forEach(e=>{e.setAttribute("target","_blank")})})</script></body></html>
<!doctype html><html lang=en><head><meta name=page-kind content="page"><meta charset=UTF-8><title>C# Date Time System</title><link rel=stylesheet href=/css/style.css><link href=https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/prismjs@1/prism.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-c.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-cpp.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-csharp.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-bash.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-json.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-lua.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-python.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-rust.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><link rel=stylesheet href=/css/logsingle.css></head><body><header class=site-header><div class=container><div class=terminal-overlay aria-label=terminal-prompt><span id=typed-line></span><span class=cursor>█</span></div></div></header><nav class=topnav><div class=container><ul><li><a href=/dotnetandwindows/>★</a></li><li><a href=/dotnetandwindows/lab/>Lab</a></li><li><a href=/dotnetandwindows/log/>Log</a></li><li><a href=/dotnetandwindows/file/>File</a></li></ul></div></nav><nav id=star-nav><div id=star-header><span class="title open">>> >> >> Navigation &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Nav>>>>>></span></div><pre class=ascii>
+——————————————————————————————————————————————————————————————+
|                        <a class=nav-item data-path=/rightbrain/ href=/rightbrain/>RightBrain</a>                            |
|                             |                                |
|                             |     <a class=nav-item data-path=/dotnetandwindows/ href=/dotnetandwindows/>.NET-Windows</a>               |
|                             |    /                           |
|                             |   /                            |
|                             |  /                             |
|                             | /                              |
|                             |/                               |
|      <a class=nav-item data-path=/graphic/ href=/graphic/>Graphic</a> ———————————— <a class=nav-item data-path=/home/ href=/home/>Home</a> ————————————— <a class=nav-item data-path=/runtime/ href=/runtime/>Runtime</a>         |
|                            /|                                |
|                           / |                                |
|                          /  |                                |
|                         /   |       <a class=nav-item data-path=/language/ href=/language/>Language</a>                 |
|                        /    |      /                         |
|                       /     |     /                          |
|              <a class=nav-item data-path=/unixlike/ href=/unixlike/>Unix-like</a>      |    /           <a class=nav-item data-path=/project/ href=/project/>Project</a>         |
|                             |   /            <a class=nav-item data-path=/miscellaneous/ href=/miscellaneous/>Miscellaneous</a>   |
|                        <a class=nav-item data-path=/leftbrain/ href=/leftbrain/>LeftBrain</a>             <a class=nav-item data-path=/ai/ href=/ai/>AI</a>              |
+——————————————————————————————————————————————————————————————+
    </pre></nav><script defer src=/js/star-nav.js></script><script defer src=/js/site.js></script><script defer src=/js/star-active.js></script><div id=ref-window class="float-window open"><div class=float-header><span class="title open">>> >> >> Reference &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Ref>>>>>></span></div><div class=float-body><div class=ref-list><a href=https://www.mixamo.com/ target=_blank>Mixamo</a> |
<a href=https://opengameart.org/ target=_blank>OpenGameArt</a><p><a href=https://sharplab.io/ target=_blank>SharpLab</a> |
<a href=https://godbolt.org/ target=_blank>Compiler Explorer</a></p><p><a href="https://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type+Something+&x=none&v=4&h=4&w=80&we=false" target=_blank>ASCII Graph Generator</a></p><p><a href=https://mermaid.js.org/ target=_blank>Mermaid</a></p><a href=https://www.vim.org/ target=_blank>Vim</a> | <a href=https://vimdoc.sourceforge.net/ target=_blank>Vim Manual Source</a> |
<a href=https://vimcdoc.sourceforge.net/ target=_blank>Vimcdoc</a> | <a href=https://vimcdoc.sourceforge.net/doc/help.html target=_blank>Vimdoc read online</a><p><a href=https://shields.io/ target=_blank>Shields.io</a></p><p><a href=https://emojidb.org/ target=_blank>EmojiDB</a></p><p><a href=https://cppreference.com/ target=_blank>cppreference</a> |
<a href=https://isocpp.org/ target=_blank>isocpp</a> |
<a href=https://open-std.org target=_blank>open-std</a></p><p><a href=https://cmake.com/ target=_blank>cmake.org</a></p><p><a href=https://llvm.org/ target=_blank>llvm.org</a></p><p><a href=https://www.boost.org/ target=_blank>boost.org</a></p><p><a href=https://learn.microsoft.com/en-us/dotnet/csharp/ target=_blank>Microsoft Learn</a><p><a href=https://www.lua.org/ target=_blank>lua.org</a> |
<a href=https://www.luarocks.org/ target=_blank>luarocks.org</a> |
<a href=https://www.luajit.org/ target=_blank>luajit.org</a></p><p><a href=https://docs.unity3d.com/Manual/index.html target=_blank>Unity Manual</a> |
<a href=https://docs.unity3d.com/ScriptReference/index.html target=_blank>Unity API</a></p><p><a href=https://docs.unrealengine.com/ target=_blank>Unreal Engine Docs</a></p><p><a href=https://godotengine.org target=_blank>Godot</a> |
<a href=https://docs.godotengine.org/en/stable/ target=_blank>Godot Docs</a></p><p><a href=https://z-library.sk/ target=_blank>Z-Library</a></p><p><a href=https://docs.kernel.org/ target=_blank>Linux Kernel Docs</a></p><p><a href=https://www.gnu.org/ target=_blank>GNU</a></p><a href=https://archlinux.org/ target=_blank>ArchLinux</a><p><a href=https://help.ubuntu.com/ target=_blank>Ubuntu Doc</a> |
<a href=https://ubuntu.com/server/docs target=_blank>Ubuntu Server Guide</a></p><p><a href=https://www.vulkan.org/ target=_blank>Vulkan</a> |
<a href=https://docs.vulkan.org/ target=_blank>Vulkan Docs</a></p><p><a href=https://www.opengl.org/ target=_blank>OpenGL</a> |
<a href=https://registry.khronos.org/OpenGL target=_blank>OpenGL API</a> |
<a href=https://www.khronos.org/opengl/wiki/ target=_blank>OpenGL Wiki</a></p><p><a href=https://learn.microsoft.com/en-us/windows/win32/directx target=_blank>DirectX</a></p><p><a href=https://www.realtimerendering.com/ target=_blank>Real-Time Rendering</a></p><p><a href=https://www.pbr-book.org/ target=_blank>Physically Based Rendering</a></p><p><a href=https://www.scratchapixel.com/ target=_blank>Scratchapixel</a></p><p><a href=https://learnopengl.com/ target=_blank>LearnOpenGL</a></p><p><a href=https://raytracing.github.io/ target=_blank>Ray Tracing in One Weekend</a></p><p><a href=https://www.shadertoy.com/ target=_blank>Shadertoy</a></p><p><a href=https://arxiv.org/list/cs.GR/recent target=_blank>arXiv Graphics</a></p><p><a href=https://www.siggraph.org/ target=_blank>SIGGRAPH</a> |
<a href=https://dl.acm.org/conference/siggraph target=_blank>SIGGRAPH Digital Library</a></p><p><a href=https://git-scm.com/ target=_blank>Git</a></p></div></div></div><script src=/js/ref-window.js></script><article class=single_article><div class=title>C# Date Time System<div class=meta>Modified: 2025-06-01
| Author：ljf12825</div></div><div class=content><h2 id=c-时间系统>C# 时间系统</h2><h3 id=基础时间类型概览>基础时间类型概览</h3><p>C#中处理时间的核心结构体包括：</p><table><thead><tr><th>类型名</th><th>定义于</th><th>功能简介</th></tr></thead><tbody><tr><td><code>DateTime</code></td><td><code>System</code></td><td>最常用的时间表示类型，包含日期、时间、精度到 100ns。</td></tr><tr><td><code>TimeSpan</code></td><td><code>System</code></td><td>表示两个 <code>DateTime</code> 之间的差值，或一个持续时间。</td></tr><tr><td><code>DateTimeKind</code></td><td><code>System</code></td><td>枚举类型，用于标识 <code>DateTime</code> 是 <code>Local</code>、<code>Utc</code> 还是未指定。</td></tr><tr><td><code>DateTimeOffset</code></td><td><code>System</code></td><td>带时区偏移的时间，精确跨时区时间管理。</td></tr></tbody></table><h4 id=datetime标准时间表示><code>DateTime</code>：标准时间表示</h4><p><strong>特性</strong>\</p><ul><li>精度：100纳秒（Ticks）</li><li>范围：0001/1/1到9999/12/31</li><li>内部存储：以64位整数表示ticks（从公元0001-01-01起的刻度数）</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime now = DateTime.Now; <span style=color:#6272a4>// 本地时间</span>
</span></span><span style=display:flex><span>DateTime utc = DateTime.UtcNow; <span style=color:#6272a4>// UTC时间</span>
</span></span><span style=display:flex><span>DateTime specific = <span style=color:#ff79c6>new</span> DateTime(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>14</span>, <span style=color:#bd93f9>30</span>, <span style=color:#bd93f9>0</span>); <span style=color:#6272a4>// 自定义时间</span>
</span></span></code></pre></div><p>常用属性</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>now.Year;         <span style=color:#6272a4>// 年</span>
</span></span><span style=display:flex><span>now.Month;        <span style=color:#6272a4>// 月</span>
</span></span><span style=display:flex><span>now.Day;          <span style=color:#6272a4>// 日</span>
</span></span><span style=display:flex><span>now.Hour;         <span style=color:#6272a4>// 小时</span>
</span></span><span style=display:flex><span>now.Minute;       <span style=color:#6272a4>// 分钟</span>
</span></span><span style=display:flex><span>now.Second;       <span style=color:#6272a4>// 秒</span>
</span></span><span style=display:flex><span>now.Millisecond;  <span style=color:#6272a4>// 毫秒</span>
</span></span><span style=display:flex><span>now.DayOfWeek;    <span style=color:#6272a4>// 星期几</span>
</span></span><span style=display:flex><span>now.DayOfYear;    <span style=color:#6272a4>// 一年中的第几天</span>
</span></span></code></pre></div><h4 id=timespan时间间隔><code>TimeSpan</code>：时间间隔</h4><p><strong>特性</strong>\</p><ul><li>表示时间间隔而非具体时间点</li><li>支持负值</li><li>精度：100纳秒</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>TimeSpan span = <span style=color:#ff79c6>new</span> TimeSpan(<span style=color:#bd93f9>2</span>, <span style=color:#bd93f9>30</span>, <span style=color:#bd93f9>0</span>); <span style=color:#6272a4>// 2h 30min</span>
</span></span><span style=display:flex><span>DateTime t1 = DateTime.Now;
</span></span><span style=display:flex><span>DateTime t2 = t1.Add(span); <span style=color:#6272a4>// 加时间间隔</span>
</span></span><span style=display:flex><span>TimeSpan delta = t2 - t1; <span style=color:#6272a4>// 时间差计算</span>
</span></span></code></pre></div><p>常用属性</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>span.TotalHours; <span style=color:#6272a4>// 2.5</span>
</span></span><span style=display:flex><span>span.Minutes; <span style=color:#6272a4>// 30</span>
</span></span><span style=display:flex><span>span.TotalMilliseconds;
</span></span></code></pre></div><h4 id=datetimekind时间语义标识><code>DateTimeKind</code>：时间语义标识</h4><p>枚举值</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>enum</span> DateTimeKind
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Unspecified, <span style=color:#6272a4>// 未指定，默认构造是这个</span>
</span></span><span style=display:flex><span>    Utc, <span style=color:#6272a4>// UTC时间</span>
</span></span><span style=display:flex><span>    Local <span style=color:#6272a4>// 本地时间</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>用法示例</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime dt = <span style=color:#ff79c6>new</span> DateTime(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, DateTimeKind.Utc);
</span></span><span style=display:flex><span>DateTimeKind kind = dt.Kind; <span style=color:#6272a4>// Utc</span>
</span></span></code></pre></div><blockquote><p>注意：<code>DateTime.Now.Kind == Local</code>, <code>DateTime.UtcNow.Kind = Utc</code></p></blockquote><h4 id=datetimeoffset带时区偏移的时间表示><code>DateTimeOffset</code>：带时区偏移的时间表示</h4><p><strong>特性</strong>\</p><ul><li>表示一个“绝对”时间点（时间 + 偏移量）</li><li>精确管理跨时区的场景（如数据库、国际化系统）</li><li>能避免<code>DateTime</code>的时区歧义问题</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTimeOffset dto = DateTimeOffset.Now; <span style=color:#6272a4>// 当前本地时间，time + offset (H:mm:ss + 00:00)</span>
</span></span><span style=display:flex><span>DateTimeOffset utcDto = DateTimeOffset.UtcNow; <span style=color:#6272a4>// UTC时间，格式同上</span>
</span></span><span style=display:flex><span>DateTimeOffset custom = <span style=color:#ff79c6>new</span> DateTimeOffset(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, TimeSpan.FromHours(<span style=color:#bd93f9>8</span>)); <span style=color:#6272a4>// 手动设置当前时间和offset</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DateTime utc = dto.UtcDateTime; <span style=color:#6272a4>// 转utc，DateTime类型</span>
</span></span><span style=display:flex><span>DateTime local = dto.LoaclDateTime; <span style=color:#6272a4>// 转本地</span>
</span></span></code></pre></div><h3 id=时间的创建与格式化>时间的创建与格式化</h3><h4 id=创建datetime的方式>创建DateTime的方式</h4><p>构造函数</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime dt = <span style=color:#ff79c6>new</span> DateTime(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>1</span>); <span style=color:#6272a4>// 2025-08-01 00:00:00</span>
</span></span><span style=display:flex><span>DateTime full = <span style=color:#ff79c6>new</span> DateTime(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>14</span>, <span style=color:#bd93f9>30.</span> <span style=color:#bd93f9>0</span>); <span style=color:#6272a4>// 带时间</span>
</span></span><span style=display:flex><span>DateTime withKind = <span style=color:#ff79c6>new</span> DateTime(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>14</span>, <span style=color:#bd93f9>30</span>, <span style=color:#bd93f9>0</span>, DateTimeKind.Utc); <span style=color:#6272a4>// 指定时区语义</span>
</span></span></code></pre></div><p>静态属性</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime now = DateTime.Now;         <span style=color:#6272a4>// 当前本地时间</span>
</span></span><span style=display:flex><span>DateTime utcNow = DateTime.UtcNow;   <span style=color:#6272a4>// 当前UTC时间</span>
</span></span><span style=display:flex><span>DateTime today = DateTime.Today;     <span style=color:#6272a4>// 今天的00:00:00</span>
</span></span></code></pre></div><p>特殊用途</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime min = DateTime.MinValue; <span style=color:#6272a4>// 0001-01-01</span>
</span></span><span style=display:flex><span>DateTime max = DateTime.MaxValue; <span style=color:#6272a4>// 9999-12-31</span>
</span></span></code></pre></div><h4 id=格式化输出tostring>格式化输出ToString</h4><p>使用<code>ToString()</code>输出时间字符串，支持多种格式</p><p>标准格式字符串（大小写敏感）</p><table><thead><tr><th>格式</th><th>示例</th><th>含义</th></tr></thead><tbody><tr><td><code>d</code></td><td><code>8/1/2025</code></td><td>短日期</td></tr><tr><td><code>D</code></td><td><code>Friday, August 1, 2025</code></td><td>长日期</td></tr><tr><td><code>t</code></td><td><code>14:30</code></td><td>短时间</td></tr><tr><td><code>T</code></td><td><code>14:30:00</code></td><td>长时间</td></tr><tr><td><code>f</code></td><td><code>Friday, August 1, 2025 14:30</code></td><td>长日期+短时间</td></tr><tr><td><code>F</code></td><td><code>Friday, August 1, 2025 14:30:00</code></td><td>长日期+长时间</td></tr><tr><td><code>o</code></td><td><code>2025-08-01T14:30:00.0000000+08:00</code></td><td>ISO 8601（Round-trip）</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd>string</span> s1 = DateTime.Now.ToString(<span style=color:#f1fa8c>&#34;F&#34;</span>);
</span></span></code></pre></div><p>自定义字符串格式</p><table><thead><tr><th>字符</th><th>含义</th><th>示例</th></tr></thead><tbody><tr><td><code>yyyy</code></td><td>年</td><td><code>2025</code></td></tr><tr><td><code>MM</code></td><td>月（两位）</td><td><code>08</code></td></tr><tr><td><code>dd</code></td><td>日</td><td><code>01</code></td></tr><tr><td><code>HH</code></td><td>时（24制）</td><td><code>14</code></td></tr><tr><td><code>mm</code></td><td>分</td><td><code>30</code></td></tr><tr><td><code>ss</code></td><td>秒</td><td><code>05</code></td></tr><tr><td><code>fff</code></td><td>毫秒</td><td><code>123</code></td></tr></tbody></table><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd>string</span> str = now.ToString(<span style=color:#f1fa8c>&#34;yyyy-MM-dd HH:mm:ss.fff&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#6272a4>// 输出示例：2025-08-01 14:30:00.123</span>
</span></span></code></pre></div><h4 id=字符串解析-parsetryparseparseexact>字符串解析 Parse/TryParse/ParseExact</h4><p>Parse（可能抛异常）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime dt = DateTime.Parse(<span style=color:#f1fa8c>&#34;2025-08-01 14:30&#34;</span>);
</span></span></code></pre></div><p>TryParse（推荐）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd>bool</span> success = DateTime.TryParse(<span style=color:#f1fa8c>&#34;2025-08-01&#34;</span>, <span style=color:#ff79c6>out</span> DateTime dt);
</span></span><span style=display:flex><span><span style=color:#ff79c6>if</span> (success) {
</span></span><span style=display:flex><span>    <span style=color:#6272a4>// 成功解析</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ParseExact（精确控制格式）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd>string</span> input = <span style=color:#f1fa8c>&#34;2025/08/01 14:30&#34;</span>;
</span></span><span style=display:flex><span>DateTime dt = DateTime.ParseExact(input, <span style=color:#f1fa8c>&#34;yyyy/MM/dd HH:mm&#34;</span>, CultureInfo.InvariantCulture);
</span></span></code></pre></div><p><code>Parse</code>和<code>ParseExact</code>默认使用当前系统区域设置（文化信息）</p><h4 id=常见问题>常见问题</h4><table><thead><tr><th>问题</th><th>原因与解决方案</th></tr></thead><tbody><tr><td>输入字符串格式不对</td><td>使用 <code>TryParse</code> 或 <code>ParseExact</code> 防止异常</td></tr><tr><td><code>Parse</code> 出现时区歧义</td><td>使用 <code>DateTimeOffset.Parse</code> 更安全</td></tr><tr><td>毫秒信息丢失或不一致</td><td>明确格式字符串 <code>fff</code>，注意数据源精度</td></tr><tr><td>文化差异导致解析失败</td><td>使用 <code>CultureInfo.InvariantCulture</code> 明确文化设置</td></tr></tbody></table><h3 id=时间计算与比较>时间计算与比较</h3><h4 id=add方法><code>Add</code>方法</h4><p><code>Add</code>系列方法允许对<code>DateTime</code>添加不同类型的时间单位</p><table><thead><tr><th>方法</th><th>参数类型</th><th>说明</th></tr></thead><tbody><tr><td><code>AddDays(double)</code></td><td><code>double</code></td><td>添加天数，支持负数</td></tr><tr><td><code>AddHours(double)</code></td><td><code>double</code></td><td>添加小时，支持负数</td></tr><tr><td><code>AddMinutes(double)</code></td><td><code>double</code></td><td>添加分钟，支持负数</td></tr><tr><td><code>AddSeconds(double)</code></td><td><code>double</code></td><td>添加秒，支持负数</td></tr><tr><td><code>AddMilliseconds(double)</code></td><td><code>double</code></td><td>添加毫秒，支持负数</td></tr><tr><td><code>AddTicks(long)</code></td><td><code>long</code></td><td>添加刻度数（100纳秒为单位）</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime now = DateTime.Now;
</span></span><span style=display:flex><span>DateTime tomorrow = now.AddDays(<span style=color:#bd93f9>1</span>);   <span style=color:#6272a4>// 明天同一时刻</span>
</span></span><span style=display:flex><span>DateTime nextHour = now.AddHours(<span style=color:#bd93f9>1</span>);  <span style=color:#6272a4>// 一小时后</span>
</span></span><span style=display:flex><span>DateTime lastMinute = now.AddMinutes(-<span style=color:#bd93f9>1</span>); <span style=color:#6272a4>// 一分钟前</span>
</span></span></code></pre></div><h4 id=时间差计算>时间差计算</h4><p>通过<code>-</code>运算符或<code>Subtract</code>方法来计算两个<code>DateTime</code>之间的差值，返回的是<code>TimeSpan</code>类型</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime t1 = <span style=color:#ff79c6>new</span> DateTime(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>14</span>, <span style=color:#bd93f9>30</span>, <span style=color:#bd93f9>0</span>);
</span></span><span style=display:flex><span>DateTime t2 = DateTime.Now;
</span></span><span style=display:flex><span>TimeSpan difference = t2- t1; <span style=color:#6272a4>// t2和t1之间的差值</span>
</span></span></code></pre></div><p><code>TimeSpan</code>常用属性</p><ul><li><code>TotalDays</code>：总天数</li><li><code>TotalHours</code>：总小时数</li><li><code>Days</code>：整数天数</li><li><code>Hours</code>：小时数</li><li><code>Minutes</code>：分钟数</li><li><code>Seconds</code>：秒数</li></ul><h4 id=比较datetime对象>比较<code>DateTime</code>对象</h4><p>可以使用 <code>CompareTo</code> 或 <code>></code>、<code>&lt;</code>、<code>==</code> 运算符来比较两个 <code>DateTime</code> 对象的大小</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime dt1 = DateTime.Now;
</span></span><span style=display:flex><span>DateTime dt2 = DateTime.UtcNow;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> comparison = dt1.CompareTo(dt2);
</span></span><span style=display:flex><span><span style=color:#ff79c6>if</span> (comparison &lt; <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#f1fa8c>&#34;dt1 是早于 dt2 的时间&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>else</span> <span style=color:#ff79c6>if</span> (comparison &gt; <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#f1fa8c>&#34;dt1 是晚于 dt2 的时间&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>else</span>
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#f1fa8c>&#34;dt1 与 dt2 相等&#34;</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#ff79c6>if</span> (dt1 &gt; dt2)
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#f1fa8c>&#34;dt1 晚于 dt2&#34;</span>);
</span></span></code></pre></div><h4 id=判断时间是否在某个区间内>判断时间是否在某个区间内</h4><p>使用<code>DateTime.Compare</code>或<code>>=</code>,<code>&lt;=</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime start = <span style=color:#ff79c6>new</span> DateTime(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>);
</span></span><span style=display:flex><span>DateTime end = <span style=color:#ff79c6>new</span> DateTime(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>23</span>, <span style=color:#bd93f9>59</span>, <span style=color:#bd93f9>59</span>);
</span></span><span style=display:flex><span>DateTime target = DateTime.Now;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>if</span> (target &gt;= start &amp;&amp; target &lt;= end)
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#f1fa8c>&#34;目标时间在区间内&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>else</span>
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#f1fa8c>&#34;目标时间不在区间内&#34;</span>);
</span></span></code></pre></div><p>判断某个<code>DateTime</code>是否为今天，可以仅比较年、月、日部分，忽略具体时间</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd>bool</span> isToday = taget.Date == DateTime.Now.Date;
</span></span></code></pre></div><p><code>target.Date</code>会把时间部分归零，方便直接与今天进行比较</p><h4 id=判断时间是否在一小时内>判断时间是否在一小时内</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd>bool</span> inWithinLastHour(DateTime target) =&gt; target &gt;= DateTime.Now.AddHours(-<span style=color:#bd93f9>1</span>) &amp;&amp; target &lt;= DateTime.Now;
</span></span></code></pre></div><h4 id=datetime对象的不可变性><code>DateTime</code>对象的不可变性</h4><p><code>DateTime</code>是不可变类型，所有<code>Add</code>操作都会返回一个新的<code>DateTime</code>对象，而不会修改源对象</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTime original = DateTime.Now;
</span></span><span style=display:flex><span>DateTime added = original.AddDays(<span style=color:#bd93f9>1</span>); <span style=color:#6272a4>// new DateTime对象</span>
</span></span><span style=display:flex><span>Console.WriteLine(original);  <span style=color:#6272a4>// 还是原始时间</span>
</span></span><span style=display:flex><span>Console.WriteLine(added);     <span style=color:#6272a4>// 添加后的新时间</span>
</span></span></code></pre></div><p>如果需要多次修改时间，建议使用<code>DateTimeOffset</code>或者<code>TimeSpan</code>来进行中间计算，避免不必要的重复创建</p><h3 id=时间戳的处理与转换>时间戳的处理与转换</h3><p>在很多应用场景中，需要将时间转换为时间戳（Unix时间戳），或者将时间戳转换为<code>DateTime</code>对象</p><h4 id=unix时间戳>Unix时间戳</h4><p>Unix 时间戳 是从 1970年1月1日 00:00:00 UTC 起经过的秒数（不计闰秒）。通常用于跨平台系统中，尤其是网络通信、数据库存储等。</p><ul><li>Unix 时间戳 采用 秒级精度，因此是一个 32位 或 64位 整数（根据平台的不同）</li><li>如果需要更高的精度（如毫秒或微秒），可以使用 <code>DateTimeOffset</code> 或 <code>Stopwatch</code> 来实现</li></ul><h4 id=获取当前unix时间戳>获取当前Unix时间戳</h4><ol><li>Unix时间戳（秒）
可以通过 <code>DateTimeOffset</code> 的 <code>ToUnixTimeSeconds()</code> 方法获取当前时间的 Unix 时间戳（秒）</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTimeOffset now = DateTimeOffset.Now;
</span></span><span style=display:flex><span><span style=color:#8be9fd>long</span> unixTimestampSeconds = now.ToUnixTimeSeconds();
</span></span></code></pre></div><ol start=2><li>Unix时间戳（毫秒）
如果需要毫秒级精度，可以使用<code>ToUnixTimeMilliseconds()</code>方法</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd>long</span> unixTimestampMilliseconds = nnow.ToUnixTimeMilliseconds();
</span></span></code></pre></div><p>返回毫秒</p><h4 id=时间戳转datetime>时间戳转<code>DateTime</code></h4><ol><li>Unix（秒）转<code>DateTime</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd>long</span> unixTimestamp = <span style=color:#bd93f9>1659388800</span>; <span style=color:#6272a4>// 示例时间戳（2022-08-01 00：00：00 UTC）</span>
</span></span><span style=display:flex><span>DateTimeOffset dateTimeOffset = DateTimeOffset.FromUnixTimeSeconds(unixTimestamp);
</span></span><span style=display:flex><span>DateTime dateTime = dateTimeOffset.DateTime;
</span></span></code></pre></div><ol start=2><li>Unix（毫秒）转<code>DateTime</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#8be9fd>long</span> unixTimestampMs = <span style=color:#bd93f9>1659388800000</span>; <span style=color:#6272a4>// 毫秒级时间戳</span>
</span></span><span style=display:flex><span>DateTimeOffset dateTimeOffsetMs = DateTimeOffset.FromUnixTimeMilliseconds(unixTimestampMs);
</span></span><span style=display:flex><span>DateTime dateTimeMs = dateTimeOffsetMs.DateTime;
</span></span><span style=display:flex><span>Console.WriteLine(dateTimeMs);  <span style=color:#6272a4>// 输出：2022-08-01 00:00:00</span>
</span></span></code></pre></div><h4 id=datetimeoffset与时间戳的结合><code>DateTimeOffset</code>与时间戳的结合</h4><p><code>DateTimeOffset</code>表示一个时间点，并带有时区偏移，适合跨时区和国际化应用</p><p>使用<code>DateTimeOffset</code>来转换时间戳时，会比直接使用<code>DateTime</code>更为安全和方便</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>DateTimeOffset nowOffset = DateTimeOffset.Now;
</span></span><span style=display:flex><span><span style=color:#8be9fd>long</span> unixTimestamp = nowOffset.ToUnixTimeSeconds();
</span></span></code></pre></div><h3 id=定时与定时工具>定时与定时工具</h3><h3 id=时区管理>时区管理</h3><p>时区问题是跨平台开发中常见的挑战之一，C#提供了<code>TimeZoneInfo</code>类来帮助管理和转换时区信息</p><h4 id=timezoneinfo类概述><code>TimeZoneInfo</code>类概述</h4><p><code>TimeZoneInfo</code>类提供了时区相关的功能，允许查询、转换和处理不同的时区信息</p><p><code>TimeZoneInfo</code>的基本操作</p><ul><li>获取本地时区：<code>TimeZoneInfo.Local</code></li><li>获取UTC时区：<code>TimeZoneInfo.Utc</code></li><li>获取所有时区信息：<code>TimeZoneInfo.GetSystemTimeZones()</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// 获取所有系统时区</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>foreach</span> (<span style=color:#8be9fd>var</span> timeZone <span style=color:#ff79c6>in</span> TimeZoneInfo.GetSystemTimeZones())
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Console.WriteLine(timeZone.Id);  <span style=color:#6272a4>// 打印时区ID</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=timezoneinfo转换时间><code>TimeZoneInfo</code>转换时间</h4><p>通过<code>TimeZoneInfo</code>，可以将一个时间从一个时区转换到另一个时区，常见的转换方法包括</p><ul><li>将本地时间转换为UTC时间</li><li>将UTC时间转换为本地时间</li><li>不同时区之间的相互转换</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// 本地转UTC</span>
</span></span><span style=display:flex><span>DateTime localTime = DateTime.Now;
</span></span><span style=display:flex><span>DateTime utcTime = TimeZoneInfo.ConvertTimeToUtc(localTime);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// UtC转本地</span>
</span></span><span style=display:flex><span>DateTime utcTime = DateTime.UtcNow;
</span></span><span style=display:flex><span>DateTime localTime = TimeZoneInfo.ConvertTimeFromUtc(utcTime, TimeZoneInfo.Local);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// 不同时区转换</span>
</span></span><span style=display:flex><span>DateTime utcTime = DateTime.UtcNow;
</span></span><span style=display:flex><span>TimeZoneInfo timeZoneNewYourk = TImeZoneInfo.FindSystemTimeZondById(<span style=color:#f1fa8c>&#34;Eastern Standard Time&#34;</span>); <span style=color:#6272a4>// 获取纽约时区</span>
</span></span><span style=display:flex><span>DateTime newYorkTime = TImeZoneInfo.ConvertTimeFromUtc(utcTime, timeZoneNewYork);
</span></span></code></pre></div><h4 id=使用timezoneinfo获取时区的详细信息>使用<code>TimeZoneInfo</code>获取时区的详细信息</h4><p><code>TimeZoneInfo</code>提供了一些方法，可以获取时区的详细信息，例如：标准时间偏移、夏令时的开始和结束时间等</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// 获取时区的偏移量</span>
</span></span><span style=display:flex><span>TimeZoneInfo tzInfo = TimeZoneInfo.FindSystemTimeZoneById(<span style=color:#f1fa8c>&#34;Pacific Standard Time&#34;</span>);
</span></span><span style=display:flex><span>TimeSpan offset = tzInfo.GetUtcOffset(DateTime.Now); <span style=color:#6272a4>// 获取当前时区的偏移量</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// 获取时区的夏令时信息</span>
</span></span><span style=display:flex><span>TimeZoneInfo tzInfo = TimeZoneInfo.FindSystemTimeZoneById(<span style=color:#f1fa8c>&#34;Pacific Standard Time&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>if</span> (tzInfo.SupportsDaylightSavingTime)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#f1fa8c>$&#34;夏令时开始：{tzInfo.GetAdjustmentRules()[0].DateStart}&#34;</span>);
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#f1fa8c>$&#34;夏令时结束： {tzInfo.GetAdjustmentRules()[0].DateEnd}&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=使用datetimeoffset管理时区>使用<code>DateTimeOffset</code>管理时区</h4><p><code>DateTimeOffset</code>是一个结合了时间和时区偏移的类型，特别适合在国际化系统中使用，能明确表示时间的“绝对值”</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// 获取`DateTimeOffset和时区信息</span>
</span></span><span style=display:flex><span>DateTimeOffset dto = DateTimeOffset.Now;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// 使用DateTimeOffset在不同时间区之间转换</span>
</span></span><span style=display:flex><span>DateTimeOffset dtUtc = DateTimeOffset.UtcNow; <span style=color:#6272a4>// 当前UTC时间</span>
</span></span><span style=display:flex><span>DateTimeOffset dtLoacl = dtUtcToOffset(TimeZoneInfo.Local.GetUtcOffset(DateTime.UtcNow)); <span style=color:#6272a4>// 转为本地时间</span>
</span></span></code></pre></div><h4 id=时间与夏令时dst处理>时间与夏令时（DST）处理</h4><p>夏令时（DST）是某些时区的特殊情况，在夏令时期间，时间会比标准时间提前一个小时</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// 判断句某个日期是否在夏令时内</span>
</span></span><span style=display:flex><span>TimeZoneInfo tzInfo = TimeZoneInfo.FindSystemTimeZoneById(<span style=color:#f1fa8c>&#34;Pacific Standard Time&#34;</span>);
</span></span><span style=display:flex><span>DateTime testDate = <span style=color:#ff79c6>new</span> DateTime(<span style=color:#bd93f9>2025</span>, <span style=color:#bd93f9>7</span>, <span style=color:#bd93f9>1</span>); <span style=color:#6272a4>// 夏季</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>bool</span> isDST = tzInfo.IsDaylightSavingTime(testDate);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#6272a4>// 获取夏令时调整规则</span>
</span></span><span style=display:flex><span>TimeZoneInfo tzInfo = TimeZoneInfo.FindSystemTimeZoneById(<span style=color:#f1fa8c>&#34;Pacific Standard Time&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>foreach</span> (<span style=color:#8be9fd>var</span> rule <span style=color:#ff79c6>in</span> tzInfo.GetAdjustmentRules())
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#f1fa8c>$&#34;{rule.DateStart}, {rule.DateEnd}&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=定时与计时工具>定时与计时工具</h3><h4 id=使用systemtimerstimer定时器>使用<code>System.Timers.Timer</code>定时器</h4><p><code>System.Timers.Timer</code>是C#中用于定时任务执行的类，它可以在指定的时间间隔后执行某个事件或回调函数，适用于需要定期触发任务的场景</p><p>创建并使用<code>System.Timers.Timer</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#ff79c6>using</span> System;
</span></span><span style=display:flex><span><span style=color:#ff79c6>using</span> System.Timers;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>Program</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#ff79c6>void</span> Main()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Timer timer = <span style=color:#ff79c6>new</span> Timer(<span style=color:#bd93f9>1000</span>); <span style=color:#6272a4>// 设置间隔为1s</span>
</span></span><span style=display:flex><span>        timer.Elapsed += OnTimedEvent; <span style=color:#6272a4>// 事件触发时调用</span>
</span></span><span style=display:flex><span>        timer.AutoReset = <span style=color:#ff79c6>true</span>; <span style=color:#6272a4>// 是否重复触发</span>
</span></span><span style=display:flex><span>        timer.Enable = <span style=color:#ff79c6>true</span>; <span style=color:#6272a4>// 启动定时器</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Console.WriteLine(<span style=color:#f1fa8c>&#34;Press Enter to exit...&#34;</span>);
</span></span><span style=display:flex><span>        Console.ReadLine(); <span style=color:#6272a4>// 保持程序运行    </span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#ff79c6>void</span> OnTimedEvent(Object source, ElapsedEventArgs e)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Console.WriteLine(<span style=color:#f1fa8c>$&#34;The event was triggered at {e.SignalTime}&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>关键属性和方法</p><ul><li>Interval：设置事件间隔</li><li>Elapsed：事件，定时器到达指定和时间时触发</li><li>AudoReset：是否在每个间隔后重新启动定时器</li><li>Enabled：启用或禁用定时器</li></ul><h4 id=使用systemthreadingtimer>使用<code>System.Threading.Timer</code></h4><p><code>System.Threading.Timer</code>也是一个定时器，但它运行在线程池线程上，适合在多线程环境下使用</p><p>它的使用方式略有不同，适用于短期内要触发一次或周期性任务的场景</p><p>创建并使用<code>System.Threading.Timer</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#ff79c6>using</span> System;
</span></span><span style=display:flex><span><span style=color:#ff79c6>using</span> System.Threading;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>Program</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    staitc <span style=color:#ff79c6>void</span> Main()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        TimerCallback callback = <span style=color:#ff79c6>new</span> TimerCallback(OnTimedEvent);
</span></span><span style=display:flex><span>        Timer timer = <span style=color:#ff79c6>new</span> Timer(callback, <span style=color:#ff79c6>null</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>1000</span>); <span style=color:#6272a4>// 初始延迟为0ms，每1秒触发一次</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Console.WriteLine(<span style=color:#f1fa8c>&#34;Press Enter to exit...&#34;</span>);
</span></span><span style=display:flex><span>        Console.ReadLine();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#ff79c6>void</span> OnTimedEvent(Object state)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Console.WriteLine(<span style=color:#f1fa8c>$&#34;The event was triggered at {DateTime.Now}&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>callback：回调方法，在定时器触发时执行</li><li>dueTime：首次触发的延迟事件</li><li>period：定时器触发的间隔时间，可以设置为<code>Timeout.Infinite</code>使其只触发一次</li></ul><h4 id=stopwatch性能计时><code>Stopwatch</code>性能计时</h4><p><code>Stopwatch</code>是C#提供的高精度计时工具，通常用于测量代码块的执行时间</p><p>它不受系统时钟的影响，并且提供微秒级的精度</p><p>它比<code>DateTime</code>更精确，并且可以支持微秒级别的计时</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span>Stopwatch stopwatch = <span style=color:#ff79c6>new</span> Stopwatch();
</span></span><span style=display:flex><span>stopwatch.Start();
</span></span><span style=display:flex><span><span style=color:#6272a4>// do something</span>
</span></span><span style=display:flex><span>stopwatch.Stop();
</span></span><span style=display:flex><span>Console.WriteLine(stopwatch.ElapsedMilliseconds); <span style=color:#6272a4>// 以毫秒为单位的高精度时间戳</span>
</span></span><span style=display:flex><span>Console.WriteLine(stopwatch.Elapsed); <span style=color:#6272a4>// 输出更详细的时间间隔</span>
</span></span></code></pre></div><h4 id=使用systemthreadingthreadsleep延时>使用<code>System.Threading.Thread.Sleep</code>延时</h4><p><code>Thread.Sleep</code>方法可以让当前线程暂停一段时间，适合实现延时操作</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#ff79c6>using</span> System;
</span></span><span style=display:flex><span><span style=color:#ff79c6>using</span> System.Threading;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>Program</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#ff79c6>void</span> Main()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i = <span style=color:#bd93f9>0</span> i &lt; <span style=color:#bd93f9>5</span>; ++i)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            Console.WriteLine(<span style=color:#f1fa8c>$&#34;Iteration {i + 1}&#34;</span>);
</span></span><span style=display:flex><span>            Thread.Sleep(<span style=color:#bd93f9>1000</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>Thread.Sleep</code>会阻塞当前线程，因此它不适合在需要高并发的场景中使用，对于更复杂的异步操作，可以使用<code>async</code>和<code>await</code></p></div><nav class=post-nav><a href=/dotnetandwindows/file/c%23/concurrent/ class=hover:underline>pre: C# Concurrent</a>
<a href=/dotnetandwindows/file/c%23/clr/ class=hover:underline>next: CLR</a></nav></article><aside class=toc><h3>TOC</h3><nav id=TableOfContents><ul><li><ul><li><a href=#c-时间系统>C# 时间系统</a><ul><li><a href=#基础时间类型概览>基础时间类型概览</a><ul><li><a href=#datetime标准时间表示><code>DateTime</code>：标准时间表示</a></li><li><a href=#timespan时间间隔><code>TimeSpan</code>：时间间隔</a></li><li><a href=#datetimekind时间语义标识><code>DateTimeKind</code>：时间语义标识</a></li><li><a href=#datetimeoffset带时区偏移的时间表示><code>DateTimeOffset</code>：带时区偏移的时间表示</a></li></ul></li><li><a href=#时间的创建与格式化>时间的创建与格式化</a><ul><li><a href=#创建datetime的方式>创建DateTime的方式</a></li><li><a href=#格式化输出tostring>格式化输出ToString</a></li><li><a href=#字符串解析-parsetryparseparseexact>字符串解析 Parse/TryParse/ParseExact</a></li><li><a href=#常见问题>常见问题</a></li></ul></li><li><a href=#时间计算与比较>时间计算与比较</a><ul><li><a href=#add方法><code>Add</code>方法</a></li><li><a href=#时间差计算>时间差计算</a></li><li><a href=#比较datetime对象>比较<code>DateTime</code>对象</a></li><li><a href=#判断时间是否在某个区间内>判断时间是否在某个区间内</a></li><li><a href=#判断时间是否在一小时内>判断时间是否在一小时内</a></li><li><a href=#datetime对象的不可变性><code>DateTime</code>对象的不可变性</a></li></ul></li><li><a href=#时间戳的处理与转换>时间戳的处理与转换</a><ul><li><a href=#unix时间戳>Unix时间戳</a></li><li><a href=#获取当前unix时间戳>获取当前Unix时间戳</a></li><li><a href=#时间戳转datetime>时间戳转<code>DateTime</code></a></li><li><a href=#datetimeoffset与时间戳的结合><code>DateTimeOffset</code>与时间戳的结合</a></li></ul></li><li><a href=#定时与定时工具>定时与定时工具</a></li><li><a href=#时区管理>时区管理</a><ul><li><a href=#timezoneinfo类概述><code>TimeZoneInfo</code>类概述</a></li><li><a href=#timezoneinfo转换时间><code>TimeZoneInfo</code>转换时间</a></li><li><a href=#使用timezoneinfo获取时区的详细信息>使用<code>TimeZoneInfo</code>获取时区的详细信息</a></li><li><a href=#使用datetimeoffset管理时区>使用<code>DateTimeOffset</code>管理时区</a></li><li><a href=#时间与夏令时dst处理>时间与夏令时（DST）处理</a></li></ul></li><li><a href=#定时与计时工具>定时与计时工具</a><ul><li><a href=#使用systemtimerstimer定时器>使用<code>System.Timers.Timer</code>定时器</a></li><li><a href=#使用systemthreadingtimer>使用<code>System.Threading.Timer</code></a></li><li><a href=#stopwatch性能计时><code>Stopwatch</code>性能计时</a></li><li><a href=#使用systemthreadingthreadsleep延时>使用<code>System.Threading.Thread.Sleep</code>延时</a></li></ul></li></ul></li></ul></li></ul></nav></aside><script defer src=/js/scrollspy.js></script><script type=module>
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ 
    startOnLoad: true, theme: "default" });
</script><footer><div class=container><p>© 2026 Jeff Lee(ljf12825). All rights reserved |
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>Article: CC BY-NC-SA 4.0</a> |
<a href=https://creativecommons.org/licenses/by-sa/4.0/>Content: CC BY-SA 4.0</a> |
<a href=https://opensource.org/licenses/MIT>Code: MIT License</a> |
<a href=/LICENSES.md>Full License</a></p></div></footer></body></html>
<!doctype html><html lang=en><head><meta name=page-kind content="page"><meta charset=UTF-8><title>diff</title><link rel=stylesheet href=/css/style.css><link href=https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/prismjs@1/prism.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-c.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-cpp.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-csharp.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-bash.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-json.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-lua.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-python.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-rust.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><link rel=stylesheet href=/css/logsingle.css></head><body><header class=site-header><div class=container><div class=terminal-overlay aria-label=terminal-prompt><span id=typed-line></span><span class=cursor>█</span></div></div></header><nav class=topnav><div class=container><ul><li><a href=/unixlike/>★</a></li><li><a href=/unixlike/lab/>Lab</a></li><li><a href=/unixlike/log/>Log</a></li><li><a href=/unixlike/file/>File</a></li></ul></div></nav><nav id=star-nav><div id=star-header><span class="title open">>> >> >> Navigation &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Nav>>>>>></span></div><pre class=ascii>
+——————————————————————————————————————————————————————————————+
|                        <a class=nav-item data-path=/rightbrain/ href=/rightbrain/>RightBrain</a>                            |
|                             |                                |
|                             |     <a class=nav-item data-path=/dotnetandwindows/ href=/dotnetandwindows/>.NET-Windows</a>               |
|                             |    /                           |
|                             |   /                            |
|                             |  /                             |
|                             | /                              |
|                             |/                               |
|      <a class=nav-item data-path=/graphic/ href=/graphic/>Graphic</a> ———————————— <a class=nav-item data-path=/home/ href=/home/>Home</a> ————————————— <a class=nav-item data-path=/runtime/ href=/runtime/>Runtime</a>         |
|                            /|                                |
|                           / |                                |
|                          /  |                                |
|                         /   |       <a class=nav-item data-path=/language/ href=/language/>Language</a>                 |
|                        /    |      /                         |
|                       /     |     /                          |
|              <a class=nav-item data-path=/unixlike/ href=/unixlike/>Unix-like</a>      |    /           <a class=nav-item data-path=/project/ href=/project/>Project</a>         |
|                             |   /            <a class=nav-item data-path=/miscellaneous/ href=/miscellaneous/>Miscellaneous</a>   |
|                        <a class=nav-item data-path=/leftbrain/ href=/leftbrain/>LeftBrain</a>             <a class=nav-item data-path=/ai/ href=/ai/>AI</a>              |
+——————————————————————————————————————————————————————————————+
    </pre></nav><script defer src=/js/star-nav.js></script><script defer src=/js/site.js></script><script defer src=/js/star-active.js></script><div id=ref-window class="float-window open"><div class=float-header><span class="title open">>> >> >> Reference &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Ref>>>>>></span></div><div class=float-body><div class=ref-list><a href=https://www.mixamo.com/ target=_blank>Mixamo</a> |
<a href=https://opengameart.org/ target=_blank>OpenGameArt</a><p><a href=https://sharplab.io/ target=_blank>SharpLab</a> |
<a href=https://godbolt.org/ target=_blank>Compiler Explorer</a></p><p><a href="https://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type+Something+&x=none&v=4&h=4&w=80&we=false" target=_blank>ASCII Graph Generator</a></p><p><a href=https://mermaid.js.org/ target=_blank>Mermaid</a></p><a href=https://www.vim.org/ target=_blank>Vim</a> | <a href=https://vimdoc.sourceforge.net/ target=_blank>Vim Manual Source</a> |
<a href=https://vimcdoc.sourceforge.net/ target=_blank>Vimcdoc</a> | <a href=https://vimcdoc.sourceforge.net/doc/help.html target=_blank>Vimdoc read online</a><p><a href=https://shields.io/ target=_blank>Shields.io</a></p><p><a href=https://emojidb.org/ target=_blank>EmojiDB</a></p><p><a href=https://cppreference.com/ target=_blank>cppreference</a> |
<a href=https://isocpp.org/ target=_blank>isocpp</a> |
<a href=https://open-std.org target=_blank>open-std</a></p><p><a href=https://cmake.com/ target=_blank>cmake.org</a></p><p><a href=https://llvm.org/ target=_blank>llvm.org</a></p><p><a href=https://www.boost.org/ target=_blank>boost.org</a></p><p><a href=https://learn.microsoft.com/en-us/dotnet/csharp/ target=_blank>Microsoft Learn</a><p><a href=https://www.lua.org/ target=_blank>lua.org</a> |
<a href=https://www.luarocks.org/ target=_blank>luarocks.org</a> |
<a href=https://www.luajit.org/ target=_blank>luajit.org</a></p><p><a href=https://docs.unity3d.com/Manual/index.html target=_blank>Unity Manual</a> |
<a href=https://docs.unity3d.com/ScriptReference/index.html target=_blank>Unity API</a></p><p><a href=https://docs.unrealengine.com/ target=_blank>Unreal Engine Docs</a></p><p><a href=https://godotengine.org target=_blank>Godot</a> |
<a href=https://docs.godotengine.org/en/stable/ target=_blank>Godot Docs</a></p><p><a href=https://z-library.sk/ target=_blank>Z-Library</a></p><p><a href=https://docs.kernel.org/ target=_blank>Linux Kernel Docs</a></p><p><a href=https://www.gnu.org/ target=_blank>GNU</a></p><a href=https://archlinux.org/ target=_blank>ArchLinux</a><p><a href=https://help.ubuntu.com/ target=_blank>Ubuntu Doc</a> |
<a href=https://ubuntu.com/server/docs target=_blank>Ubuntu Server Guide</a></p><p><a href=https://www.vulkan.org/ target=_blank>Vulkan</a> |
<a href=https://docs.vulkan.org/ target=_blank>Vulkan Docs</a></p><p><a href=https://www.opengl.org/ target=_blank>OpenGL</a> |
<a href=https://registry.khronos.org/OpenGL target=_blank>OpenGL API</a> |
<a href=https://www.khronos.org/opengl/wiki/ target=_blank>OpenGL Wiki</a></p><p><a href=https://learn.microsoft.com/en-us/windows/win32/directx target=_blank>DirectX</a></p><p><a href=https://www.realtimerendering.com/ target=_blank>Real-Time Rendering</a></p><p><a href=https://www.pbr-book.org/ target=_blank>Physically Based Rendering</a></p><p><a href=https://www.scratchapixel.com/ target=_blank>Scratchapixel</a></p><p><a href=https://learnopengl.com/ target=_blank>LearnOpenGL</a></p><p><a href=https://raytracing.github.io/ target=_blank>Ray Tracing in One Weekend</a></p><p><a href=https://www.shadertoy.com/ target=_blank>Shadertoy</a></p><p><a href=https://arxiv.org/list/cs.GR/recent target=_blank>arXiv Graphics</a></p><p><a href=https://www.siggraph.org/ target=_blank>SIGGRAPH</a> |
<a href=https://dl.acm.org/conference/siggraph target=_blank>SIGGRAPH Digital Library</a></p><p><a href=https://git-scm.com/ target=_blank>Git</a></p></div></div></div><script src=/js/ref-window.js></script><article class=single_article><div class=title>diff<div class=meta>Modified: 2025-12-31
| Author：ljf12825</div></div><div class=content><p><code>git diff</code>用来比较两个版本之间的差异，以文本形式显示修改了哪些行</p><p>它的本质是：</p><ul><li>计算两份文件的差异（patch）</li><li>按行标记增加（<code>+</code>）、删除（<code>-</code>）</li><li>使用颜色高亮（终端支持时）</li></ul><blockquote><p>它不只是比较已提交的版本，还可以比较工作区、暂存区、历史提交等不同状态</p></blockquote><p><strong>Git的三个状态</strong>\</p><table><thead><tr><th>名称</th><th>存储位置</th><th>作用</th><th>常用命令查看</th></tr></thead><tbody><tr><td><strong>工作区（Working Directory）</strong></td><td>本地文件系统</td><td>你正在编辑的文件</td><td><code>ls</code>、编辑器</td></tr><tr><td><strong>暂存区（Staging Area / Index）</strong></td><td><code>.git/index</code></td><td>准备提交的文件快照</td><td><code>git status</code></td></tr><tr><td><strong>本地仓库（Repository / HEAD）</strong></td><td><code>.git/objects</code></td><td>已提交的版本历史</td><td><code>git log</code></td></tr></tbody></table><p><strong>常用对比场景</strong><br><code>git diff</code>的核心是比较这三者之间的差别</p><table><thead><tr><th>命令</th><th>比较对象</th><th>作用</th><th>场景举例</th></tr></thead><tbody><tr><td><code>git diff</code></td><td><strong>工作区</strong> vs <strong>暂存区</strong></td><td>查看修改但未 <code>git add</code> 的内容</td><td>检查还没加入暂存区的改动</td></tr><tr><td><code>git diff --cached</code> 或 <code>git diff --staged</code></td><td><strong>暂存区</strong> vs <strong>本地仓库（HEAD）</strong></td><td>查看已 <code>git add</code> 但未提交的内容</td><td>检查提交前的改动</td></tr><tr><td><code>git diff HEAD</code></td><td><strong>工作区</strong> vs <strong>HEAD</strong></td><td>查看所有未提交的改动（包含未暂存 + 暂存）</td><td>总览全部本地变更</td></tr><tr><td><code>git diff commitA commitB</code></td><td><strong>两个提交</strong></td><td>比较历史版本</td><td>看某次功能从 v1 改成 v2 的细节</td></tr><tr><td><code>git diff branchA branchB</code></td><td><strong>两分支最新提交</strong></td><td>分支差异</td><td>合并前检查差别</td></tr><tr><td><code>git diff tagA tagB</code></td><td><strong>两个标签</strong></td><td>版本对比</td><td>比较正式版本</td></tr></tbody></table><p><strong>常用参数</strong>\</p><table><thead><tr><th>参数</th><th>作用</th><th>示例</th></tr></thead><tbody><tr><td><code>--name-only</code></td><td>只显示修改的文件名</td><td><code>git diff --name-only</code></td></tr><tr><td><code>--name-status</code></td><td>显示文件名 + 修改类型（A/M/D）</td><td><code>git diff --name-status</code></td></tr><tr><td><code>--stat</code></td><td>统计每个文件的修改行数</td><td><code>git diff --stat</code></td></tr><tr><td><code>-p</code>（默认）</td><td>生成补丁格式</td><td><code>git diff -p</code></td></tr><tr><td><code>--color-words</code></td><td>按词高亮而不是按行</td><td><code>git diff --color-words</code></td></tr><tr><td><code>--word-diff</code></td><td>显示逐词修改</td><td><code>git diff --word-diff</code></td></tr><tr><td><code>-U&lt;num></code></td><td>控制上下文行数</td><td><code>git diff -U0</code>（只显示改动的行）</td></tr><tr><td><code>--ignore-space-change</code> / <code>--ignore-all-space</code></td><td>忽略空格差异</td><td><code>git diff --ignore-all-space</code></td></tr><tr><td><code>--no-index</code></td><td>比较两个任意文件，不需要 git 仓库</td><td><code>git diff --no-index a.txt b.txt</code></td></tr></tbody></table><p><strong>示例</strong><br>假设改了一个文件<code>main.c</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-diff data-lang=diff><span style=display:flex><span><span style=font-weight:700>diff --git a/main.c b/main.c
</span></span></span><span style=display:flex><span><span style=font-weight:700>index 83db48f..bf269f1 100644
</span></span></span><span style=display:flex><span><span style=color:#f55>--- a/main.c
</span></span></span><span style=display:flex><span><span style=color:#50fa7b;font-weight:700>+++ b/main.c
</span></span></span><span style=display:flex><span><span style=font-weight:700>@@ -2,7 +2,7 @@
</span></span></span><span style=display:flex><span>int main() {
</span></span><span style=display:flex><span><span style=color:#f55>-   printf(&#34;Hello World\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#50fa7b;font-weight:700>+   printf(&#34;Hello Git\n&#34;);
</span></span></span><span style=display:flex><span>    return 0;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>含义：</p><ol><li><code>diff --git a/main.c b/main.c</code></li></ol><ul><li>比较<code>a/main.c</code>（旧版本）和<code>b/main.c</code>（新版本）</li></ul><ol start=2><li><code>index</code>行</li></ol><ul><li>显示旧文件和新文件的blod对象ID</li></ul><ol start=3><li><code>---</code>/<code>+++</code></li></ol><ul><li><code>---</code>是旧版本文件路径</li><li><code>+++</code>是新版本文件路径</li></ul><ol start=4><li><code>@@ -2,7 +2,7 @@</code></li></ol><ul><li><code>-2,7</code>：旧文件从第2行起，共7行</li><li><code>+2,7</code>：新文件从第2行起，共7行</li></ul><ol start=5><li><code>-</code>开头的行：被删除的内容</li><li><code>+</code>开头的行：新增的内容</li></ol><h2 id=底层原理>底层原理</h2><p><code>git diff</code>的原理是</p><ol><li>Git把对比的对象（工作区/暂存区/提交）转换成快照（blob对象）</li><li>调用内部的diff算法（最长公共子序列LCS变种）</li><li>输出一个统一格式（Unified Diff Format）的补丁</li></ol><p>所以它和<code>diff</code>命令类似，但Git做了很多优化</p><ul><li>对二进制用<code>binary diff</code></li><li>先比较哈希（O(1)）再比较文件内容（O(n)）</li><li>支持rename detection（检测文件重命名）</li></ul><h2 id=patch-file>patch file</h2><ul><li>生成补丁文件</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>git diff commitA commitB &gt; change.patch
</span></span><span style=display:flex><span>git apply change.patch
</span></span></code></pre></div><h3 id=patch-file-1>patch file</h3><p>补丁文件（patch file）是记录文件差异的文本文件，用来告诉别人（或自己）这个项目/文件需要怎么改<br>它不是完整的文件副本，而是一个差异描述，按照一定的格式（常见是Unified Diff Format）存储哪些行进行增删<br>补丁文件本质上就是git diff的文本化保存</p><p>补丁文件的作用</p><ul><li>版本迁移：把一个版本的改动应用到另一个版本上</li><li>代码分享：发给别人，让他们再自己的代码上复现你的改动</li><li>代码审查：方便阅读具体改动（很多代码评审系统背后就是用diff/patch）</li><li>离线协作：没法用Git仓库时，也能传递修改</li></ul><p>补丁文件的使用<br>假设有了一个<code>hello.patch</code>文件，别人可以在自己的项目种应用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>git apply hello.patch <span style=color:#6272a4># 只应用改动</span>
</span></span><span style=display:flex><span>git am hello.patch <span style=color:#6272a4># 应用并生成一次提交（带作者信息）</span>
</span></span></code></pre></div><p>如果不是Git项目，也能用Linux<code>patch</code>命令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>patch -p1 &lt; hello.patch
</span></span></code></pre></div><p>补丁文件的优势\</p><ul><li>体积小（只存差异）</li><li>可读性高</li><li>跨平台、跨工具</li><li>方便审查和版本回滚</li></ul><p>Git中生成补丁的几种方式\</p><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>git diff > file.patch</code></td><td>生成工作区与暂存区/HEAD 的差异补丁</td></tr><tr><td><code>git diff commitA commitB > file.patch</code></td><td>比较两个提交之间的差异</td></tr><tr><td><code>git format-patch commitA..commitB</code></td><td>生成带提交记录、作者、时间的完整补丁（更适合邮件发送）</td></tr></tbody></table><ul><li>比较某个历史文件</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>git diff HEAD~3 HEAD -- src/game.cpp
</span></span></code></pre></div><ul><li>只看新增的函数（配合<code>grep</code>）</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>git diff HEAD~1 | grep <span style=color:#f1fa8c>&#39;^+&#39;</span>
</span></span></code></pre></div></div><nav class=post-nav><a href=/unixlike/log/describe/ class=hover:underline>pre: describe</a>
<a href=/unixlike/log/diff-index/ class=hover:underline>next: diff-index</a></nav></article><aside class=toc><h3>TOC</h3><nav id=TableOfContents><ul><li><ul><li><a href=#底层原理>底层原理</a></li><li><a href=#patch-file>patch file</a><ul><li><a href=#patch-file-1>patch file</a></li></ul></li></ul></li></ul></nav></aside><script src=/js/scrollspy.js defer></script><script type=module>
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ 
    startOnLoad: true, theme: "default" });
</script><footer><div class=container><p>© 2026 Jeff Lee(ljf12825). All rights reserved |
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>Article: CC BY-NC-SA 4.0</a> |
<a href=https://creativecommons.org/licenses/by-sa/4.0/>Content: CC BY-SA 4.0</a> |
<a href=https://opensource.org/licenses/MIT>Code: MIT License</a> |
<a href=/LICENSES.md>Full License</a></p></div></footer></body></html>
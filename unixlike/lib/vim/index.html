<!doctype html><html lang=en><head><meta charset=UTF-8><title>Vim</title><link rel=stylesheet href=/css/style.css><link href=https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/prism.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-csharp.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-cpp.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-json.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-bash.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-ini.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-c.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><link rel=stylesheet href=/css/blogsingle.css></head><body><header class=site-header><div class=container><div class=terminal-overlay aria-label=terminal-prompt><span id=typed-line></span><span class=cursor>█</span></div></div></header><nav class=topnav><div class=container><ul><li><a href=/unixlike/>★</a></li><li><a href=/unixlike/lab/>Lab</a></li><li><a href=/unixlike/lib/>Lib</a></li><li><a href=/unixlike/file/>File</a></li></ul></div></nav><nav id=star-nav><div id=star-header><span class="title open">>> >> >> Navigation &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Nav>>>>>></span></div><pre class=ascii>
+——————————————————————————————————————————————————————————————+
|                        <a class=nav-item data-path=/rightbrain/ href=/rightbrain/>RightBrain</a>                            |
|                             |                                |
|                             |     <a class=nav-item data-path=/dotnetandwindows/ href=/dotnetandwindows/>.NET-Windows</a>               |
|                             |    /                           |
|                             |   /                            |
|                             |  /                             |
|                             | /                              |
|                             |/                               |
|      <a class=nav-item data-path=/graphic/ href=/graphic/>Graphic</a> ———————————— <a class=nav-item data-path=/home/ href=/home/>Home</a> ————————————— <a class=nav-item data-path=/system/ href=/system/>System</a>          |
|                            /|                                |
|                           / |                                |
|                          /  |                                |
|                         /   |                                |
|                        /    |                                |
|                       /     |                                |
|              <a class=nav-item data-path=/unixlike/ href=/unixlike/>Unix-like</a>      |                <a class=nav-item data-path=/project/ href=/project/>Project</a>         |
|                             |                <a class=nav-item data-path=/miscellaneous/ href=/miscellaneous/>Miscellaneous</a>   |
|                          <a class=nav-item data-path=/csbasic/ href=/csbasic/>CSBasic</a>             <a class=nav-item data-path=/ai/ href=/ai/>AI</a>              |
+——————————————————————————————————————————————————————————————+
    </pre></nav><script defer src=/js/star-nav.js></script><script defer src=/js/site.js></script><script defer src=/js/star-active.js></script><div id=ref-window class="float-window open"><div class=float-header><span class="title open">>> >> >> Reference &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Ref>>>>>></span></div><div class=float-body><div class=ref-list><a href=https://www.mixamo.com/ target=_blank>Mixamo</a> |
<a href=https://opengameart.org/ target=_blank>OpenGameArt</a><p><a href=https://sharplab.io/ target=_blank>SharpLab</a> |
<a href=https://godbolt.org/ target=_blank>Compiler Explorer</a></p><p><a href="https://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type+Something+&x=none&v=4&h=4&w=80&we=false" target=_blank>ASCII Graph Generator</a></p><p><a href=https://mermaid.js.org/ target=_blank>Mermaid</a></p><a href=https://www.vim.org/ target=_blank>Vim</a> | <a href=https://vimdoc.sourceforge.net/ target=_blank>Vim Manual Source</a> |
<a href=https://vimcdoc.sourceforge.net/ target=_blank>Vimcdoc</a> | <a href=https://vimcdoc.sourceforge.net/doc/help.html target=_blank>Vimdoc read online</a><p><a href=https://shields.io/ target=_blank>Shields.io</a></p><p><a href=https://emojidb.org/ target=_blank>EmojiDB</a></p><p><a href=https://cppreference.com/ target=_blank>cppreference</a></p><p><a href=https://gcc.gnu.org/onlinedocs/ target=_blank>GCC Docs</a></p><p><a href=https://clang.llvm.org/docs/ target=_blank>Clang Docs</a></p><p><a href=https://www.boost.org/libraries/ target=_blank>Boost Library Docs</a></p><p><a href=https://learn.microsoft.com/en-us/dotnet/csharp/ target=_blank>Microsoft Learn</a><p><a href=https://www.lua.org/manual/5.4/ target=_blank>Lua 5.4 Reference Manual</a><p><a href=https://docs.unity3d.com/Manual/index.html target=_blank>Unity Manual</a> |
<a href=https://docs.unity3d.com/ScriptReference/index.html target=_blank>Unity API</a></p><p><a href=https://docs.unrealengine.com/ target=_blank>Unreal Engine Docs</a></p><p><a href=https://godotengine.org target=_blank>Godot</a> |
<a href=https://docs.godotengine.org/en/stable/ target=_blank>Godot Docs</a></p><p><a href=https://z-library.sk/ target=_blank>Z-Library</a> : eBook Library</p><p><a href=https://docs.kernel.org/ target=_blank>Linux Kernel Docs</a></p><p><a href=https://www.gnu.org/ target=_blank>GNU</a> : manuals, philosophy, FAQ</p><a href=https://archlinux.org/ target=_blank>ArchLinux</a><p><a href=https://help.ubuntu.com/ target=_blank>Ubuntu Doc</a> |
<a href=https://ubuntu.com/server/docs target=_blank>Ubuntu Server Guide</a></p><p><a href=https://www.vulkan.org/ target=_blank>Vulkan</a> |
<a href=https://docs.vulkan.org/ target=_blank>Vulkan Docs</a></p><p><a href=https://www.opengl.org/ target=_blank>OpenGL</a> |
<a href=https://registry.khronos.org/OpenGL target=_blank>OpenGL API</a> |
<a href=https://www.khronos.org/opengl/wiki/ target=_blank>OpenGL Wiki</a></p><p><a href=https://learn.microsoft.com/en-us/windows/win32/directx target=_blank>DirectX</a></p><p><a href=https://www.realtimerendering.com/ target=_blank>Real-Time Rendering</a></p><p><a href=https://www.pbr-book.org/ target=_blank>Physically Based Rendering</a></p><p><a href=https://www.scratchapixel.com/ target=_blank>Scratchapixel</a></p><p><a href=https://learnopengl.com/ target=_blank>LearnOpenGL</a></p><p><a href=https://raytracing.github.io/ target=_blank>Ray Tracing in One Weekend</a></p><p><a href=https://www.shadertoy.com/ target=_blank>Shadertoy</a></p><p><a href=https://arxiv.org/list/cs.GR/recent target=_blank>arXiv Graphics</a></p><p><a href=https://www.siggraph.org/ target=_blank>SIGGRAPH</a> |
<a href=https://dl.acm.org/conference/siggraph target=_blank>SIGGRAPH Digital Library</a></p><p><a href=https://git-scm.com/ target=_blank>Git</a> |
<a href=https://git-scm.com/doc target=_blank>Docs</a> |
<a href=https://git-scm.com/community target=_blank>Community</a></p></div></div></div><script src=/js/ref-window.js></script><article class=single_article><div class=title>Vim<div class=meta>Update: 2025-12-31
>> Creator：ljf12825</div></div><div class=content><h1 id=vi历史背景-from-wikipedia>vi（历史背景 from Wikipedia）</h1><p>vi是一款面向屏幕的文本编辑器，最初是为Unix操作系统创建的。vi的可移植行为子集以及它所支持的ex编辑器语言，被Single UNIX Specification 和 POSIX标准正式规范<br>vi实际上是更早的ex编辑器的一个模式（visual mode），而不是一个独立的程序<br>最初的ex只有行编辑能力，没有全屏显示。1976年，Bill Joy 为ex增加里visual编辑模式。<code>ex</code>启动进入行模式，<code>vi</code>启动进入visual模式<br><code>vi</code>这个名字来自ex中的<code>visual</code>命令的最短不歧义缩写<br>vi的技术源头是ed(Unix最早的行编辑器)，ed为电传打字机（TTY）设计，极其简陋。1976年，George Coulouris基于ed开发里em(editor for mortals)，Bill Joy在UC Berkeley借鉴em改造ed,开发出ex,再在ex中加入全屏visual模式 -> vi. vi的很多思想（如模式编辑，<code>.</code>重复命令）借鉴自Xerox PARC的Bravo编辑器<br>Bill Joy使用的是ADM-3A终端，<code>Esc</code>键位就是现代键盘的<code>TAB</code>键位，没有独立方向键，而是和<code>hjkl</code>键共用，300波特率调制解调器非常慢。因此，命令设计极度简洁，支持“提前输入”，鼓励不离开主键区操作，这直接塑造了vi今天的操作方式<br>1978年，vi(ex 1.1)随BSD Unix发布，很多Unix系统免费自带vi,这是vi普及的决定性原因之一。后来AT&amp;T System V,各商业Unix(Sun, HP, IBM, DEC)都内置并维护自己的vi变种。最终vi成为Unix世界的事实标准编辑器，并被POSIX明确要求支持<br>由于早期vi代码依赖AT&amp;T Unix授权，无法自由分发，于是出现了大量兼容克隆：Elvis(1990), nvi(BSD官方替代)，Vim（从Stevie演化而来），BusyBox vi, Neovim（Vim的现代重构）。BSD系统最终使用nvi，Linux和macOS世界则几乎全面采用Vim/Neovim<br>vi是一个模态编辑器（modal editor），学习曲线陡峭，但熟练后效率极高<br>原始vi(POSIX vi)的能力非常有限：无语法高亮，无插件系统，无LSP/补全，无现代编码支持（UTF-8）支持不完整，无多窗口/多标签（或极其原始）。它的定位是：最低可用编辑器，而不是高效开发环境。vi当年的核心使命是：在任何Unix系统上，在极端受限环境下，提供一个可视化文本编辑能力。而现在，终端性能不再是瓶颈，GUI编辑器普及，SSH环境也能跑功能完整的Vim,原始vi不需要再承担主力开发工具的角色，而是成为一种标准和哲学，活在现代vi分发版本中</p><h1 id=modal-editor>Modal Editor</h1><p>模态编辑器指的是编辑操作分不同“模式”来完成的文本编辑器，而不是像普通的编辑器那样随时都在“插入文字”状态</p><h2 id=核心思想>核心思想</h2><p>在模态编辑器中，键盘的输入行为取决于当前模式</p><ul><li>普通模式（Normal Mode）
主要用来浏览、移动光标、删除、复制、粘贴等操作，按下字母并不会直接插入文字</li><li>插入模式（Insert Mode）
像常见编辑器一样，输入的字符直接写入文件</li><li>命令模式（Command/Ex Mode）
可以执行保存、查找替换、退出等命令</li></ul><p>不同模式下，同样的键盘按键代表着不同的功能，这就是模态的本质</p><h2 id=优势>优势</h2><ul><li>双手不离开主键区</li><li>命令高度可组合</li><li>编辑操作高度抽象</li></ul><h2 id=缺点>缺点</h2><ul><li>模式切换反馈弱</li><li>新手极易“输错模式”</li></ul><h1 id=vim>Vim</h1><p>Vim是一款免费开源的文本编辑器。Vim既提供终端屏幕用户界面，也提供图形用户界面（gvim）<br>Vim的文档将其描述为旧版vi文本编辑器的改进版本。在发布信息中，作者最初暗示Vim是Vi Imitation的缩写。但后来，由于作者所描述的功能已经超越了vi克隆版，因此其缩写改为Vi IMproved.</p><ul><li><a href=vim.org>vim.org</a></li><li><a href=mailto:git@github.com>git@github.com</a>:vim/vim.git</li></ul><h2 id=安装>安装</h2><p>大部分Linux发行版都自带Vim,但通常是精简版（<code>vim-tiny</code>），目的是提供默认语义，现代开发架构和教程默认vi存在。以及在最坏情况下保证正常使用。Linux允许同一软件多版本存在，通过alternatives进行管理。如果想要完整版本，需要手动安装</p><h3 id=通过包管理器安装>通过包管理器安装</h3><p>通过包管理器安装的vim通常是系统编译好的Vim,能满足最低使用，但可能不会支持一些功能如剪贴板，语言支持等，且版本可能会滞后</p><ul><li>Debian</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install vim 
</span></span></code></pre></div><ul><li>Arch Linux</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo pacman -S vim 
</span></span></code></pre></div><h3 id=从源码安装>从源码安装</h3><p>从源码编译安装Vim可以让你根据自己的需求定制Vim的功能</p><ol><li>安装必要的依赖</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update 
</span></span><span style=display:flex><span>sudo apt install -y git build-essential ncurses-dev 
</span></span></code></pre></div><p>对于其他Linux发行版，安装方式可能不同，但大致依赖是<code>git</code>, <code>build-essential</code>（或<code>gcc</code>, <code>make</code>）和<code>ncurses</code>库</p><ol start=2><li>获取Vim源码</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/vim/vim.git
</span></span></code></pre></div><ol start=3><li>配置编译选项
进入Vim源码目录并执行<code>./configure</code>来设置编译选项。可以通过<code>./configure --help</code>查看可用的选项。以下是一些常用的编译选项</li></ol><ul><li><code>--enable-gui=gtk2</code>：启用GTK2图形界面（如果需要图形界面版本）</li><li><code>--with-feature=huge</code>：启用尽可能多的功能</li><li><code>--enable-multibyte</code>：支持多字节字符集（如果需要支持其他语言）</li><li><code>--enable-python3interp</code>：启用Python3插件支持</li><li><code>--enable-cscope</code>：启用Cscope支持</li></ul><p>示例：如果只想编译一个支持Python3和最大功能的Vim,可以这样写</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>cd vim 
</span></span><span style=display:flex><span>./configure --with-feature<span style=color:#f92672>=</span>huge --enable-python3interp --enable-multibyte
</span></span></code></pre></div><p>当运行<code>./configure</code>时，它会生成一个名为<code>config.log</code>的文件，里面详细记录了配置过程中检查每个功能是否可用的结果<br>在运行<code>./configure</code>后，它会生成一个<code>Makefile</code>文件，其中包含了配置的选项。在其中，可以找到一些启用的功能，尤其是和编译相关的设置</p><ol start=4><li><p>编译Vim
配置完成后，使用<code>make</code>命令进行编译。这一步会编译Vim的所有源代码，过程可能需要几分钟时间，取决于机器性能</p></li><li><p>安装Vim
编译完成后，可以用以下命令进行安装</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo make install 
</span></span></code></pre></div><ol start=6><li>检查安装
安装完成后，可以通过以下命令检查Vim是否正确安装</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>vim --version 
</span></span></code></pre></div><p>如果显示了你配置时选择的功能选项，说明安装成功</p><ol start=7><li>卸载Vim
如果不再需要编译版的Vim,或者想要重新配置，使用以下命令卸载</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo make uninstall
</span></span></code></pre></div><p>如果需要卸载其他版本的Vim,记得先删除系统的Vim或将其替换</p><h2 id=使用>使用</h2><h3 id=内置帮助>内置帮助</h3><p>Vim自带一个完整、详细的帮助系统，可以在终端里直接访问<br>基本命令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>help</span> <span style=color:#75715e>&#34; 打开帮助页</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>help</span> &lt;<span style=color:#a6e22e>topic</span>&gt; <span style=color:#75715e>&#34; 查询某个主题</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>help</span> <span style=color:#a6e22e>user</span>-<span style=color:#a6e22e>manual</span> <span style=color:#75715e>&#34; 打开用户手册</span>
</span></span></code></pre></div><h3 id=vim-tutor>Vim Tutor</h3><p>Vim Tutor是Vim自带的交互式入门教程，用于帮助新手快速掌握Vim的基础操作，它直接在终端中运行，不需要额外安装<br>在CLI中的</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>vimtutor 
</span></span></code></pre></div><p>这个命令会打开一个交互式教程文件，通常路径在</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>/usr/share/vim/vim&lt;edition&gt;/tutor/tutor&lt;language&gt;.txt
</span></span></code></pre></div><p>中文教程为</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>vimtutor zh 
</span></span></code></pre></div><h2 id=配置>配置</h2><h2 id=vimscript>Vimscript</h2><h3 id=vim-1>Vim</h3><p><strong>启动与退出</strong>\</p><ul><li><code>vim &lt;filename></code> 打开文件</li><li><code>:q</code> 退出（无修改时）</li><li><code>:q!</code> 强制退出（不保存）</li><li><code>:w</code> 保存</li><li><code>:wq</code>或<code>:x</code> 保存并退出</li></ul><p><strong>模式切换</strong><br>Vim有多种模式，常见的有：</p><ul><li>普通模式（Normal Mode）<ul><li>默认模式，用于导航和命令操作</li></ul></li><li>插入模式（Insert Mode）<ul><li>在此模式下可以编辑文本</li></ul></li><li>命令模式（Command Mode）<ul><li>用来执行保存、退出等命令</li></ul></li><li>可视模式（Visual Mode）<ul><li>选择文本进行操作，如复制、粘贴、删除、格式化等</li></ul></li></ul><p><strong>普通模式</strong><br>启动Vim时，默认进入普通模式，或从其他模式按<code>Esc</code>进入普通模式\</p><p>常见操作</p><ol><li>导航：在普通模式下，移动光标是最常见的操作</li></ol><ul><li><code>h</code>：光标左移</li><li><code>j</code>：光标下移</li><li><code>k</code>：光标上移</li><li><code>l</code>：光标右移</li><li><code>w</code>：跳到下一个单词的开头</li><li><code>b</code>：跳到当前单词的开头</li><li><code>0</code>：跳到行首</li><li><code>$</code>：跳到行尾</li><li><code>gg</code>：跳到文件的第一行</li><li><code>G</code>：跳到文件的最后一行</li><li><code>Ctrl-u</code>：向上滚动一页</li><li><code>Ctrl-d</code>：向下滚动一页</li></ul><ol start=2><li>删除文本</li></ol><ul><li><code>d</code>：删除（需要指定范围，例如<code>dw</code>删除一个单词，<code>dd</code>删除整行）</li><li><code>d$</code>：删除从光标当前位置到行尾的所有文本</li><li><code>d0</code>：删除光标从当前位置到行首的所有文本</li></ul><ol start=3><li>复制和粘贴</li></ol><ul><li><code>y</code>：复制（需要指定范围，例如<code>yw</code>复制一个单词，<code>yy</code>复制一行）</li><li><code>p</code>：粘贴（在光标后粘贴）</li><li><code>P</code>：粘贴（在光标前粘贴）</li></ul><ol start=4><li>替换文本</li></ol><ul><li><code>r&lt;char></code>：将光标所在的字符替换为指定字符。例如，<code>rx</code>会将光标处的字符替换成<code>x</code></li><li><code>s</code>：删除光标处的字符并进入插入模式</li><li><code>cc</code>：删除当前行并进入插入模式</li></ul><ol start=5><li>撤销和重做</li></ol><ul><li><code>u</code>：撤销最近的操作</li><li><code>Ctrl-r</code>：重做最近的撤销操作</li></ul><ol start=6><li>查找</li></ol><ul><li><code>/text</code>：向下查找text，然后按<code>n</code>查找下一个匹配项，<code>N</code>查找上一个匹配项</li><li><code>?text</code>：向上查找<code>text</code>，然后按<code>n</code>查找下一个匹配项，<code>N</code>查找上一个匹配项</li></ul><ol start=7><li>替换</li></ol><ul><li><code>:s/old/new/g</code>：替换当前行的所有<code>old</code>为<code>new</code></li><li><code>:%s/old/new/g</code>：替换文件中所有的<code>old</code>为<code>new</code></li></ul><ol start=8><li>打开和关闭文件</li></ol><ul><li><code>:e filename</code>：打开指定的文件</li><li><code>:w</code>：保存当前文件</li><li><code>:q</code>：退出当前文件</li><li><code>:wq</code>：保存并退出</li><li><code>:q!</code>：强制退出，不保存修改</li></ul><ol start=9><li>其他操作</li></ol><ul><li><code>.</code>：重复上一个修改操作</li><li><code>Ctrl-o</code>：跳到上一个位置</li><li><code>Ctrl-i</code>：跳到下一个位置</li></ul><p><strong>插入模式</strong><br>在Vim中，插入模式可以直接输入文本，当处于插入模式时，可以像使用任何普通文本编辑器一样，输入和编辑内容<br>在Vim的普通模式下，可以通过输入以下指令进入插入模式：</p><ul><li><code>i</code>：在光标前插入文本</li><li><code>I</code>在光标所在行的行首插入文本</li><li><code>a</code>：在光标后插入文本</li><li><code>A</code>：在光标所在行的行尾插入文本</li><li><code>o</code>：在当前行下方插入一行（并进入插入模式）</li><li><code>O</code>：在当前行上方插入一行（并进入插入模式）</li></ul><ol><li>在插入模式下的基本操作</li></ol><ul><li>输入文本：进入插入模式后，可以像普通文本编辑器一样输入字符</li><li>删除字符：按<code>Backspace</code>键删除光标前的字符，或按<code>Delete</code>键删除光标后的字符</li></ul><ol start=2><li>退出插入模式</li></ol><ul><li>按<code>Esc</code>键：返回普通模式</li></ul><ol start=3><li>插入模式的快捷操作</li></ol><ul><li>光标移动，在插入模式中，仍然可以使用箭头键或<code>Ctrl + h</code>（删除字符）等快捷键来移动光标或字符</li><li>自动完成：在插入模式下，Vim可以自动完成单词或命令。按<code>Ctrl + n</code>或<code>Ctrl + p</code>来启用自动完成（向前和向后）</li></ul><p>插入模式使用场景\</p><ol><li>直接输入文本：插入模式是直接输入或编辑文件内容的地方，通常是处理普通文本、代码注释、字符串等的场景</li><li>编写代码：虽然Vim的强大之处在于普通模式下的操作，但在插入模式下可以像使用普通编辑器一样快速编写代码</li></ol><p><strong>命令模式</strong><br>在Vim中，命令模式允许执行一些文件级的操作，比如保存、退出、查找、替换、设置选项等<br>命令模式是Vim操作的核心之一，可以通过命令来控制Vim的行为\</p><p>如何进入命令模式：</p><ul><li>按<code>:</code>键从普通模式进入命令模式</li><li>在命令模式下，可以输入各种命令，并按<code>Enter</code>执行</li></ul><p>场景命令模式操作</p><ol><li>保存文件</li></ol><ul><li><code>:w</code>：保存当前文件，但不退出Vim</li><li><code>:w filename</code>：保存文件并为其指定新的文件名</li></ul><ol start=2><li>退出Vim</li></ol><ul><li><code>:q</code>：退出Vim，如果文件没有保存，Vim会警告</li><li><code>:q!</code>：强制退出Vim，不报错文件中的修改</li><li><code>:wq</code>或<code>:x</code>：保存文件并退出</li><li><code>:wq!</code>：强制保存并退出</li></ul><ol start=3><li>查找和替换</li></ol><ul><li><p>查找</p><ul><li><code>: /pattern</code>：查找<code>pattern</code>，按<code>n</code>查找下一个匹配项，<code>N</code>查找上一个匹配项</li><li><code>:?pattern</code>：向上查找<code>pattern</code></li></ul></li><li><p>替换</p><ul><li><code>:s/old/new/</code>：替换当前行中的第一个<code>old</code>为<code>new</code></li><li><code>:s/old/new/g</code>：替换当前行中的所有<code>old</code>为<code>new</code></li><li><code>:%s/old/new/g</code>：替换文件中的所有<code>old</code>为<code>new</code></li><li><code>:%s/old/new/gc</code>：替换文件中的所有<code>old</code>为<code>new</code>，并在每次替换前询问确认</li></ul></li></ul><ol start=4><li>文件跳转</li></ol><ul><li><code>:e filename</code>：打开或编辑指定文件</li><li><code>:bn</code>：跳转到下一个缓冲区（打开的文件）</li><li><code>:bp</code>：跳转到上一个缓冲区</li><li><code>:b N</code>：跳转到第N个缓冲区</li><li><code>:args</code>：查看打开的文件列表</li></ul><ol start=5><li>撤销和重做</li></ol><ul><li><code>:undo</code>：撤销上一步操作</li><li><code>:redo</code>：重做已撤销的操作</li></ul><ol start=6><li>设置Vim选项</li></ol><ul><li><code>:set number</code>：显示行号</li><li><code>:set nonumber</code>：隐藏行号</li><li><code>:set tabstop=4</code>：设置制表符宽度为4个空格</li><li><code>:set expandtab</code>：使用空格代替制表符</li><li><code>:set autoindent</code>：自动缩进</li></ul><ol start=7><li>查看和跳转到文件行</li></ol><ul><li><code>:line_number</code>：跳转到指定的行号</li><li><code>:n</code>：跳转到第n个文件的当前位置（如果有多个文件已打开）</li><li><code>:normal &lt;command></code>：执行普通模式命令</li></ul><ol start=8><li>帮助命令</li></ol><ul><li><code>:help</code>：显示Vim的帮助文档</li><li><code>:help command</code>：显示特定命令的帮助文档</li><li><code>:q</code>：退出帮助文档</li></ul><ol start=9><li>执行外部命令</li></ol><ul><li><code>:!command</code>：执行外部命令并返回结果</li><li><code>:w !command</code>：将当前文件通过管道传递给外部命令并保存其输出</li></ul><ol start=10><li>退出其他模式</li></ol><ul><li><code>normal</code>：退出插入模式并返回普通模式</li></ul><p><strong>命令模式的特点</strong>\</p><ul><li>输入方式：命令模式以<code>:</code>开头，输入命令后按<code>Enter</code>执行</li><li>全局命令：命令模式中的操作通常影响整个文件或Vim的全局设置，而不是单纯的光标或行操作</li><li>快捷键：在命令模式下，可以利用键盘快捷键进行某些命令</li><li>命令历史：命令模式支持命令历史，可以通过按上下箭头浏览之前输入的命令</li></ul><p><strong>命令模式应用场景</strong>\</p><ul><li>保存和退出：可以在编辑完文件后使用命令模式保存文件或退出Vim</li><li>查找和替换：命令模式非常适合进行复杂的查找和替换操作，尤其是需要对文件中的大量内容进行批量修改时</li><li>配置Vim：在命令模式下设置Vim行为（如行号显示、制表符宽度）</li><li>执行外部命令：命令模式可以在Vim内部运行外部命令，灵活集成工作流</li></ul><p><strong>可视模式</strong><br>可视模式允许选择文本进行操作</p><p>如何进入可视模式<br>在普通模式下：</p><ul><li><code>v</code>：进入字符选择模式（Visual Mode）。按此键后，光标将开始选择字符，可以通过移动光标来扩展选择区域</li><li><code>V</code>：进入行选择模式（Visual Line Mode）。按此键后，会选择光标所在的整行，移动光标可以选择更多的行</li><li><code>Ctrl</code> + <code>V</code>：进入块选择模式（Visual Block Mode）。这是一个非常强大的模式，允许选择矩形区域（列选择），尤其适用于对列式数据或代码进行操作</li></ul><p><strong>可视模式操作</strong><br>一旦进入可视模式，可以通过以下方式进行文本选择和编辑</p><ol><li>选择文本</li></ol><ul><li>字符选择模式（<code>v</code>）：按<code>v</code>进入字符选择模式后，可以通过移动光标（<code>h/j/k/l</code>、方向键等）来选择字符。选择的文本将高亮显示</li><li>行选择模式（<code>V</code>）：按<code>V</code>进入行选择模式后，Vim会选择当前光标所在的整行。可以通过按<code>j</code>或<code>k</code>来选择更多的行</li><li>块选择模式（<code>Ctrl</code> + <code>V</code>）：按<code>Ctrl</code> + <code>V</code>进入块选择模式后，可以选择矩形区域。按方向键（<code>h/j/k/l</code>）扩展选区，选区可以跨越多行</li></ul><ol start=2><li>移动光标
在可视模式中，光标会随着移动而扩大或缩小选区</li></ol><ul><li>可以按<code>h/j/k/l</code>（或者方向键）来移动光标并调整选择区域</li><li>也可以使用<code>w</code>（到下一个单词）、<code>b</code>（到前一个单词）、<code>$</code>（到行尾）等命令快速跳转</li></ul><ol start=3><li>对选中的文本进行操作
一旦选择了文本，可以执行以下操作</li></ol><ul><li>删除：按<code>d</code>删除选中的文本</li><li>复制（Yank）：按<code>y</code>复制选中的文本</li><li>粘贴：按<code>p</code>将复制的文本粘贴到光标后，按<code>P</code>粘贴到光标前</li><li>替换：按<code>c</code>修改选中的文本并进入插入模式，或者按<code>r&lt;cahr></code>替换选中的字符</li><li>缩进：按<code>></code>增加缩进，按<code>&lt;</code>减少缩进</li><li>格式化：按<code>=</code>对选中的文本进行格式化（适用于代码格式化）</li></ul><ol start=4><li>撤销和重做</li></ol><ul><li>撤销：按<code>u</code>撤销在可视模式下的操作</li><li>重做：按<code>Ctrl-r</code>重做操作</li></ul><ol start=5><li>退出可视模式</li></ol><ul><li>按<code>Esc</code>返回普通模式</li></ul><ol start=6><li>扩展选区</li></ol><ul><li>在可视模式中，可以使用Vim的基本移动命令来扩展或缩小选择范围<ul><li><code>w</code>：扩展选择到下一个单词的开始</li><li><code>b</code>：扩展选择到当前单词的开始</li><li><code>$</code>：扩展选择到当前行的行尾</li><li><code>0</code>：扩展选择到行的开头</li></ul></li></ul><ol start=7><li>块选择模式（Ctrl + v）</li></ol><ul><li>在块选择模式下，可以选择一个矩形区域，这对于多行列操作特别有用</li><li>批量编辑列：选择列后，可以使用<code>I</code>来在每行开头插入文本，或者使用<code>D</code>删除整列</li><li>例如，选中几行或某一列后，按<code>I</code>然后输入文本，按<code>Esc</code>会在每行相同位置插入文本</li></ul><ol start=8><li>复制到剪贴板</li></ol><ul><li>如果希望将选中的文本复制到系统剪贴板，可以使用<code>"+y</code>或<code>"*y</code>（具体取决于Vim配置和系统）将选中的内容复制到剪贴板中</li></ul><ol start=9><li>多个操作</li></ol><ul><li>在可视模式下，可以使用多个命令进行符合操作。例如，可以选择文本后直接进行缩进、删除、复制或修改</li><li><code>></code>：向右缩进选中的文本</li><li><code>&lt;</code>：向左缩进选中的文本</li></ul><p><strong>可视模式应用场景</strong>\</p><ul><li>文本编辑：可视模式非常适合快速选择并操作文本，如删除一段文本、复制并粘贴到其他位置等</li><li>代码修改：在编程时，可以使用可视模式来选择并修改多行代码，特别是在进行批量修改时（如缩进、对齐等）</li><li>列操作：在处理列式数据时，块选择模式（<code>Ctrl</code> + <code>V</code>）非常有用，可以方便地选择和编辑矩形区域的文本</li></ul><p><strong>分屏操作</strong>\</p><ul><li><code>:sp &lt;filename></code>/<code>:split &lt;filename></code>：水平分屏</li><li><code>:vsp &lt;filename></code>/<code>:vs &lt;filename></code> / <code>:vsplit &lt;filename></code>：垂直分屏</li><li><code>Ctrl+w, ^v&lt;></code> / <code>Ctrl+w, hjkl</code>：切换分屏</li><li><code>Ctrl+w, =</code>：均分窗口大小</li><li><code>Ctrl+w, s</code>：当前窗口水平分割</li><li><code>:new &lt;filename></code>：创建新文件并水平分屏</li><li><code>vnew &lt;filename></code>：创建新文件并垂直分屏</li><li><code>Ctrl+w, v</code>：当前窗口垂直分割</li><li><code>Ctrl+w, w</code>：循环切换所有窗口</li><li><code>Ctrl+w, p</code>：切换到前一个窗口</li><li><code>Ctrl+w, t</code>：切换到顶部窗口</li><li><code>Ctrl+w, b</code>：切换到底部窗口</li><li><code>Ctrl+w, _</code>：当前窗口最大化高度</li><li><code>Ctrl+w, |</code>：当前窗口最大化宽度</li><li><code>Ctrl+w, +</code>：增加当前窗口高度</li><li><code>Ctrl+w, -</code>：减少当前窗口高度</li><li><code>:res[ize] +N</code>：增加N行高度</li><li><code>:res[ize] -N</code>：减少N行高度</li><li><code>Ctrl+w, ></code>：增加当前窗口宽度</li><li><code>Ctrl+w, &lt;</code>：减少当前窗口宽度</li><li><code>:vertical resize +N</code>：增加N列宽度</li><li><code>:vertical resize -N</code>：减少N列宽度</li><li><code>Ctrl+w, r</code>：向右/向下旋转窗口</li><li><code>Ctrl+w, R</code>：向左/向上旋转窗口</li><li><code>Ctrl+w, x</code>：交换当前窗口和下一个窗口</li><li><code>Ctrl+w, K</code>：将窗口移到顶部</li><li><code>Ctrl+w, J</code>：将窗口移到底部</li><li><code>Ctrl+w, H</code>：将窗口移到最左</li><li><code>Ctrl+w, L</code>：将窗口移到最右</li><li><code>:q</code>：关闭当前窗口</li><li><code>:close</code>/<code>:clo</code>：关闭当前窗口</li><li><code>:only</code>/<code>:on</code>：关闭其他所有窗口</li><li><code>Ctrl+w, c</code>：关闭当前窗口</li><li><code>Ctrl+w, o</code>：关闭其他所有窗口</li><li><code>vim -o file1 file2 file3</code>：水平分屏打开多个文件</li><li><code>vim -O file1 file2 file3</code>：垂直分屏打开多个文件</li></ul><p><strong>指令教程</strong>\</p><ul><li>指令速查表<a href=https://vim.rtorr.com/>Vim Cheat Sheet</a></li><li>在线练习<a href=https://openvim.com/>openvim</a></li><li>终端运行<code>vimtutor</code>（内置教程）</li></ul><p><strong>插件管理</strong><br>Vim的插件系统能够扩展和定制Vim的功能，使其更加适应工作流程。通过安装和使用插件，可以增强Vim的能力，比如自动完成、语法高亮、代码片段、文件浏览器等</p><p><strong>插件管理器</strong><br>要高效管理Vim插件，通常需要使用插件管理器。以下是一些常用的插件管理器</p><ul><li>Vundle：最早的Vim插件管理工具之一，易于使用</li><li>vim-plug：现代的插件管理器，安装和配置插件都非常简单</li><li>Pathogen：简单的插件管理工具，但不如vim-plug灵活</li></ul><p>vim-plug的安装与配置
安装<code>vim-plug</code>，首先将<code>vim-plug</code>插件管理器下载到Vim配置目录中</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fLo ~/.vim/autoload/plug.vim --create-dirs <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
</span></span></code></pre></div><p>这个命令会将<code>pulg.vim</code>文件下载到<code>~/.vim/autodownload/</code>目录下，并创建相应的目录结构
然后，可以在<code>~/.vimrc</code>文件中配置插件，插件声明用<code>Plug</code>关键字</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 启动插件管理器</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>call</span> <span style=color:#a6e22e>plug</span>#<span style=color:#a6e22e>begin</span>(<span style=color:#e6db74>&#39;~/.vim/plugged&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 列出需要安装的插件</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Plug</span> <span style=color:#e6db74>&#39;tpope/vim-sensible&#39;</span>  <span style=color:#75715e>&#34; 基础配置插件</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Plug</span> <span style=color:#e6db74>&#39;junegunn/fzf.vim&#39;</span>   <span style=color:#75715e>&#34; 文件搜索插件</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Plug</span> <span style=color:#e6db74>&#39;neoclide/coc.nvim&#39;</span>   <span style=color:#75715e>&#34; 自动完成插件</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 结束插件配置</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>call</span> <span style=color:#a6e22e>plug</span>#<span style=color:#a6e22e>end</span>()
</span></span></code></pre></div><p>保存并退出<code>.vimrc</code>后，重新启动Vim，并运行以下命令来安装插件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>PlugInstall</span>
</span></span></code></pre></div><ul><li><code>call plug#begin()</code>：这是 vim-plug 插件管理器的开始指令，括号内的路径指向插件安装目录。~/.vim/plugged 是插件的安装目录，你可以根据需要修改</li><li><code>Plug '插件仓库地址'</code>：这里列出你要安装的插件，插件的名称通常是 GitHub 上的仓库地址</li><li><code>call plug#end()</code>：这是插件配置的结束指令，表示 vim-plug 配置的结束</li></ul><p>vim-plug的使用
<code>vim-plug</code>是一个轻量级、易于使用的Vim插件管理器，可以帮助快速安装、更新和管理插件。与其他插件管理器相比，<code>vim-plug</code>配置简单，支持并行安装插件，并且具有高效的更新机制</p><p>更新插件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>PlugUpdate</span>
</span></span></code></pre></div><p>删除插件</p><ol><li>打开<code>.vimrc</code>文件</li><li>删除不需要的插件行</li><li>在Vim中</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>PlugClean</span>
</span></span></code></pre></div><p>常用vim-plug命令</p><ul><li><code>:PlugInstall</code>：安装插件</li><li><code>:PlugUpdate</code>：更新所有插件</li><li><code>:PlugUpgrade</code>：升级 vim-plug 插件管理器</li><li><code>:PlugClean</code>：删除未在 .vimrc 配置中的插件</li><li><code>:PlugStatus</code>：查看插件的当前状态，列出已安装的插件及其状态</li></ul><p>插件的更多配置选项<br>可以在插件声明时指定一些额外的选项来控制插件行为</p><ul><li>延迟加载插件：通过<code>on</code>或<code>for</code>选项指定插件在特定条件下加载。例如，只在打开某些文件类型时才加载</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>Plug</span> <span style=color:#e6db74>&#39;junegunn/fzf.vim&#39;</span>, { <span style=color:#e6db74>&#39;for&#39;</span>: [<span style=color:#e6db74>&#39;vim&#39;</span>, <span style=color:#e6db74>&#39;bash&#39;</span>] }
</span></span></code></pre></div><ul><li>仅在特定命令下加载插件</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>Plug</span> <span style=color:#e6db74>&#39;tpope/vim-fugitive&#39;</span>, { <span style=color:#e6db74>&#39;on&#39;</span> : <span style=color:#e6db74>&#39;Gstatus&#39;</span> }
</span></span></code></pre></div><ul><li>自动安装插件</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>PlugInstall</span> --<span style=color:#a6e22e>sync</span>
</span></span></code></pre></div><p><strong>常用的Vim插件</strong>\</p><ol><li>自动补全插件</li></ol><ul><li>coc.nvim：自动补全，支持LSP协议，支持多种语言智能补全</li><li>YouCompleteMe</li></ul><ol start=2><li>文件浏览器</li></ol><ul><li>NERDTree：文件系统浏览器，可以帮助在Vim中管理和浏览文件和目录</li><li>fugitive.vim：一个Git插件，提供Git操作的简洁命令</li></ul><ol start=3><li>语法高亮与代码格式</li></ol><ul><li>vim-polyglot：一个集成多种语言的语法高亮插件，支持很多编程语言的高亮显示</li><li>auto-pairs：自动补全括号、引号等配对字符</li></ul><ol start=4><li>代码片段插件</li></ol><ul><li>UltiSnips</li><li>snipmate.vim</li></ul><ol start=5><li>增强的查找和替换</li></ol><ul><li>fzf.vim：集成了FZF（模糊查找工具）的插件，提供快速查找为念、文本和命令的能力</li><li>ctrlp.vim：</li></ul><ol start=6><li>状态栏和界面增强</li></ol><ul><li>lightline.vim：一个轻量级的状态栏插件，提供美观的界面和状态栏定制</li><li>vim-airline：支持多种颜色主题和动态信息</li></ul><ol start=7><li>增强的搜索功能</li></ol><ul><li>ack.vim：集成了Ack搜索工具，能快速搜索项目中的文件</li><li>ag.vim：集成了Silver Searcher（Ag），比grep更快</li></ul><ol start=8><li>Git集成</li></ol><ul><li>vim-gitgutter：显示Git状态的插件，显示已修改、已删除、已新增的行</li><li>vim-fugitive：一个Git集成插件，允许在Vim中执行Git操作（如提交、查看历史等）</li></ul><p><strong>插件配置和优化</strong></p><ul><li>配置插件：大部分插件都提供了可定制的选项，可以通过修改<code>.vimrc</code>文件中的配置来调整插件的行为</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 配置 coc.nvim 自动补全</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g</span>:<span style=color:#a6e22e>coc_global_extensions</span> = [<span style=color:#e6db74>&#39;coc-tsserver&#39;</span>, <span style=color:#e6db74>&#39;coc-python&#39;</span>]
</span></span></code></pre></div><ul><li>禁用不需要的插件：有时候可能只需要启用某些插件，禁用其他插件。可以通过注释掉相关的<code>Plug</code>或<code>Plugin</code>配置来禁用查文件，或者使用插件的<code>disable</code>选项</li><li>定期更新插件：可以使用插件管理器提供的命令定期更新插件<ul><li>在<code>vim-plug</code>中：<code> :PlugUpdate</code></li></ul></li></ul><hr><ul><li><p>d 删除操作符，删除并存入寄存器</p><ul><li>d + number + motion 删除指定number的motion</li><li>dd 删除整行<ul><li>number + dd 执行number次dd，删除number行</li></ul></li></ul></li><li><p>motion 操作符的操作对象</p><ul><li>w 从当前光标当前位置直到下一个单词起始处，不包括它的第一个字符</li><li>e 从当前光标当前位置直到单词末尾，包括最后一个字符</li><li>$ 从当前光标当前位置直到当前行末</li><li>0 从当前光标当前位置直到当前行首</li></ul></li><li><p>number 重复行为计数</p><ul><li>2w 向前移动两个单词，光标到第二个单词的首字母</li><li>3e 向前移动三个单词，光标到第三个单词的末尾</li></ul></li><li><p>u 撤销最后一次命令</p></li><li><p>U 撤销对一行的修改</p></li><li><p>^R 重做</p></li><li><p>y 复制选中文本</p><ul><li>yw 复制一个单词</li></ul></li><li><p>p 粘贴到光标之后</p></li><li><p>r char 替换光标所在位置的字符</p></li><li><p>R char1char2char3&mldr; 连续替换多个字符</p></li><li><p>c 更改操作符，删除，存入寄存器并原地进入插入模式</p><ul><li>c + number + motion</li></ul></li><li><p>G 跳转到文件最后一行</p><ul><li>number + G 跳转到number行</li></ul></li><li><p>gg 跳转到文件第一行</p></li><li><p>/str 顺序查找字符串</p><ul><li>回车</li><li>n 跳转到下一个匹配项</li><li>N 跳转到上一个匹配项</li><li>?/str逆序查找</li></ul></li><li><p>CTRL+G 显示状态信息</p></li><li><p>CTRL+O 跳转到上个位置</p></li><li><p>CTRL+I 跳转到下个位置</p></li><li><p>CTRL+W 窗口间切换</p></li><li><p>CTRL+D 显示所有补全选项</p></li><li><p>光标在任意{[()]}处按%，跳转到匹配括号处</p></li><li><p>替换</p><ul><li>命令<code>:s/old/new</code> 替换光标所在行的第一个匹配串"old -> new"</li><li><code>s/old/new/g</code>：匹配全行所有"old -> new"</li><li><code>:#,#s/old/new/g</code>：匹配#行 -> #行所有"old -> new"</li><li><code>:%s/old/new/g</code>：匹配整个文件</li><li><code>:%s/old/new/gc</code>：交互式匹配整个文件</li></ul></li><li><p><code>:!command</code> 执行外部命令</p></li><li><p>:w FILENAME 保存文件名为FILENAME</p></li><li><p>部分保存：v motion :w FILENAME</p><ul><li>visual mode下，选择内容后，按:进入命令模式，屏幕底部出现<code>:'&lt;,'></code>，然后输入w FILENAME。该操作会将选中内容保存到FILENAME中</li></ul></li><li><p>插入外部内容 :r FILENAME 将磁盘文件FILENAME插入到光标所在位置；<code>:r !command</code>将外部命令输出插入文件中</p></li><li><p>o下方换行插入，O上方换行插入</p></li><li><p>a光标后插入，A行尾插入</p></li><li><p>i光标前插入，I行首插入</p></li><li><p>:set ic （ignorecase，查找忽略大小写）</p></li><li><p>:set noic 禁用忽略大小写</p></li><li><p>:set hls (hlsearch)设置匹配项高亮</p></li><li><p>:nohlsearch 移除匹配项高亮</p></li><li><p>:set is （incsearch）查找短语时显示部分匹配项</p></li><li><p>:set nois 关闭部分匹配项显示</p></li><li><p>完整拼写和缩写均可</p></li><li><p><help>，<f1>, :help 打开在线帮助系统</p></li><li><p>:help keyword 关于keyword的帮助</p></li><li><p><tab>补全</p></li></ul><hr><h2 id=终端模式>终端模式</h2><p>Vim 8.1+</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>term</span> <span style=color:#a6e22e>bash</span> <span style=color:#75715e>&#34; 水平分割终端窗口</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>vert</span> <span style=color:#a6e22e>term</span> <span style=color:#a6e22e>bash</span> <span style=color:#75715e>&#34; 垂直分割终端窗口</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>term</span> <span style=color:#75715e>&#34; 启动默认shell</span>
</span></span></code></pre></div><p>终端窗口操作</p><ul><li>进入终端模式后可直接输入bash命令</li><li>按<code>CTRL+W</code>后再按<code>N</code>进入普通模式</li><li>按<code>i</code>或<code>a</code>返回终端输入模式</li><li><code>:close</code>关闭终端窗口</li></ul><h2 id=tabs>tabs</h2><p>标签页是Vim中组织窗口的容器，每个标签页可以包含多个分割窗口</p><h3 id=创建标签页>创建标签页</h3><ul><li>从命令行启动</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>vim -p file1 file2 file3 <span style=color:#75715e># 用标签页打开多个文件</span>
</span></span><span style=display:flex><span>vim -p *.py  <span style=color:#75715e># 用标签页打开所有py文件</span>
</span></span></code></pre></div><ul><li>在Vim中创建</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>tabnew</span> &lt;<span style=color:#a6e22e>filename</span>&gt; <span style=color:#75715e>&#34; 新建标签页，&lt;filename&gt;可选</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabedit</span> &lt;<span style=color:#a6e22e>filename</span>&gt; <span style=color:#75715e>&#34; 同上，简写 :tabe</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabs</span> <span style=color:#75715e>&#34; 显示所有标签页列表</span>
</span></span></code></pre></div><ul><li>其他创建方式</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>tab</span> <span style=color:#a6e22e>split</span> <span style=color:#75715e>&#34; 当前窗口移到新标签页</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tab</span> <span style=color:#a6e22e>sball</span> <span style=color:#75715e>&#34; 为每个缓冲区开标签页</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tab</span> <span style=color:#a6e22e>ball</span> <span style=color:#75715e>&#34; 同上</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tab</span> <span style=color:#a6e22e>help</span> <span style=color:#a6e22e>topic</span> <span style=color:#75715e>&#34; 在新标签页打开帮助</span>
</span></span></code></pre></div><h3 id=标签页导航>标签页导航</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>tabn</span>[<span style=color:#a6e22e>ext</span>] <span style=color:#75715e>&#34; 下一个标签页</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabp</span>[<span style=color:#a6e22e>revious</span>] <span style=color:#75715e>&#34; 上一个标签页</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabN</span>[<span style=color:#a6e22e>ext</span>] <span style=color:#75715e>&#34; 上一个标签页</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabfirst</span> / :<span style=color:#a6e22e>tabr</span> <span style=color:#75715e>&#34; 第一个标签页</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tablast</span> <span style=color:#75715e>&#34; 最后一个标签页</span>
</span></span></code></pre></div><h3 id=标签页操作>标签页操作</h3><ul><li>关闭标签页</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>tabc</span>[<span style=color:#a6e22e>lose</span>] <span style=color:#75715e>&#34; 关闭当前标签页</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabo</span>[<span style=color:#a6e22e>nly</span>] <span style=color:#75715e>&#34; 关闭其他所有标签页，只留当前</span>
</span></span></code></pre></div><ul><li>移动标签页</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>tabm</span>[<span style=color:#a6e22e>ove</span>] [<span style=color:#a6e22e>N</span>] <span style=color:#75715e>&#34; 移动当前标签页到第N位置</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabm</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>&#34; 移到最前面</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabm</span> <span style=color:#75715e>&#34; 移到最后面</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabm</span> +<span style=color:#ae81ff>1</span> <span style=color:#75715e>&#34; 向后移动一位</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tabm</span> <span style=color:#ae81ff>-1</span> <span style=color:#75715e>&#34; 向前移动一位</span>
</span></span></code></pre></div><h3 id=标签页与窗口的配合>标签页与窗口的配合</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>Ctrl</span>+<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>T</span> <span style=color:#75715e>&#34; 将当前窗口移到新标签页</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Ctrl</span>+<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>c</span> <span style=color:#75715e>&#34; 关闭当前窗口但不关闭标签页</span>
</span></span></code></pre></div><h2 id=buffer>Buffer</h2><ul><li>Buffer：内存中加载的文件内容</li><li>Window：查看缓冲区的视口</li><li>Tab：包含一组窗口的容器</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>关系：文件 -&gt; 缓冲区 -&gt; 窗口 -&gt; 标签页
</span></span><span style=display:flex><span>      磁盘    内存      视图    容器
</span></span></code></pre></div><h3 id=重要特性>重要特性</h3><ul><li>一个文件对应一个缓冲区</li><li>缓冲区可以没有对应文件（新建未保存）</li><li>缓冲区可以被多个窗口同时查看</li><li>缓冲区可以隐藏而不显示任何窗口</li></ul><p><code>set hidden</code>：允许隐藏已修改的缓冲区</p><h3 id=缓冲区状态>缓冲区状态</h3><p>缓冲区有4种状态</p><ol><li>活动（active）：显示在窗口中</li><li>隐藏（hidden）：已加载但未显示</li><li>未加载（inactive）：在列表但未加载内容</li><li>已列出（listed）：在<code>:ls</code>中显示</li></ol><h3 id=查看缓冲区>查看缓冲区</h3><h4 id=列出缓冲区>列出缓冲区</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>ls</span> <span style=color:#75715e>&#34; 列出所有缓冲区</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>buffers</span> <span style=color:#75715e>&#34; 同上</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>files</span> <span style=color:#75715e>&#34; 同上，显示更详细</span>
</span></span></code></pre></div><p>示例输出</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>1 %a &#34;file1.txt&#34; line 1
</span></span><span style=display:flex><span>2 #h &#34;file2.py&#34;  line 99 
</span></span><span style=display:flex><span>3    &#34;file3.js&#34;  line 0 
</span></span></code></pre></div><p>状态标记</p><ul><li><code>%</code>：当前窗口的缓冲区</li><li><code>#</code>：交替缓冲区（按Ctrl+^可切换）</li><li><code>a</code>：活动（显示在窗口中）</li><li><code>h</code>：隐藏（已加载但不显示）</li><li><code>=</code>：只读缓冲区</li><li><code>+</code>：已修改未保存</li><li><code>-</code>：不可修改</li><li><code>x</code>：有读取错误</li></ul><h4 id=详细列表>详细列表</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>ls</span>! <span style=color:#75715e>&#34; 显示所有缓冲区（包括未列出的）</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>buffer</span> <span style=color:#75715e>&#34; 显示当前缓冲区信息</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>file</span> <span style=color:#75715e>&#34; 显示当前文件名和状态</span>
</span></span></code></pre></div><h3 id=打开创建缓冲区>打开/创建缓冲区</h3><h4 id=从文件打开>从文件打开</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>e</span> <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>txt</span> <span style=color:#75715e>&#34; 编辑文件（新建缓冲区）</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>enew</span> <span style=color:#75715e>&#34; 新建空缓冲区</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>view</span> <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>txt</span> <span style=color:#75715e>&#34; 以只读方式打开</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>badd</span> <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>txt</span> <span style=color:#75715e>&#34; 添加到缓冲区列表但不显示</span>
</span></span></code></pre></div><h4 id=命令行打开>命令行打开</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>vim file1 file2 file3 <span style=color:#75715e># 打开多个文件到缓冲区</span>
</span></span><span style=display:flex><span>vim *.py <span style=color:#75715e># 通配符打开</span>
</span></span><span style=display:flex><span>vim -p file1 file2 <span style=color:#75715e># 用标签页打开</span>
</span></span></code></pre></div><h3 id=切换缓冲区>切换缓冲区</h3><ul><li><code>:buffer N</code>/<code>:bN</code>：切换到第N个缓冲区</li><li><code>:b file</code>:切换到文件名包含<code>file</code>的缓冲区</li><li><code>:buf[fer] filename</code>：切换到指定文件名的缓冲区</li><li><code>:bn[ext]</code>：下一个缓冲区</li><li><code>:bp[revious]</code>：上一个缓冲区</li><li><code>:blast</code>：最后一个缓冲区</li><li><code>:bfirst</code>：第一个缓冲区</li><li><code>Ctrl+^</code>：切换当前缓冲区和交替缓冲区</li><li><code>:buffer #</code>：切换到交替缓冲区</li><li><code>:brewind</code>：回到第一个缓冲区</li><li><code>:bN[ext]</code>：上一个缓冲区</li></ul><h3 id=删除缓冲区>删除缓冲区</h3><ul><li><code>:bdelete N</code>/<code>:bdN</code>：删除第N个缓冲区</li><li><code>:bd[elete] filename</code>：删除指定缓冲区</li><li><code>:bdelete!</code>：强制删除，即使有未保存修改</li><li><code>:bufdo bd</code>：删除所有缓冲区（危险！）</li><li><code>:%bd</code>：删除所有缓冲区，保留当前</li><li><code>:1,5bd</code>：删除1-5号缓冲区</li><li><code>:bd file*.txt</code>：删除匹配文件名的缓冲区</li></ul><h3 id=缓冲区操作>缓冲区操作</h3><ul><li><code>:saveas newname</code>：另存为新文件并切换到新缓冲区</li><li><code>:file newname</code>：重命名当前缓冲区</li><li><code>:f[ile]! newname</code>：强制重命名（可能丢失原文件）</li><li><code>:e</code>：重新加载当前文件（放弃修改）</li><li><code>:e!</code>：强制重新加载（放弃所有修改）</li><li><code>:checktime</code>：检查文件是否被外部修改</li><li><code>:set readonly</code>：设为只读</li><li><code>:set noreadonly</code>：取消只读</li><li><code>:view file</code>：以只读方式打开</li></ul><h3 id=缓冲区与窗口>缓冲区与窗口</h3><ul><li><code>sbuffer N</code>：水平分割窗口显示缓冲区N</li><li><code>vert sbuffer N</code>：垂直分割窗口显示缓冲区N</li><li><code>Ctrl+w, Shift+H/J/K/l</code>：将缓冲区移到左/下/上/右边窗口</li></ul><h3 id=批量操作>批量操作</h3><ul><li><code>:bufdo command</code>：在所有缓冲区执行命令</li><li><code>:bufdo %s/foo/bar/g</code>：所有缓冲区替换</li><li><code>:bufdo set ft=python</code>：所有缓冲区设为python语法</li><li><code>:bufdo update</code>：保存所有已修改的缓冲区</li></ul><h2 id=终端窗口>终端窗口</h2><p>vim 8.0 开始，vim内置了一个终端模拟器，可以在vim窗口里直接运行任何CLI工具<br>本质是一个特殊buffer(terminal buffer)</p><h3 id=使用-1>使用</h3><h4 id=打开>打开</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>terminal</span> <span style=color:#75715e>&#34; 打开终端（缩写 :term）</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>vert</span> <span style=color:#a6e22e>terminal</span> <span style=color:#75715e>&#34; 垂直分割打开终端</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>tab</span> <span style=color:#a6e22e>terminal</span> <span style=color:#75715e>&#34; 在新标签页打开终端</span>
</span></span></code></pre></div><p>使用默认<code>$SHELL</code></p><h4 id=指定shell或命令>指定shell或命令</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>terminal</span> <span style=color:#a6e22e>bash</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>terminal</span> <span style=color:#a6e22e>zsh</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>terminal</span> <span style=color:#a6e22e>python</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>terminal</span> <span style=color:#a6e22e>gdb</span> <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>out</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>terminal</span> <span style=color:#a6e22e>make</span> <span style=color:#a6e22e>run</span>
</span></span></code></pre></div><h4 id=模式切换>模式切换</h4><ul><li>终端模式 -> 普通模式：<code>^\, ^n</code></li><li>普通模式 -> 终端模式：<code>i</code></li></ul><h4 id=调整位置>调整位置</h4><p>终端是一个buffer + job</p><p>横向分屏终端</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>split</span> | <span style=color:#a6e22e>terminal</span>
</span></span></code></pre></div><p>纵向分屏终端</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>vsplit</span> | <span style=color:#a6e22e>terminal</span>
</span></span></code></pre></div><p>底部固定终端</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>botright</span> <span style=color:#a6e22e>split</span> | <span style=color:#a6e22e>terminal</span>
</span></span></code></pre></div><p>固定高度</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>botright</span> <span style=color:#ae81ff>10</span>split | <span style=color:#a6e22e>terminal</span>
</span></span></code></pre></div><h4 id=复制粘贴>复制/粘贴</h4><p>复制终端输出</p><ol><li>进入普通模式</li><li>像普通文本一样<ul><li><code>v</code></li><li><code>y</code></li><li><code>/pattern</code></li></ul></li></ol><p>终端buffer在普通模式下是只读的，但可以选中</p><h4 id=退出>退出</h4><ul><li>关闭缓冲区，同时杀死进程：<code>bdelete!</code></li><li>终端中直接退出：<code>exit</code></li></ul><h3 id=设置>设置</h3><h4 id=终端自动进入插入模式>终端自动进入插入模式</h4><p>在<code>vimrc</code>里</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#66d9ef>autocmd</span> <span style=color:#a6e22e>TermOpen</span>* <span style=color:#a6e22e>startinsert</span>
</span></span></code></pre></div><h4 id=禁用行号>禁用行号</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#66d9ef>autocmd</span> <span style=color:#a6e22e>TermOpen</span> * <span style=color:#a6e22e>setlocal</span> <span style=color:#a6e22e>nonumber</span> <span style=color:#a6e22e>norelativenumber</span>
</span></span></code></pre></div><h2 id=vimdiff>vimdiff</h2><p>Vim diff 是在多个窗口中对齐显示差异<br>它不是只给你一份补丁文本，而是</p><ul><li>并排显示文件</li><li>自动对齐对应行</li><li>高亮增/删/改</li><li>支持交互式合并</li></ul><p>本质是一个可编辑的、实时diff视图</p><h3 id=进入vim-diff模式>进入Vim diff模式</h3><p>在命令行中</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>vimdiff a.cpp b.cpp
</span></span></code></pre></div><p>或</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>vim -d a.cpp b.cpp
</span></span></code></pre></div><p>已在Vim里</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>diffthis</span>
</span></span></code></pre></div><p>在两个窗口分别执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>diffthis</span>
</span></span></code></pre></div><p>这两个窗口就进入diff模式</p><p>退出</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>diffoff</span>
</span></span></code></pre></div><p>Git工作流<code>git difftool</code>默认就会拉起Vim diff</p><h3 id=使用-2>使用</h3><p>颜色/高亮（逻辑）</p><table><thead><tr><th>高亮</th><th>含义</th></tr></thead><tbody><tr><td>红色背景</td><td>删除</td></tr><tr><td>绿色背景</td><td>新增</td></tr><tr><td>蓝色/紫色</td><td>修改</td></tr><tr><td>空白充填</td><td>对齐占位</td></tr></tbody></table><p>Vim diff会找最相似的行块，用虚拟空行把两边对齐，保证能横向比较，这些空行不能编辑，他们只是视觉占位</p><h4 id=操作>操作</h4><h5 id=在差异间跳转>在差异间跳转</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>]c 下一个差异
</span></span><span style=display:flex><span>[c 上一个差异
</span></span></code></pre></div><h5 id=选择改动>选择改动</h5><p>假设</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-fallback data-lang=fallback><span style=display:flex><span>左边 = 旧
</span></span><span style=display:flex><span>右边 = 新
</span></span></code></pre></div><p>从另一边拉内容</p><ul><li><code>do</code>：用另一侧的内容覆盖当前</li><li><code>dp</code>：把当前内容覆盖到另一侧</li></ul><h5 id=同步滚动>同步滚动</h5><p>默认开启</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#66d9ef>set</span> <span style=color:#a6e22e>scrollbind</span>
</span></span></code></pre></div><p>关闭</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#66d9ef>set</span> <span style=color:#a6e22e>noscrollbind</span>
</span></span></code></pre></div><h3 id=diff配置>diff配置</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 更易读的 diff</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>diffopt</span>=<span style=color:#a6e22e>filler</span>,<span style=color:#a6e22e>context</span>:<span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 忽略空白差异</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>diffopt</span>+=<span style=color:#a6e22e>iwhite</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 更自然的算方法</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>diffopt</span>+=<span style=color:#a6e22e>algorithm</span>:<span style=color:#a6e22e>patience</span>
</span></span></code></pre></div><p>diff算法</p><ul><li><code>myers</code> 默认，速度快</li><li><code>patience</code> 更符合人类阅读</li><li><code>histogram</code> 折中</li></ul><h2 id=行号跳转>行号跳转</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>number</span> <span style=color:#75715e>&#34; 跳转到number行</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>numbergg</span> <span style=color:#75715e>&#34; 跳转到number行</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>numberG</span> <span style=color:#75715e>&#34; 跳转到number行</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>numberk</span> <span style=color:#75715e>&#34; 向上移动number行</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>numberj</span> <span style=color:#75715e>&#34; 向下移动number行</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>number</span>% <span style=color:#75715e>&#34; 跳转到number%处</span>
</span></span></code></pre></div><h2 id=插件-vim-markdown-快捷键>插件 vim-markdown 快捷键</h2><table><thead><tr><th>快捷键</th><th>功能</th></tr></thead><tbody><tr><td><code>zR</code></td><td>展开所有折叠</td></tr><tr><td><code>zM</code></td><td>折叠所有</td></tr><tr><td><code>zr</code></td><td>展开一级折叠</td></tr><tr><td><code>zm</code></td><td>折叠一级</td></tr><tr><td><code>zo</code></td><td>打开当前折叠</td></tr><tr><td><code>zc</code></td><td>关闭当前折叠</td></tr><tr><td><code>za</code></td><td>切换折叠状态</td></tr><tr><td><code>zO</code></td><td>递归打开</td></tr><tr><td><code>zC</code></td><td>递归关闭</td></tr></tbody></table><h2 id=swp-文件>.swp 文件</h2><p><code>Swap Files</code>，Vim交换文件，这是Vim的崩溃恢复机制，类似于</p><ul><li>Word的自动恢复文件（.asd）</li><li>Photoshop的恢复文件</li><li>游戏中的自动保存点</li></ul><p>文件命名格式：<code>.sourcename.swp</code>，是一个隐藏文件</p><p>主要作用</p><p>1.崩溃恢复</p><p>当异常退出Vim时，重新打开文件，Vim提示</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>[<span style=color:#a6e22e>O</span>]<span style=color:#a6e22e>pen</span> <span style=color:#a6e22e>Read</span>-<span style=color:#a6e22e>Only</span>   # <span style=color:#a6e22e>只读打开</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>E</span>)<span style=color:#a6e22e>dit</span> <span style=color:#a6e22e>anyway</span>      # <span style=color:#a6e22e>强制编辑</span>（<span style=color:#a6e22e>危险</span>）
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>R</span>)<span style=color:#a6e22e>ecover</span>          # <span style=color:#a6e22e>恢复交换文件内容</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>D</span>)<span style=color:#a6e22e>elete</span> <span style=color:#a6e22e>it</span>        # <span style=color:#a6e22e>删除交换文件</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>Q</span>)<span style=color:#a6e22e>uit</span>             # <span style=color:#a6e22e>退出</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>A</span>)<span style=color:#a6e22e>bort</span>            # <span style=color:#a6e22e>中止</span>
</span></span></code></pre></div><p>2.防止编辑冲突</p><p>如果另一个Vim实例正在编辑同一文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 如果另一个 Vim 实例正在编辑同一文件：</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>E325</span>: <span style=color:#a6e22e>ATTENTION</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Found</span> <span style=color:#a6e22e>a</span> <span style=color:#a6e22e>swap</span> <span style=color:#a6e22e>file</span> <span style=color:#a6e22e>by</span> <span style=color:#a6e22e>the</span> <span style=color:#a6e22e>name</span> <span style=color:#e6db74>&#34;.filename.swp&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>owned</span> <span style=color:#a6e22e>by</span>: <span style=color:#a6e22e>username</span>   <span style=color:#a6e22e>pid</span>: <span style=color:#ae81ff>1234</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>dated</span>: <span style=color:#a6e22e>Thu</span> <span style=color:#a6e22e>Jan</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>12</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span> <span style=color:#ae81ff>2026</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>) <span style=color:#a6e22e>Another</span> <span style=color:#a6e22e>program</span> <span style=color:#a6e22e>may</span> <span style=color:#a6e22e>be</span> <span style=color:#a6e22e>editing</span> <span style=color:#a6e22e>the</span> <span style=color:#a6e22e>same</span> <span style=color:#a6e22e>file</span>.
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>2</span>) <span style=color:#a6e22e>An</span> <span style=color:#a6e22e>edit</span> <span style=color:#a6e22e>session</span> <span style=color:#a6e22e>for</span> <span style=color:#a6e22e>this</span> <span style=color:#a6e22e>file</span> <span style=color:#a6e22e>crashed</span>.
</span></span></code></pre></div><p>3.保存编辑状态</p><p>交换文件包括</p><ul><li>未保存的修改内容</li><li>光标位置和视图状态</li><li>撤销历史树</li><li>寄存器内容</li><li>标记位置</li></ul><h3 id=工作原理>工作原理</h3><p>创建时机：<br>Vim在以下情况更新交换文件</p><ol><li>打开文件时立即创建</li><li>每输入&rsquo;updatecount&rsquo;个字符后</li><li>每 &lsquo;updatetime&rsquo;毫秒后</li><li>切换到其他缓冲区时</li><li>执行某些命令时</li></ol><p>相关设置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>updatetime</span>=<span style=color:#ae81ff>4000</span> <span style=color:#75715e>&#34; 每4秒保存一次（默认）</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>updatecount</span>=<span style=color:#ae81ff>100</span> <span style=color:#75715e>&#34;每输入100字符保存一次</span>
</span></span></code></pre></div><p>文件结构</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>[交换文件头]
</span></span><span style=display:flex><span>├── 魔数（标识为 Vim 交换文件）
</span></span><span style=display:flex><span>├── 原始文件名
</span></span><span style=display:flex><span>├── 进程ID和时间戳
</span></span><span style=display:flex><span>├── 文件修改时间
</span></span><span style=display:flex><span>└── ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[数据块]
</span></span><span style=display:flex><span>├── 文本内容（增量变化）
</span></span><span style=display:flex><span>├── 撤销历史
</span></span><span style=display:flex><span>├── 寄存器内容
</span></span><span style=display:flex><span>└── 标记信息
</span></span></code></pre></div><h3 id=管理交换文件>管理交换文件</h3><h4 id=基本命令>基本命令</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>sw</span> <span style=color:#75715e>&#34; 在 Vim中管理交换文件</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>sw</span>! <span style=color:#75715e>&#34; 强制写入交换文件</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>swp</span> <span style=color:#75715e>&#34; 同 :sw</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>swapname</span> <span style=color:#75715e>&#34; 显示当前交换文件路径</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 列出所有交换文件</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>swap</span>!            <span style=color:#75715e>&#34; 显示所有可恢复的交换文件</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>swap</span> <span style=color:#a6e22e>list</span>        <span style=color:#75715e>&#34; 显示交换文件列表</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>swap</span> <span style=color:#a6e22e>next</span>        <span style=color:#75715e>&#34; 跳转到下一个交换文件</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>swap</span> <span style=color:#a6e22e>prev</span>        <span style=color:#75715e>&#34; 跳转到上一个交换文件</span>
</span></span></code></pre></div><h4 id=恢复编辑会话>恢复编辑会话</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 方法1：启动时恢复</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>vim</span> -<span style=color:#a6e22e>r</span> <span style=color:#a6e22e>filename</span>.<span style=color:#a6e22e>txt</span> <span style=color:#75715e>&#34; 恢复指定文件</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>vim</span> -<span style=color:#a6e22e>r</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 方法2：在Vim中恢复</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>recover</span> <span style=color:#a6e22e>filename</span>.<span style=color:#a6e22e>txt</span> <span style=color:#75715e>&#34; 从交换文件恢复</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>recover</span>! <span style=color:#a6e22e>filename</span>.<span style=color:#a6e22e>txt</span> <span style=color:#75715e>&#34; 强制恢复</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 方法3：手动比较</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>diffthis</span>   <span style=color:#75715e>&#34; 当前文件</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>split</span> <span style=color:#a6e22e>filename</span>.<span style=color:#a6e22e>txt</span> <span style=color:#75715e>&#34; 打开源文件</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>diffthis</span> <span style=color:#75715e>&#34; 对比模式</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34; 然后手动合并差异</span>
</span></span></code></pre></div><h4 id=交换文件位置控制>交换文件位置控制</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 在 ~/.vimrc 中配置</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 1. 集中存放（推荐）</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>directory</span>=~<span style=color:#e6db74>/.vim/</span><span style=color:#a6e22e>swap</span><span style=color:#e6db74>//</span>   <span style=color:#75715e>&#34; 所有交换文件放这里</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34; 注意：末尾 // 表示保留完整路径结构</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 2. 项目特定目录</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>directory</span>=.<span style=color:#e6db74>/.vim-swap/</span>/   <span style=color:#75715e>&#34; 放在项目内的 .vim-swap 目录</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 3. 多级目录（按文件路径组织）</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>directory</span>=~<span style=color:#e6db74>/.vim/</span><span style=color:#a6e22e>swap</span>/%:<span style=color:#a6e22e>p</span>:<span style=color:#a6e22e>h</span>   <span style=color:#75715e>&#34; 按原文件路径创建子目录</span>
</span></span></code></pre></div><h4 id=配置选项>配置选项</h4><h5 id=启用禁用>启用/禁用</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 完全禁用（不推荐）</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>noswapfile</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 针对特定文件类型禁用</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>autocmd</span> <span style=color:#a6e22e>FileType</span> <span style=color:#a6e22e>python</span> <span style=color:#a6e22e>setlocal</span> <span style=color:#a6e22e>noswapfile</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>autocmd</span> <span style=color:#a6e22e>FileType</span> <span style=color:#a6e22e>markdown</span> <span style=color:#a6e22e>setlocal</span> <span style=color:#a6e22e>noswapfile</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 条件启用</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>swapfile</span>                    <span style=color:#75715e>&#34; 默认启用</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>swapsync</span>=<span style=color:#a6e22e>fsync</span>              <span style=color:#75715e>&#34; 同步写入（更安全但更慢）</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>swapsync</span>=                   <span style=color:#75715e>&#34; 异步写入（默认）</span>
</span></span></code></pre></div><h5 id=行为控制>行为控制</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 1. 只读文件的交换文件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>swapfile</span>                    <span style=color:#75715e>&#34; 默认启用</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>swapsync</span>=<span style=color:#a6e22e>fsync</span>              <span style=color:#75715e>&#34; 同步到磁盘</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>updatecount</span>=<span style=color:#ae81ff>50</span>              <span style=color:#75715e>&#34; 每50字符保存</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>updatetime</span>=<span style=color:#ae81ff>2000</span>             <span style=color:#75715e>&#34; 每2秒保存</span>
</span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 2. 大文件处理</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34; Vim 7.3+ 对大文件有特殊处理</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>maxmem</span>=<span style=color:#ae81ff>500000</span>               <span style=color:#75715e>&#34; 每个缓冲区最大内存（KB）</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> <span style=color:#a6e22e>maxmemtot</span>=<span style=color:#ae81ff>1000000</span>           <span style=color:#75715e>&#34; 所有缓冲区最大内存（KB）</span>
</span></span></code></pre></div><h4 id=文件扩展名>文件扩展名</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; Vim 使用不同扩展名区分状态：</span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>swp</span>   <span style=color:#75715e>&#34; 活跃的交换文件</span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>swo</span>   <span style=color:#75715e>&#34; 旧的交换文件（如果 .swp 已存在）</span>
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>swn</span>   <span style=color:#75715e>&#34; 更旧的版本</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34; Vim 会自动使用这些扩展名避免冲突</span>
</span></span></code></pre></div><h2 id=sign-column>sign column</h2><h2 id=寄存器>寄存器</h2><p>Vim的寄存器是Vim内置的多个文本存储槽<br>每个寄存器用一个名字表示，存放内容来自<code>y</code>（复制），<code>d</code>（删除），<code>c</code>（修改），<code>x</code>（删除字符）<br>使用时通过</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;registername + operation</span>
</span></span></code></pre></div><p>例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;ayw  &#34; 复制一个单词到寄存器 a</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34;ap   &#34; 从寄存器a粘贴</span>
</span></span></code></pre></div><h3 id=寄存器总览>寄存器总览</h3><table><thead><tr><th>类型</th><th>名称</th><th>说明</th></tr></thead><tbody><tr><td>未命名</td><td><code>"</code></td><td>默认寄存器</td></tr><tr><td>数字</td><td><code>0-9</code></td><td>删除历史</td></tr><tr><td>命名</td><td><code>a-z</code></td><td>用户自定义</td></tr><tr><td>系统剪贴板</td><td><code>+</code>, <code>*</code></td><td>和系统交互</td></tr><tr><td>小删除</td><td><code>-</code></td><td>小范围删除</td></tr><tr><td>黑洞</td><td><code>_</code></td><td>什么都不保存</td></tr><tr><td>只读</td><td><code>:</code> <code>.</code> <code>%</code></td><td>命令/文件名</td></tr><tr><td>表达式</td><td><code>=</code></td><td>计算结果</td></tr></tbody></table><h3 id=未命名寄存器->未命名寄存器 <code>"</code></h3><p>Vim的默认剪贴板</p><p>所有<code>y/d/c</code>都会写入这里<br><code>p</code>实际等价于</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;&#34;p</span>
</span></span></code></pre></div><p>这就是p默认的读取的寄存器</p><h3 id=数字寄存器-0-9>数字寄存器 <code>0-9</code></h3><h4 id=0最近一次yank><code>0</code>最近一次yank</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>yy</span> <span style=color:#75715e>&#34; 存入0</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>dd</span> <span style=color:#75715e>&#34; 不会影响0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34;0p &#34; 还能粘贴刚才复制的内容</span>
</span></span></code></pre></div><h4 id=1-9-删除历史><code>1-9</code> 删除历史</h4><ul><li><code>1</code>：最近一次删除</li><li><code>2</code>：上一次的上一次删除</li><li>依次类推</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;1p</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34;2p</span>
</span></span></code></pre></div><h3 id=命名寄存器a-z>命名寄存器<code>a-z</code></h3><p>自定义寄存器<br>可以手动控制不会覆盖的内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;ayw &#34; 复制单词到 a </span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34;ap  &#34; 粘贴 a </span>
</span></span></code></pre></div><p>大写 = 追加</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;Ayy &#34; 追加到 a</span>
</span></span></code></pre></div><p>使用场景</p><ul><li>保存一段“模板代码”</li><li>多处反复粘贴</li><li>防止被<code>dd</code>覆盖</li></ul><h3 id=系统剪贴板>系统剪贴板<code>+</code>/<code>*</code></h3><ul><li><code>+</code> 系统剪贴板（在Windows和Mac中）</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;+yy &#34; 复制到系统剪贴板</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34;+p  &#34; 从系统剪贴板粘贴</span>
</span></span></code></pre></div><ul><li><code>*</code> 选择剪贴板（X11系统的主选择）</li></ul><p>需要vim <code>+clipboard</code></p><h3 id=黑洞寄存器-_>黑洞寄存器 <code>_</code></h3><p>不存入寄存器的删除</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;_dd</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34;_daw</span>
</span></span></code></pre></div><p>解决经典痛点：复制了一段代码 -> 想删几行 -> 结果复制的内容没了</p><h3 id=小删除寄存器-->小删除寄存器 <code>-</code></h3><ul><li>删除少于一行（如<code>x</code>/<code>dw</code>）</li><li>不污染主寄存器</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>x</span> <span style=color:#75715e>&#34; 存入 - </span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34;-p</span>
</span></span></code></pre></div><h3 id=只读寄存器--->只读寄存器 <code>:</code>, <code>.</code>, <code>%</code></h3><ul><li><code>:</code> 上一次命令</li><li><code>.</code> 上一次插入的文本</li><li><code>%</code> 当前文件名</li><li><code>#</code> 轮换文件名</li><li><code>/</code> 最后搜索的模式</li></ul><h3 id=表达式寄存器->表达式寄存器 <code>=</code></h3><p>Vim自带计算器</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;=1+2*3</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>p</span>
</span></span></code></pre></div><p>还能用函数</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;=strlen(&#34;hello&#34;)</span>
</span></span></code></pre></div><h3 id=查看所有寄存器>查看所有寄存器</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>registers</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&#34; 或</span>
</span></span><span style=display:flex><span>:<span style=color:#a6e22e>reg</span>
</span></span></code></pre></div><p>查看指定寄存器内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>reg</span> + <span style=color:#a6e22e>registername</span>
</span></span></code></pre></div><h3 id=追加到寄存器>追加到寄存器</h3><p>大写寄存器名</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;Ayy  &#34; 追加一行到寄存器a</span>
</span></span></code></pre></div><h3 id=特殊粘贴>特殊粘贴</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 在插入模式下粘贴寄存器内容</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#a6e22e>C</span>-<span style=color:#a6e22e>r</span>&gt;<span style=color:#a6e22e>a</span> <span style=color:#75715e>&#34; 插入模式下粘贴寄存器a的内容</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#a6e22e>C</span>-<span style=color:#a6e22e>r</span>&gt;<span style=color:#e6db74>&#34;  &#34;</span> <span style=color:#a6e22e>插入模式下粘贴默认寄存器的内容</span>
</span></span></code></pre></div><h2 id=heading><code>.</code></h2><p>在Vim中，<code>.</code>命令表示重复上一次操作的命令<br>适用于插入、删除、替换、修改等操作，可以配合移动命令使用，进行批量重复</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>iHello</span>&lt;<span style=color:#a6e22e>Esc</span>&gt; <span style=color:#75715e>&#34; 插入 ’Hello&#39;</span>
</span></span><span style=display:flex><span>.           <span style=color:#75715e>&#34; 再按 . 会在光标处插入同样的 &#39;Hello&#39;</span>
</span></span></code></pre></div><h3 id=可被重复的操作类型>可被重复的操作类型</h3><p><code>.</code>可以重复的操作大致有</p><ul><li>插入</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>iHello</span>&lt;<span style=color:#a6e22e>Esc</span>&gt; <span style=color:#75715e>&#34; 插入文本</span>
</span></span><span style=display:flex><span>.           <span style=color:#75715e>&#34; 重复插入相同文本</span>
</span></span></code></pre></div><ul><li>删除</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>dw</span>           <span style=color:#75715e>&#34; 删除一个单词</span>
</span></span><span style=display:flex><span>.            <span style=color:#75715e>&#34; 再删除下一个单词</span>
</span></span></code></pre></div><ul><li>替换</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>rX</span>           <span style=color:#75715e>&#34; 将光标处字符替换成 X</span>
</span></span><span style=display:flex><span>.            <span style=color:#75715e>&#34; 再替换下一个字符</span>
</span></span></code></pre></div><ul><li>更改</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>cwHello</span>&lt;<span style=color:#a6e22e>Esc</span>&gt; <span style=color:#75715e>&#34; 改变一个词</span>
</span></span><span style=display:flex><span>.            <span style=color:#75715e>&#34; 再改变下一个单词</span>
</span></span></code></pre></div><ul><li>复杂命令，<code>.</code>可以重复组合命令，例如<code>daw</code>删除一个单词，再按<code>.</code>可以删除下一个单词</li></ul><p><code>.</code>重复的是上一次完整的编辑操作，而不是上一次键入的按键</p><h3 id=示例>示例</h3><p>批量修改列</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 如果光标在多行同列位置</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>I</span># &lt;<span style=color:#a6e22e>Esc</span>&gt; <span style=color:#75715e>&#34; 在每行行首插入 #</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>j</span>.       <span style=color:#75715e>&#34; 向下移动并重复插入</span>
</span></span></code></pre></div><p>注意光标位置</p><h2 id=宏macro>宏(macro)</h2><p>宏，记录一串按键，然后在别的地方重复执行<br>记录的是按键序列（包括移动、删除、搜索），不是语义，而是操作流程<br>非常适合：重复但有结构的编辑</p><h3 id=使用-3>使用</h3><p>开始录制</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>q{寄存器}
</span></span></code></pre></div><p>例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>qa
</span></span></code></pre></div><p>表示把宏录到寄存器a</p><p>然后开始编辑操作</p><p>停止录制</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>q
</span></span></code></pre></div><p>命令行会显示</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>recording @a
</span></span></code></pre></div><p>播放宏</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>@a
</span></span></code></pre></div><p>执行多次</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>10@a
</span></span></code></pre></div><p>重复上一次宏</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>@@
</span></span></code></pre></div><h3 id=示例-1>示例</h3><p>场景：每行末尾加<code>;</code></p><p>原始文本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>int a
</span></span><span style=display:flex><span>int b
</span></span><span style=display:flex><span>int c
</span></span></code></pre></div><p>步骤</p><p>1.光标放第一行
2.开始录宏</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>qa
</span></span></code></pre></div><p>3.执行操作</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>A;&lt;Esc&gt;j
</span></span></code></pre></div><p>4.停止</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>q
</span></span></code></pre></div><p>5.执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>2@a
</span></span></code></pre></div><p>结果</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>int a;
</span></span><span style=display:flex><span>int b;
</span></span><span style=display:flex><span>int c;
</span></span></code></pre></div><h3 id=宏的本质寄存器>宏的本质：寄存器</h3><p>宏其实就在寄存器里</p><p>查看宏内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>reg</span> <span style=color:#a6e22e>a</span>
</span></span></code></pre></div><p>可以看到</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>a A;&lt;Esc&gt;j
</span></span></code></pre></div><p>宏 = 可读、可编辑的文本</p><h4 id=修改宏>修改宏</h4><p>1.直接编辑寄存器</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#66d9ef>let</span> @<span style=color:#a6e22e>a</span> = &#39;<span style=color:#a6e22e>A</span>;&lt;<span style=color:#a6e22e>Esc</span>&gt;<span style=color:#a6e22e>j</span>
</span></span></code></pre></div><p>2.粘出来改</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34;ap</span>
</span></span></code></pre></div><p>修改后再复制回去</p><h3 id=使用技巧>使用技巧</h3><h4 id=宏--计数>宏 + 计数</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>20@a
</span></span></code></pre></div><h4 id=宏--搜索>宏 + 搜索</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>/ERROR&lt;CR&gt;
</span></span><span style=display:flex><span>qa
</span></span><span style=display:flex><span>dd
</span></span><span style=display:flex><span>n
</span></span><span style=display:flex><span>q
</span></span></code></pre></div><h4 id=宏--normal命令>宏 + Normal命令</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-vim data-lang=vim><span style=display:flex><span>:%<span style=color:#a6e22e>normal</span> @<span style=color:#a6e22e>a</span>
</span></span></code></pre></div><p>对每一行执行宏</p><h4 id=递归宏>递归宏</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>qa
</span></span><span style=display:flex><span>...操作...
</span></span><span style=display:flex><span>@a
</span></span><span style=display:flex><span>q
</span></span></code></pre></div><h3 id=宏-与->宏 与 <code>.</code></h3><table><thead><tr><th>能力</th><th>.</th><th>宏</th></tr></thead><tbody><tr><td>重复一次修改</td><td>yes</td><td>no</td></tr><tr><td>多步骤操作</td><td>no</td><td>yes</td></tr><tr><td>多次执行</td><td>no</td><td>yes</td></tr><tr><td>可编辑</td><td>no</td><td>yes</td></tr></tbody></table><p><code>.</code> 是最小宏</p><h3 id=宏的使用场景>宏的使用场景</h3><ul><li>至少重复3次</li><li>操作步骤稳定</li><li>不想写脚本/正则</li></ul><p>一次性任务使用<code>.</code>或手动</p><h2 id=insert-mode-o>Insert mode ^O</h2><p>Insert下，按下^O, 可临时执行一条普通模式命令，执行完立刻自殴打能够回到插入模式</p><p>在Vim帮助里，它叫<code>:help i_CTRL-O</code>，官方定义是：Execute one command in Normal mode</p><p>示例</p><table><thead><tr><th>按键</th><th>效果</th></tr></thead><tbody><tr><td><code>^O0</code></td><td>跳到行首</td></tr><tr><td><code>^O^</code></td><td>跳到第一个非空字符</td></tr><tr><td><code>^O$</code></td><td>跳到行尾</td></tr><tr><td><code>^Ow</code></td><td>下一个单词</td></tr><tr><td><code>^Ob</code></td><td>上一个单词</td></tr><tr><td><code>^Ogg</code></td><td>文件开头</td></tr><tr><td><code>^OG</code></td><td>文件结尾</td></tr><tr><td><code>^Odw</code></td><td>删除一个单词</td></tr><tr><td><code>^OD</code></td><td>删除行尾</td></tr><tr><td><code>^Occ</code></td><td>改整行并继续插入</td></tr><tr><td><code>^Ox</code></td><td>删一个字符</td></tr></tbody></table><h2 id=mark>mark</h2></div><nav class=post-nav><a href=/unixlike/lib/verify-pack/ class=hover:underline>pre: verify-pack</a>
<a href=/unixlike/lib/worktree/ class=hover:underline>next: Worktree</a></nav></article><aside class=toc><h3>TOC</h3><nav id=TableOfContents><ul><li><a href=#vi历史背景-from-wikipedia>vi（历史背景 from Wikipedia）</a></li><li><a href=#modal-editor>Modal Editor</a><ul><li><a href=#核心思想>核心思想</a></li><li><a href=#优势>优势</a></li><li><a href=#缺点>缺点</a></li></ul></li><li><a href=#vim>Vim</a><ul><li><a href=#安装>安装</a><ul><li><a href=#通过包管理器安装>通过包管理器安装</a></li><li><a href=#从源码安装>从源码安装</a></li></ul></li><li><a href=#使用>使用</a><ul><li><a href=#内置帮助>内置帮助</a></li><li><a href=#vim-tutor>Vim Tutor</a></li></ul></li><li><a href=#配置>配置</a></li><li><a href=#vimscript>Vimscript</a><ul><li><a href=#vim-1>Vim</a></li></ul></li><li><a href=#终端模式>终端模式</a></li><li><a href=#tabs>tabs</a><ul><li><a href=#创建标签页>创建标签页</a></li><li><a href=#标签页导航>标签页导航</a></li><li><a href=#标签页操作>标签页操作</a></li><li><a href=#标签页与窗口的配合>标签页与窗口的配合</a></li></ul></li><li><a href=#buffer>Buffer</a><ul><li><a href=#重要特性>重要特性</a></li><li><a href=#缓冲区状态>缓冲区状态</a></li><li><a href=#查看缓冲区>查看缓冲区</a><ul><li><a href=#列出缓冲区>列出缓冲区</a></li><li><a href=#详细列表>详细列表</a></li></ul></li><li><a href=#打开创建缓冲区>打开/创建缓冲区</a><ul><li><a href=#从文件打开>从文件打开</a></li><li><a href=#命令行打开>命令行打开</a></li></ul></li><li><a href=#切换缓冲区>切换缓冲区</a></li><li><a href=#删除缓冲区>删除缓冲区</a></li><li><a href=#缓冲区操作>缓冲区操作</a></li><li><a href=#缓冲区与窗口>缓冲区与窗口</a></li><li><a href=#批量操作>批量操作</a></li></ul></li><li><a href=#终端窗口>终端窗口</a><ul><li><a href=#使用-1>使用</a><ul><li><a href=#打开>打开</a></li><li><a href=#指定shell或命令>指定shell或命令</a></li><li><a href=#模式切换>模式切换</a></li><li><a href=#调整位置>调整位置</a></li><li><a href=#复制粘贴>复制/粘贴</a></li><li><a href=#退出>退出</a></li></ul></li><li><a href=#设置>设置</a><ul><li><a href=#终端自动进入插入模式>终端自动进入插入模式</a></li><li><a href=#禁用行号>禁用行号</a></li></ul></li></ul></li><li><a href=#vimdiff>vimdiff</a><ul><li><a href=#进入vim-diff模式>进入Vim diff模式</a></li><li><a href=#使用-2>使用</a><ul><li><a href=#操作>操作</a><ul><li><a href=#在差异间跳转>在差异间跳转</a></li><li><a href=#选择改动>选择改动</a></li><li><a href=#同步滚动>同步滚动</a></li></ul></li></ul></li><li><a href=#diff配置>diff配置</a></li></ul></li><li><a href=#行号跳转>行号跳转</a></li><li><a href=#插件-vim-markdown-快捷键>插件 vim-markdown 快捷键</a></li><li><a href=#swp-文件>.swp 文件</a><ul><li><a href=#工作原理>工作原理</a></li><li><a href=#管理交换文件>管理交换文件</a><ul><li><a href=#基本命令>基本命令</a></li><li><a href=#恢复编辑会话>恢复编辑会话</a></li><li><a href=#交换文件位置控制>交换文件位置控制</a></li><li><a href=#配置选项>配置选项</a><ul><li><a href=#启用禁用>启用/禁用</a></li><li><a href=#行为控制>行为控制</a></li></ul></li><li><a href=#文件扩展名>文件扩展名</a></li></ul></li></ul></li><li><a href=#sign-column>sign column</a></li><li><a href=#寄存器>寄存器</a><ul><li><a href=#寄存器总览>寄存器总览</a></li><li><a href=#未命名寄存器->未命名寄存器 <code>"</code></a></li><li><a href=#数字寄存器-0-9>数字寄存器 <code>0-9</code></a><ul><li><a href=#0最近一次yank><code>0</code>最近一次yank</a></li><li><a href=#1-9-删除历史><code>1-9</code> 删除历史</a></li></ul></li><li><a href=#命名寄存器a-z>命名寄存器<code>a-z</code></a></li><li><a href=#系统剪贴板>系统剪贴板<code>+</code>/<code>*</code></a></li><li><a href=#黑洞寄存器-_>黑洞寄存器 <code>_</code></a></li><li><a href=#小删除寄存器-->小删除寄存器 <code>-</code></a></li><li><a href=#只读寄存器--->只读寄存器 <code>:</code>, <code>.</code>, <code>%</code></a></li><li><a href=#表达式寄存器->表达式寄存器 <code>=</code></a></li><li><a href=#查看所有寄存器>查看所有寄存器</a></li><li><a href=#追加到寄存器>追加到寄存器</a></li><li><a href=#特殊粘贴>特殊粘贴</a></li></ul></li><li><a href=#heading><code>.</code></a><ul><li><a href=#可被重复的操作类型>可被重复的操作类型</a></li><li><a href=#示例>示例</a></li></ul></li><li><a href=#宏macro>宏(macro)</a><ul><li><a href=#使用-3>使用</a></li><li><a href=#示例-1>示例</a></li><li><a href=#宏的本质寄存器>宏的本质：寄存器</a><ul><li><a href=#修改宏>修改宏</a></li></ul></li><li><a href=#使用技巧>使用技巧</a><ul><li><a href=#宏--计数>宏 + 计数</a></li><li><a href=#宏--搜索>宏 + 搜索</a></li><li><a href=#宏--normal命令>宏 + Normal命令</a></li><li><a href=#递归宏>递归宏</a></li></ul></li><li><a href=#宏-与->宏 与 <code>.</code></a></li><li><a href=#宏的使用场景>宏的使用场景</a></li></ul></li><li><a href=#insert-mode-o>Insert mode ^O</a></li><li><a href=#mark>mark</a></li></ul></li></ul></nav></aside><script src=/js/scrollspy.js defer></script><script type=module>
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ 
    startOnLoad: true, theme: "default" });
</script><footer><div class=container><p>© 2026 Jeff Lee(ljf12825). All rights reserved |
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>Article: CC BY-NC-SA 4.0</a> |
<a href=https://creativecommons.org/licenses/by-sa/4.0/>Content: CC BY-SA 4.0</a> |
<a href=https://opensource.org/licenses/MIT>Code: MIT License</a> |
<a href=/LICENSES.md>Full License</a></p></div></footer></body></html>
<!doctype html><html lang=en><head><meta name=page-kind content="page"><meta charset=UTF-8><title>read-tree</title><link rel=stylesheet href=/css/style.css><link href=https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/prism.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-csharp.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-cpp.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-json.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-bash.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-ini.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-c.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><link rel=stylesheet href=/css/blogsingle.css></head><body><header class=site-header><div class=container><div class=terminal-overlay aria-label=terminal-prompt><span id=typed-line></span><span class=cursor>█</span></div></div></header><nav class=topnav><div class=container><ul><li><a href=/unixlike/>★</a></li><li><a href=/unixlike/lab/>Lab</a></li><li><a href=/unixlike/lib/>Lib</a></li><li><a href=/unixlike/file/>File</a></li></ul></div></nav><nav id=star-nav><div id=star-header><span class="title open">>> >> >> Navigation &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Nav>>>>>></span></div><pre class=ascii>
+——————————————————————————————————————————————————————————————+
|                        <a class=nav-item data-path=/rightbrain/ href=/rightbrain/>RightBrain</a>                            |
|                             |                                |
|                             |     <a class=nav-item data-path=/dotnetandwindows/ href=/dotnetandwindows/>.NET-Windows</a>               |
|                             |    /                           |
|                             |   /                            |
|                             |  /                             |
|                             | /                              |
|                             |/                               |
|      <a class=nav-item data-path=/graphic/ href=/graphic/>Graphic</a> ———————————— <a class=nav-item data-path=/home/ href=/home/>Home</a> ————————————— <a class=nav-item data-path=/system/ href=/system/>System</a>          |
|                            /|                                |
|                           / |                                |
|                          /  |                                |
|                         /   |                                |
|                        /    |                                |
|                       /     |                                |
|              <a class=nav-item data-path=/unixlike/ href=/unixlike/>Unix-like</a>      |                <a class=nav-item data-path=/project/ href=/project/>Project</a>         |
|                             |                <a class=nav-item data-path=/miscellaneous/ href=/miscellaneous/>Miscellaneous</a>   |
|                          <a class=nav-item data-path=/csbasic/ href=/csbasic/>CSBasic</a>             <a class=nav-item data-path=/ai/ href=/ai/>AI</a>              |
+——————————————————————————————————————————————————————————————+
    </pre></nav><script defer src=/js/star-nav.js></script><script defer src=/js/site.js></script><script defer src=/js/star-active.js></script><div id=ref-window class="float-window open"><div class=float-header><span class="title open">>> >> >> Reference &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Ref>>>>>></span></div><div class=float-body><div class=ref-list><a href=https://www.mixamo.com/ target=_blank>Mixamo</a> |
<a href=https://opengameart.org/ target=_blank>OpenGameArt</a><p><a href=https://sharplab.io/ target=_blank>SharpLab</a> |
<a href=https://godbolt.org/ target=_blank>Compiler Explorer</a></p><p><a href="https://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type+Something+&x=none&v=4&h=4&w=80&we=false" target=_blank>ASCII Graph Generator</a></p><p><a href=https://mermaid.js.org/ target=_blank>Mermaid</a></p><a href=https://www.vim.org/ target=_blank>Vim</a> | <a href=https://vimdoc.sourceforge.net/ target=_blank>Vim Manual Source</a> |
<a href=https://vimcdoc.sourceforge.net/ target=_blank>Vimcdoc</a> | <a href=https://vimcdoc.sourceforge.net/doc/help.html target=_blank>Vimdoc read online</a><p><a href=https://shields.io/ target=_blank>Shields.io</a></p><p><a href=https://emojidb.org/ target=_blank>EmojiDB</a></p><p><a href=https://cppreference.com/ target=_blank>cppreference</a></p><p><a href=https://gcc.gnu.org/onlinedocs/ target=_blank>GCC Docs</a></p><p><a href=https://clang.llvm.org/docs/ target=_blank>Clang Docs</a></p><p><a href=https://www.boost.org/libraries/ target=_blank>Boost Library Docs</a></p><p><a href=https://learn.microsoft.com/en-us/dotnet/csharp/ target=_blank>Microsoft Learn</a><p><a href=https://www.lua.org/manual/5.4/ target=_blank>Lua 5.4 Reference Manual</a><p><a href=https://docs.unity3d.com/Manual/index.html target=_blank>Unity Manual</a> |
<a href=https://docs.unity3d.com/ScriptReference/index.html target=_blank>Unity API</a></p><p><a href=https://docs.unrealengine.com/ target=_blank>Unreal Engine Docs</a></p><p><a href=https://godotengine.org target=_blank>Godot</a> |
<a href=https://docs.godotengine.org/en/stable/ target=_blank>Godot Docs</a></p><p><a href=https://z-library.sk/ target=_blank>Z-Library</a> : eBook Library</p><p><a href=https://docs.kernel.org/ target=_blank>Linux Kernel Docs</a></p><p><a href=https://www.gnu.org/ target=_blank>GNU</a> : manuals, philosophy, FAQ</p><a href=https://archlinux.org/ target=_blank>ArchLinux</a><p><a href=https://help.ubuntu.com/ target=_blank>Ubuntu Doc</a> |
<a href=https://ubuntu.com/server/docs target=_blank>Ubuntu Server Guide</a></p><p><a href=https://www.vulkan.org/ target=_blank>Vulkan</a> |
<a href=https://docs.vulkan.org/ target=_blank>Vulkan Docs</a></p><p><a href=https://www.opengl.org/ target=_blank>OpenGL</a> |
<a href=https://registry.khronos.org/OpenGL target=_blank>OpenGL API</a> |
<a href=https://www.khronos.org/opengl/wiki/ target=_blank>OpenGL Wiki</a></p><p><a href=https://learn.microsoft.com/en-us/windows/win32/directx target=_blank>DirectX</a></p><p><a href=https://www.realtimerendering.com/ target=_blank>Real-Time Rendering</a></p><p><a href=https://www.pbr-book.org/ target=_blank>Physically Based Rendering</a></p><p><a href=https://www.scratchapixel.com/ target=_blank>Scratchapixel</a></p><p><a href=https://learnopengl.com/ target=_blank>LearnOpenGL</a></p><p><a href=https://raytracing.github.io/ target=_blank>Ray Tracing in One Weekend</a></p><p><a href=https://www.shadertoy.com/ target=_blank>Shadertoy</a></p><p><a href=https://arxiv.org/list/cs.GR/recent target=_blank>arXiv Graphics</a></p><p><a href=https://www.siggraph.org/ target=_blank>SIGGRAPH</a> |
<a href=https://dl.acm.org/conference/siggraph target=_blank>SIGGRAPH Digital Library</a></p><p><a href=https://git-scm.com/ target=_blank>Git</a> |
<a href=https://git-scm.com/doc target=_blank>Docs</a> |
<a href=https://git-scm.com/community target=_blank>Community</a></p></div></div></div><script src=/js/ref-window.js></script><article class=single_article><div class=title>read-tree<div class=meta>Modified: 2025-12-31
| Author：ljf12825</div></div><div class=content><p><code>git read-tree</code>是一个底层命令，它的核心功能是将一个或多个树对象读入到暂存区（索引）</p><p>可以把它理解为直接操作<code>.git/index</code>这个文件的“手术刀”。它不处理工作区里的实际文件，只操作索引</p><h2 id=存在意义>存在意义</h2><ol><li>暂存区：Git有一个叫“暂存区”或“索引”的区域，它本质上是一个文件（<code>.git/index</code>），记录了当前项目结构和文件的快照，这个快照就是下一次提交的内容</li><li>树对象：在Git中，每一次提交都对应一个“树对象”，它记录了该次提交时项目的目录结构和所有文件的blob哈希值</li></ol><p><code>git read-tree</code>就是在暂存区和树对象之间架起的一座桥梁</p><h2 id=主要场景与使用方法>主要场景与使用方法</h2><p><code>git read-tree</code>本身功能强大，但通常不直接在日常工作中使用，而是被更友好的高层命令（如<code>git merge</code>, <code>git chechout</code>等）在内部调用。理解它有助于理解Git的内部机制<br>以下是它的几个主要模式</p><h3 id=1-将指定树对象读入暂存区覆盖>1. 将指定树对象读入暂存区（覆盖）</h3><p>这是最基础的用法，它用指定的树对象完全覆盖当前的暂存区</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>git read-tree &lt;tree-ish&gt;
</span></span></code></pre></div><ul><li><code>&lt;tree-ish></code>可以是提交的哈希、分支名、标签名等</li></ul><p>示例</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 将 main 分支最新的提交所对应的树对象读入暂存区</span>
</span></span><span style=display:flex><span>git read-tree main
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 将某个特定的提交哈希对应的树读入暂存区</span>
</span></span><span style=display:flex><span>git raed-tree abc1234
</span></span></code></pre></div><p>执行后：暂存区会变得和<code>main</code>分支的最新提交一模一样。工作区的文件还没有变化。如果此时运行<code>git status</code>，它会提示暂存区已经更新，但工作区文件需要更新以匹配暂存区（可以通过<code>git checkout-index -f -a</code>来同步工作区）</p><h3 id=2-将树对象合并到当前暂存区-m>2. 将树对象合并到当前暂存区（<code>-m</code>）</h3><p>这是实现合并操作的核心。它可以将2个或3个树对象合并的结果写入暂存区</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 三路合并（最常用也是最标准合并的方式）</span>
</span></span><span style=display:flex><span>git read-tree -m &lt;base_tree&gt; &lt;out_tree&gt; &lt;their_tree&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 两路合并（没有共同祖先，容易冲突）</span>
</span></span><span style=display:flex><span>git read-tree -m &lt;tree1&gt; &lt;tree2&gt;
</span></span></code></pre></div><ul><li><code>-m</code>：执行合并操作</li><li><code>base-tree</code>：共同祖先的树</li><li><code>out_tree</code>：当前所在分支的树</li><li><code>their_tree</code>：要合并进来的分支的树</li></ul><p>Git内部工作流程</p><ol><li>Git比较<code>base_tree</code>和<code>our_tree</code>，得到当前所在分支做了哪些修改</li><li>Git比较<code>base_tree</code>和<code>their_tree</code>，得到要合并进来的分支做了哪些修改</li><li>如果修改没有冲突，Git会自动将这些修改合并，并将结果写入暂存区</li><li>如果发生冲突（例如同一行被双方修改），Git会在暂存区中记录冲突状态（stages1, 2, 3），而不会在工作区创建<code>&lt;&lt;&lt;&lt;&lt;&lt;</code>冲突标记。需要使用<code>git checkout-index</code>来将冲突状态应用到工作区文件</li></ol><h3 id=3-将树对象读入暂存区的特定前缀下--prefix>3. 将树对象读入暂存区的特定前缀下（<code>--prefix</code>）</h3><p>这就像在暂存区创建一个子目录，然后把另一个树对象的内容放进去。这在实现子模块或复杂项目结构时可能用到</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>git read-tree --prefix<span style=color:#f92672>=</span>subproject/ &lt;tree-ish&gt;
</span></span></code></pre></div><p>示例：<br>假设你有一个库的Git仓库，你想把它作为你的主项目的一个子目录</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 将 lib-foo 仓库的 main 分支树对象读入暂存区的 `vendor/lib-foo/` 目录下</span>
</span></span><span style=display:flex><span>git read-tree --prefix<span style=color:#f92672>=</span>vendor/lib-foo/ -u lib-foo-branch
</span></span></code></pre></div><ul><li><code>-u</code>选项会让命令在更新暂存区后，同时更新工作区的文件</li></ul><h2 id=read-tree与高层命令的关系><code>read-tree</code>与高层命令的关系</h2><ul><li><code>git reset --soft &lt;commit></code>：在内部，它很可能调用链<code>read-tree</code>来将指定提交的树读入暂存区，同时移动HEAD指针</li><li><code>git merge</code>：它的核心合并逻辑就是通过<code>read-tree -m</code>来完成了。<code>git merge</code>帮你处理了寻找共同祖先、调用<code>read-tree</code>、以及处理合并结果（包括在工作区生成冲突标记）这一整套流程</li><li><code>git checkout &lt;branch></code>：它会调用<code>read-tree</code>来更新暂存区和工作区，以及匹配目标分支</li></ul></div><nav class=post-nav><a href=/unixlike/lib/range-diff/ class=hover:underline>pre: range-diff</a>
<a href=/unixlike/lib/rebase/ class=hover:underline>next: rebase</a></nav></article><aside class=toc><h3>TOC</h3><nav id=TableOfContents><ul><li><ul><li><a href=#存在意义>存在意义</a></li><li><a href=#主要场景与使用方法>主要场景与使用方法</a><ul><li><a href=#1-将指定树对象读入暂存区覆盖>1. 将指定树对象读入暂存区（覆盖）</a></li><li><a href=#2-将树对象合并到当前暂存区-m>2. 将树对象合并到当前暂存区（<code>-m</code>）</a></li><li><a href=#3-将树对象读入暂存区的特定前缀下--prefix>3. 将树对象读入暂存区的特定前缀下（<code>--prefix</code>）</a></li></ul></li><li><a href=#read-tree与高层命令的关系><code>read-tree</code>与高层命令的关系</a></li></ul></li></ul></nav></aside><script src=/js/scrollspy.js defer></script><script type=module>
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ 
    startOnLoad: true, theme: "default" });
</script><footer><div class=container><p>© 2026 Jeff Lee(ljf12825). All rights reserved |
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>Article: CC BY-NC-SA 4.0</a> |
<a href=https://creativecommons.org/licenses/by-sa/4.0/>Content: CC BY-SA 4.0</a> |
<a href=https://opensource.org/licenses/MIT>Code: MIT License</a> |
<a href=/LICENSES.md>Full License</a></p></div></footer></body></html>
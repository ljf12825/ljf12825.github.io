<!doctype html><html lang=en><head><meta name=page-kind content="page"><meta charset=UTF-8><title>Clang and Configuration</title><link rel=stylesheet href=/css/style.css><link href=https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/prism.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-csharp.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-cpp.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-json.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-bash.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-ini.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-c.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><link rel=stylesheet href=/css/blogsingle.css></head><body><header class=site-header><div class=container><div class=terminal-overlay aria-label=terminal-prompt><span id=typed-line></span><span class=cursor>█</span></div></div></header><nav class=topnav><div class=container><ul><li><a href=/unixlike/>★</a></li><li><a href=/unixlike/lab/>Lab</a></li><li><a href=/unixlike/lib/>Lib</a></li><li><a href=/unixlike/file/>File</a></li></ul></div></nav><nav id=star-nav><div id=star-header><span class="title open">>> >> >> Navigation &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Nav>>>>>></span></div><pre class=ascii>
+——————————————————————————————————————————————————————————————+
|                        <a class=nav-item data-path=/rightbrain/ href=/rightbrain/>RightBrain</a>                            |
|                             |                                |
|                             |     <a class=nav-item data-path=/dotnetandwindows/ href=/dotnetandwindows/>.NET-Windows</a>               |
|                             |    /                           |
|                             |   /             <a class=nav-item data-path=/engine/ href=/engine/>Engine</a>         |
|                             |  /                 |           |
|                             | /                  |           |
|                             |/                   |           |
|      <a class=nav-item data-path=/graphic/ href=/graphic/>Graphic</a> ———————————— <a class=nav-item data-path=/home/ href=/home/>Home</a> ————————————— <a class=nav-item data-path=/framework/ href=/framework/>Framework</a>       |
|                            /|                                |
|                           / |                                |
|                          /  |                                |
|                         /   |       <a class=nav-item data-path=/language/ href=/language/>Language</a>                 |
|                        /    |      /                         |
|                       /     |     /                          |
|              <a class=nav-item data-path=/unixlike/ href=/unixlike/>Unix-like</a>      |    /           <a class=nav-item data-path=/project/ href=/project/>Project</a>         |
|                             |   /            <a class=nav-item data-path=/miscellaneous/ href=/miscellaneous/>Miscellaneous</a>   |
|                        <a class=nav-item data-path=/leftbrain/ href=/leftbrain/>LeftBrain</a>             <a class=nav-item data-path=/ai/ href=/ai/>AI</a>              |
+——————————————————————————————————————————————————————————————+
    </pre></nav><script defer src=/js/star-nav.js></script><script defer src=/js/site.js></script><script defer src=/js/star-active.js></script><div id=ref-window class="float-window open"><div class=float-header><span class="title open">>> >> >> Reference &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Ref>>>>>></span></div><div class=float-body><div class=ref-list><a href=https://www.mixamo.com/ target=_blank>Mixamo</a> |
<a href=https://opengameart.org/ target=_blank>OpenGameArt</a><p><a href=https://sharplab.io/ target=_blank>SharpLab</a> |
<a href=https://godbolt.org/ target=_blank>Compiler Explorer</a></p><p><a href="https://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type+Something+&x=none&v=4&h=4&w=80&we=false" target=_blank>ASCII Graph Generator</a></p><p><a href=https://mermaid.js.org/ target=_blank>Mermaid</a></p><a href=https://www.vim.org/ target=_blank>Vim</a> | <a href=https://vimdoc.sourceforge.net/ target=_blank>Vim Manual Source</a> |
<a href=https://vimcdoc.sourceforge.net/ target=_blank>Vimcdoc</a> | <a href=https://vimcdoc.sourceforge.net/doc/help.html target=_blank>Vimdoc read online</a><p><a href=https://shields.io/ target=_blank>Shields.io</a></p><p><a href=https://emojidb.org/ target=_blank>EmojiDB</a></p><p><a href=https://cppreference.com/ target=_blank>cppreference</a></p><p><a href=https://gcc.gnu.org/onlinedocs/ target=_blank>GCC Docs</a></p><p><a href=https://clang.llvm.org/docs/ target=_blank>Clang Docs</a></p><p><a href=https://www.boost.org/libraries/ target=_blank>Boost Library Docs</a></p><p><a href=https://learn.microsoft.com/en-us/dotnet/csharp/ target=_blank>Microsoft Learn</a><p><a href=https://www.lua.org/manual/5.4/ target=_blank>Lua 5.4 Reference Manual</a><p><a href=https://docs.unity3d.com/Manual/index.html target=_blank>Unity Manual</a> |
<a href=https://docs.unity3d.com/ScriptReference/index.html target=_blank>Unity API</a></p><p><a href=https://docs.unrealengine.com/ target=_blank>Unreal Engine Docs</a></p><p><a href=https://godotengine.org target=_blank>Godot</a> |
<a href=https://docs.godotengine.org/en/stable/ target=_blank>Godot Docs</a></p><p><a href=https://z-library.sk/ target=_blank>Z-Library</a> : eBook Library</p><p><a href=https://docs.kernel.org/ target=_blank>Linux Kernel Docs</a></p><p><a href=https://www.gnu.org/ target=_blank>GNU</a> : manuals, philosophy, FAQ</p><a href=https://archlinux.org/ target=_blank>ArchLinux</a><p><a href=https://help.ubuntu.com/ target=_blank>Ubuntu Doc</a> |
<a href=https://ubuntu.com/server/docs target=_blank>Ubuntu Server Guide</a></p><p><a href=https://www.vulkan.org/ target=_blank>Vulkan</a> |
<a href=https://docs.vulkan.org/ target=_blank>Vulkan Docs</a></p><p><a href=https://www.opengl.org/ target=_blank>OpenGL</a> |
<a href=https://registry.khronos.org/OpenGL target=_blank>OpenGL API</a> |
<a href=https://www.khronos.org/opengl/wiki/ target=_blank>OpenGL Wiki</a></p><p><a href=https://learn.microsoft.com/en-us/windows/win32/directx target=_blank>DirectX</a></p><p><a href=https://www.realtimerendering.com/ target=_blank>Real-Time Rendering</a></p><p><a href=https://www.pbr-book.org/ target=_blank>Physically Based Rendering</a></p><p><a href=https://www.scratchapixel.com/ target=_blank>Scratchapixel</a></p><p><a href=https://learnopengl.com/ target=_blank>LearnOpenGL</a></p><p><a href=https://raytracing.github.io/ target=_blank>Ray Tracing in One Weekend</a></p><p><a href=https://www.shadertoy.com/ target=_blank>Shadertoy</a></p><p><a href=https://arxiv.org/list/cs.GR/recent target=_blank>arXiv Graphics</a></p><p><a href=https://www.siggraph.org/ target=_blank>SIGGRAPH</a> |
<a href=https://dl.acm.org/conference/siggraph target=_blank>SIGGRAPH Digital Library</a></p><p><a href=https://git-scm.com/ target=_blank>Git</a> |
<a href=https://git-scm.com/doc target=_blank>Docs</a> |
<a href=https://git-scm.com/community target=_blank>Community</a></p></div></div></div><script src=/js/ref-window.js></script><article class=single_article><div class=title>Clang and Configuration<div class=meta>Modified: 2025-12-31
| Author：ljf12825</div></div><div class=content><p>Clang是一个开源的、基于LLVM的编译器前端，支持C、C++、Objective-C、Objective-C++、CUDA、OpenCL等多种编程语言的编译。Clang的目标是提供一个高效、灵活、现代化的编译器，同时拥有非常清晰和易于维护的代码结构</p><p><strong>背景</strong><br>Clang的背景可以追溯到LLVM项目，它是由苹果公司开发的，并于2007年首次发布</p><p>LLVM（Low Level Virtual Machine）项目最初由Chris Lattner在2000年发起，目标是创建一个可重用、跨平台的编译器基础设施。LLVM最初的设计目的是为了支持程序优化和高效的目标代码，特别是为新兴的编程语言提供后端支持</p><p>Clang是LLVM项目的一部分，旨在作为一个编译器前端（Complier Frontend）替代现有的GCC。Clang的出现给GCC带来了激烈的竞争。Clang强调更高的编译速度、更好的错误信息以及更加现代化的架构设计。Clang在很多开发者中受到欢迎，尤其在macOS和iOS开发中，Clang成为苹果平台的默认编译器</p><p><strong>LLVM生态系统</strong><br>LLVM项目不仅仅是Clang，它还包含了许多其他组件和工具</p><ul><li>LLVM IR：中间表示，用于进行代码优化</li><li>LLVM 后端：生成目标代码，可以针对不同的架构和平台进行优化</li><li>LLDB调试器：与Clang紧密集成的调试器，支持调试C/C++/Objective-C代码</li><li>Flang：基于LLVM的Fortran编译器</li></ul><p><strong>Clang的主要特点</strong>\</p><ol><li><p>高性能
Clang在编译速度和生成代码的质量方面都表现优异。它的编译过程通常比GCC更快，并且生成的代码质量也很高</p></li><li><p>友好的错误信息
Clang以其详细、清晰、易于理解的错误信息而著称，尤其是在语法错误、类型错误以及代码优化问题的诊断方面，Clang的错误消息往往比GCC更加清晰</p></li><li><p>模块化和可扩展性
Clang是基于LLVM（低级虚拟机）架构的，具有高度的模块化结构，开发者可以根据自己的需求进行定制和扩展</p></li><li><p>兼容性
Clang与GCC兼容，支持GCC大多数编译选项，同时也可以与GCC编译的代码一起使用。这意味着可以将Clang用作替代GCC进行编译，同时保持代码的兼容性</p></li><li><p>广泛支持的语言</p></li></ol><ul><li>C/C++</li><li>Objective-C/Objective-C++</li><li>OpenCL</li><li>CUDA</li><li>Fortran（通过<code>Flang</code>，也属于LLVM的一部分）</li></ul><p>还支持与其他语言相关的编译和工具链工作，如<code>Swift</code>（由Apple开发）</p><ol start=6><li><p>集成调试器
Clang与LLVM调试器（LLDB）紧密集成，提供了高效的调试体验，尤其适用于调试C、C++和Objective-C代码</p></li><li><p>开源项目
Clang是LLVM项目的一部分，作为一个开源项目，它的代码可以自由使用和修改</p></li></ol><p><strong>Clang的应用场景</strong>\</p><ul><li>开发工具链：许多现代开发环境使用Clang作为编译器，尤其是在macOS和iOS开发中，Clang是默认的编译器</li><li>静态分析：Clang提供了强大的静态分析功能，可以帮助开发者在编译时发现潜在代码问题</li><li>跨平台开发：Clang支持多种操作系统和平台，包括Linux、macOS、Windows等</li></ul><h3 id=clang工具链的安装>Clang工具链的安装</h3><p><strong>通过系统包管理器安装</strong>\</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install clang clangd clang-tidy clang-format lldb lld
</span></span></code></pre></div><ul><li><code>clang</code>：C/C++编译器</li><li><code>clangd</code>：语言服务器（用于IDE智能提示）</li><li><code>clang-tidy</code>：静态代码分析工具</li><li><code>clang-format</code>：代码格式化工具</li><li><code>lldb</code>：LLVM调试器</li><li><code>lld</code>：LLVM高性能链接器</li></ul><p><strong>安装最新版本</strong>\</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://apt.llvm.org/llvm.sh
</span></span><span style=display:flex><span>chmod +x llvm.sh
</span></span><span style=display:flex><span>sudo ./llvm.sh <span style=color:#ae81ff>18</span> <span style=color:#75715e># 安装 Clang 18</span>
</span></span></code></pre></div><p>安装后，工具会命名为<code>clang-18</code>、<code>clang++-18</code>等，可通过<code>update-alternatives</code>设为默认</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo update-alternatives --install /usr/bin/clang clang /usr/bin/clang-18 <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>sudo update-alternatives --install /usr/bin/clang++ clang++ /usr/bin/clang++-18 <span style=color:#ae81ff>100</span>
</span></span></code></pre></div><p><strong>从源码编译</strong>\</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 1. 下载LLVM源码</span>
</span></span><span style=display:flex><span>git clone https://github.com//llvm/llvm-project.git
</span></span><span style=display:flex><span>cd llvm-project
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. 配置编译选项（推荐使用Ninja加快编译）</span>
</span></span><span style=display:flex><span>cmake -S llvm -B build -G <span style=color:#e6db74>&#34;Ninja&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -DCMAKE_INSTALL_PREFIX<span style=color:#f92672>=</span>/usr/local/llvm-18 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -DLLVM_ENABLE_PROJECTS<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;clang;clang=tools=extra;lldb;lld&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -DCMAKE_BUILD_TYPE<span style=color:#f92672>=</span>Release
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. 编译并安装（耗时较长， -jN 使用多核加速）</span>
</span></span><span style=display:flex><span>cd build
</span></span><span style=display:flex><span>ninja -j<span style=color:#66d9ef>$(</span>nproc<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>sudo ninja install
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. 添加到环境变量</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;export PATH=/usr/local/llvm-18/bin:$PATH&#39;</span> &gt;&gt; ~/.bashrc
</span></span><span style=display:flex><span>source ~/.bashrc
</span></span></code></pre></div><p><strong>验证安装</strong>\</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>clang --version
</span></span><span style=display:flex><span>clang++ --version
</span></span><span style=display:flex><span>lldb --version
</span></span><span style=display:flex><span>lld --version
</span></span><span style=display:flex><span>clangd --version
</span></span></code></pre></div><h2 id=切换默认工具链>切换默认工具链</h2><p>如果系统同时安装了GCC和Clang，可通过<code>update-alternatives</code>切换</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 设置默认编译器为 Clang</span>
</span></span><span style=display:flex><span>sudo update-alternatives --config cc
</span></span><span style=display:flex><span>sudo update-alternatives --config c++
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置默认链接器为 LLD</span>
</span></span><span style=display:flex><span>sudo update-alternatives --install /usr/bin/ld ld /usr/bin/lld <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span>sudo update-alternatives --config ld
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置 gcc 为默认 C 编译器</span>
</span></span><span style=display:flex><span>sudo update-alternatives --install /usr/bin/cc cc /usr/bin/gcc <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>sudo update-alternatives --set cc /usr/bin/gcc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置 g++ 为默认 C++ 编译器</span>
</span></span><span style=display:flex><span>sudo update-alternatives --install /usr/bin/c++ c++ /usr/bin/g++ <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>sudo update-alternatives --set c++ /usr/bin/g++
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 检查当前ld的候选</span>
</span></span><span style=display:flex><span>ls -l /usr/bin/ld*  <span style=color:#75715e># 查看所有 ld 变体</span>
</span></span><span style=display:flex><span>update-alternatives --list ld  <span style=color:#75715e># 查看已注册的 alternatives</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果update-alternatives未配置ld，可以手动设置</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 注册 GNU ld 为默认链接器</span>
</span></span><span style=display:flex><span>sudo update-alternatives --install /usr/bin/ld ld /usr/bin/ld.bfd <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果系统有多个链接器（如 lld），可以手动选择</span>
</span></span><span style=display:flex><span>sudo update-alternatives --config ld
</span></span></code></pre></div><p>验证</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>cc --version <span style=color:#75715e># 显示当前编译器版本</span>
</span></span><span style=display:flex><span>c++ --version <span style=color:#75715e># 显示当前编译器版本</span>
</span></span><span style=display:flex><span>ld --version <span style=color:#75715e># 显示当前链接器版本</span>
</span></span></code></pre></div><p>强制使用某个工具链<br>以GCC为例</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>export CC<span style=color:#f92672>=</span>gcc
</span></span><span style=display:flex><span>export CXX<span style=color:#f92672>=</span>g++
</span></span><span style=display:flex><span>export LD<span style=color:#f92672>=</span>ld
</span></span></code></pre></div><p>或者在编译时指定</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>gcc main.c -o main <span style=color:#75715e># 显式使用 gcc</span>
</span></span><span style=display:flex><span>ld ... <span style=color:#75715e># 显式使用GNU ld</span>
</span></span></code></pre></div><p>恢复默认设置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 重置编译器</span>
</span></span><span style=display:flex><span>sudo update-alternatives --auto cc
</span></span><span style=display:flex><span>sudo update-alternatives --auto c++
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 重置链接器</span>
</span></span><span style=display:flex><span>sudo update-alternatives --auto ld
</span></span></code></pre></div></div><nav class=post-nav><a href=/unixlike/lib/cherry-pick/ class=hover:underline>pre: cherry-pick</a>
<a href=/unixlike/lib/clean/ class=hover:underline>next: clean</a></nav></article><aside class=toc><h3>TOC</h3><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#clang工具链的安装>Clang工具链的安装</a></li></ul></li><li><a href=#切换默认工具链>切换默认工具链</a></li></ul></li></ul></nav></aside><script src=/js/scrollspy.js defer></script><script type=module>
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ 
    startOnLoad: true, theme: "default" });
</script><footer><div class=container><p>© 2026 Jeff Lee(ljf12825). All rights reserved |
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>Article: CC BY-NC-SA 4.0</a> |
<a href=https://creativecommons.org/licenses/by-sa/4.0/>Content: CC BY-SA 4.0</a> |
<a href=https://opensource.org/licenses/MIT>Code: MIT License</a> |
<a href=/LICENSES.md>Full License</a></p></div></footer></body></html>
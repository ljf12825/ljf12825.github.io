<!doctype html><html lang=en><head><meta name=page-kind content="page"><meta charset=UTF-8><title>Queue</title><link rel=stylesheet href=/css/style.css><link href=https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/prismjs@1/prism.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-c.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-cpp.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-csharp.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-bash.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-json.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-lua.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-python.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-rust.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><link rel=stylesheet href=/css/logsingle.css></head><body><header class=site-header><div class=container><div class=terminal-overlay aria-label=terminal-prompt><span id=typed-line></span><span class=cursor>█</span></div></div></header><nav class=topnav><div class=container><ul><li><a href=/leftbrain/>★</a></li><li><a href=/leftbrain/lab/>Lab</a></li><li><a href=/leftbrain/log/>Log</a></li><li><a href=/leftbrain/file/>File</a></li></ul></div></nav><nav id=star-nav><div id=star-header><span class="title open">>> >> >> Navigation &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Nav>>>>>></span></div><pre class=ascii>
+——————————————————————————————————————————————————————————————+
|                        <a class=nav-item data-path=/rightbrain/ href=/rightbrain/>RightBrain</a>                            |
|                             |                                |
|                             |     <a class=nav-item data-path=/dotnetandwindows/ href=/dotnetandwindows/>.NET-Windows</a>               |
|                             |    /                           |
|                             |   /                            |
|                             |  /                             |
|                             | /                              |
|                             |/                               |
|      <a class=nav-item data-path=/graphic/ href=/graphic/>Graphic</a> ———————————— <a class=nav-item data-path=/home/ href=/home/>Home</a> ————————————— <a class=nav-item data-path=/runtime/ href=/runtime/>Runtime</a>         |
|                            /|                                |
|                           / |                                |
|                          /  |                                |
|                         /   |       <a class=nav-item data-path=/language/ href=/language/>Language</a>                 |
|                        /    |      /                         |
|                       /     |     /                          |
|              <a class=nav-item data-path=/unixlike/ href=/unixlike/>Unix-like</a>      |    /           <a class=nav-item data-path=/project/ href=/project/>Project</a>         |
|                             |   /            <a class=nav-item data-path=/miscellaneous/ href=/miscellaneous/>Miscellaneous</a>   |
|                        <a class=nav-item data-path=/leftbrain/ href=/leftbrain/>LeftBrain</a>             <a class=nav-item data-path=/ai/ href=/ai/>AI</a>              |
+——————————————————————————————————————————————————————————————+
    </pre></nav><script defer src=/js/star-nav.js></script><script defer src=/js/site.js></script><script defer src=/js/star-active.js></script><div id=ref-window class="float-window open"><div class=float-header><span class="title open">>> >> >> Reference &lt;&lt; &lt;&lt; &lt;&lt;</span>
<span class="title closed">&lt;&lt;&lt;&lt;&lt;&lt;Ref>>>>>></span></div><div class=float-body><div class=ref-list><a href=https://www.mixamo.com/ target=_blank>Mixamo</a> |
<a href=https://opengameart.org/ target=_blank>OpenGameArt</a><p><a href=https://sharplab.io/ target=_blank>SharpLab</a> |
<a href=https://godbolt.org/ target=_blank>Compiler Explorer</a></p><p><a href="https://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type+Something+&x=none&v=4&h=4&w=80&we=false" target=_blank>ASCII Graph Generator</a></p><p><a href=https://mermaid.js.org/ target=_blank>Mermaid</a></p><a href=https://www.vim.org/ target=_blank>Vim</a> | <a href=https://vimdoc.sourceforge.net/ target=_blank>Vim Manual Source</a> |
<a href=https://vimcdoc.sourceforge.net/ target=_blank>Vimcdoc</a> | <a href=https://vimcdoc.sourceforge.net/doc/help.html target=_blank>Vimdoc read online</a><p><a href=https://shields.io/ target=_blank>Shields.io</a></p><p><a href=https://emojidb.org/ target=_blank>EmojiDB</a></p><p><a href=https://cppreference.com/ target=_blank>cppreference</a> |
<a href=https://isocpp.org/ target=_blank>isocpp</a> |
<a href=https://open-std.org target=_blank>open-std</a></p><p><a href=https://gcc.gnu.org/onlinedocs/ target=_blank>GCC Docs</a></p><p><a href=https://clang.llvm.org/docs/ target=_blank>Clang Docs</a></p><p><a href=https://www.boost.org/libraries/ target=_blank>Boost Library Docs</a></p><p><a href=https://learn.microsoft.com/en-us/dotnet/csharp/ target=_blank>Microsoft Learn</a><p><a href=https://www.lua.org/ target=_blank>lua.org</a> |
<a href=https://www.luarocks.org/ target=_blank>luarocks.org</a> |
<a href=https://www.luajit.org/ target=_blank>luajit.org</a></p><p><a href=https://docs.unity3d.com/Manual/index.html target=_blank>Unity Manual</a> |
<a href=https://docs.unity3d.com/ScriptReference/index.html target=_blank>Unity API</a></p><p><a href=https://docs.unrealengine.com/ target=_blank>Unreal Engine Docs</a></p><p><a href=https://godotengine.org target=_blank>Godot</a> |
<a href=https://docs.godotengine.org/en/stable/ target=_blank>Godot Docs</a></p><p><a href=https://z-library.sk/ target=_blank>Z-Library</a></p><p><a href=https://docs.kernel.org/ target=_blank>Linux Kernel Docs</a></p><p><a href=https://www.gnu.org/ target=_blank>GNU</a></p><a href=https://archlinux.org/ target=_blank>ArchLinux</a><p><a href=https://help.ubuntu.com/ target=_blank>Ubuntu Doc</a> |
<a href=https://ubuntu.com/server/docs target=_blank>Ubuntu Server Guide</a></p><p><a href=https://www.vulkan.org/ target=_blank>Vulkan</a> |
<a href=https://docs.vulkan.org/ target=_blank>Vulkan Docs</a></p><p><a href=https://www.opengl.org/ target=_blank>OpenGL</a> |
<a href=https://registry.khronos.org/OpenGL target=_blank>OpenGL API</a> |
<a href=https://www.khronos.org/opengl/wiki/ target=_blank>OpenGL Wiki</a></p><p><a href=https://learn.microsoft.com/en-us/windows/win32/directx target=_blank>DirectX</a></p><p><a href=https://www.realtimerendering.com/ target=_blank>Real-Time Rendering</a></p><p><a href=https://www.pbr-book.org/ target=_blank>Physically Based Rendering</a></p><p><a href=https://www.scratchapixel.com/ target=_blank>Scratchapixel</a></p><p><a href=https://learnopengl.com/ target=_blank>LearnOpenGL</a></p><p><a href=https://raytracing.github.io/ target=_blank>Ray Tracing in One Weekend</a></p><p><a href=https://www.shadertoy.com/ target=_blank>Shadertoy</a></p><p><a href=https://arxiv.org/list/cs.GR/recent target=_blank>arXiv Graphics</a></p><p><a href=https://www.siggraph.org/ target=_blank>SIGGRAPH</a> |
<a href=https://dl.acm.org/conference/siggraph target=_blank>SIGGRAPH Digital Library</a></p><p><a href=https://git-scm.com/ target=_blank>Git</a> |
<a href=https://git-scm.com/doc target=_blank>Docs</a> |
<a href=https://git-scm.com/community target=_blank>Community</a></p></div></div></div><script src=/js/ref-window.js></script><article class=single_article><div class=title>Queue<div class=meta>Modified: 2025-12-31
| Author：ljf12825</div></div><div class=content><p>Queue(队列)</p><h2 id=基本特性>基本特性</h2><ul><li>FIFO原则：最先添加的元素最先被移除</li><li>两个主要操作端<ul><li>队尾(rear/back)：添加元素的位置</li><li>队头(front/head)：移除元素的位置</li></ul></li><li>约束：只能在两端操作，不能在中间插入或删除</li></ul><h3 id=逻辑结构>逻辑结构</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>┌─────────────────────────────────────────┐
</span></span><span style=display:flex><span>│                 Queue                   │
</span></span><span style=display:flex><span>├──────────┬──────┬──────┬──────┬─────────┤
</span></span><span style=display:flex><span>│   Front  │      │      │      │   Rear  │
</span></span><span style=display:flex><span>│  (Head)  │      │      │      │  (Tail) │
</span></span><span style=display:flex><span>├──────────┴──────┴──────┴──────┴─────────┤
</span></span><span style=display:flex><span>│   ^ 出队方向               入队方向 ^   │
</span></span><span style=display:flex><span>│   &lt;──────────────────────────────────── │
</span></span><span style=display:flex><span>└─────────────────────────────────────────┘
</span></span></code></pre></div><h3 id=状态演变>状态演变</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>初始状态（空队列）:
</span></span><span style=display:flex><span>┌───┬───┬───┬───┬───┬───┐
</span></span><span style=display:flex><span>│   │   │   │   │   │   │
</span></span><span style=display:flex><span>└───┴───┴───┴───┴───┴───┘
</span></span><span style=display:flex><span>^
</span></span><span style=display:flex><span>front = rear = 0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>入队元素 A:
</span></span><span style=display:flex><span>┌───┬───┬───┬───┬───┬───┐
</span></span><span style=display:flex><span>│ A │   │   │   │   │   │
</span></span><span style=display:flex><span>└───┴───┴───┴───┴───┴───┘
</span></span><span style=display:flex><span>↑      ^
</span></span><span style=display:flex><span>front  rear
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>入队元素 B, C:
</span></span><span style=display:flex><span>┌───┬───┬───┬───┬───┬───┐
</span></span><span style=display:flex><span>│ A │ B │ C │   │   │   │
</span></span><span style=display:flex><span>└───┴───┴───┴───┴───┴───┘
</span></span><span style=display:flex><span>^            ^
</span></span><span style=display:flex><span>front        rear
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>出队元素 A:
</span></span><span style=display:flex><span>┌───┬───┬───┬───┬───┬───┐
</span></span><span style=display:flex><span>│   │ B │ C │   │   │   │
</span></span><span style=display:flex><span>└───┴───┴───┴───┴───┴───┘
</span></span><span style=display:flex><span>     ^       ^
</span></span><span style=display:flex><span>    front   rear
</span></span></code></pre></div><h2 id=操作>操作</h2><ul><li>入队(enqueue)<ul><li>在队尾添加元素，时间复杂度O(1)</li></ul></li><li>出队(dequeue)<ul><li>从队头移除并返回元素，时间复杂度O(1)</li></ul></li><li>查看队头元素，不移除(peek)<ul><li>时间复杂度：O(1)</li></ul></li><li>检查队列是否为空</li><li>返回队列中元素数量</li></ul><h2 id=实现>实现</h2><h3 id=基本队列naive-queue>基本队列(Naive Queue)</h3><h4 id=基于数组的实现>基于数组的实现</h4><p>这是一种很直观的做法，但是非常不推荐\</p><p>实现方式</p><ul><li>用数组<code>arr[N]</code>存储元素</li><li><code>front</code>指向队头，<code>rear</code>指向队尾</li><li>入队：<code>arr[rear++] = x</code></li><li>出队：返回<code>arr[front++]</code></li></ul><p>操作很简单，但是会造成以下问题</p><ul><li>空间浪费<ul><li>出队操作后，<code>front</code>会不断右移</li><li>数组前面的空间空了，但无法复用</li><li>例如：容量10,入队10个，出队5个，数组前半部分空了，但<code>rear</code>还在10 -> 后续最多只能再放0个元素</li></ul></li><li>低效的解决方式<ul><li>可以每次出队后，把数组前半部分的元素整体向左移动</li><li>代价高：<code>O(n)</code>每次出队 -> 很慢</li></ul></li></ul><p>这种做法仅适用于理解队列状态变化<br>工业级基于数组的实现是Circular Queue</p><h4 id=基于链表的实现>基于链表的实现</h4><p>这是正统的做法</p><p>特点</p><ul><li>enqueue：O(1)</li><li>dequeue：O(1)</li><li>不需要扩容</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>head -&gt; [A] -&gt; [B] -&gt; [C] -&gt; null
</span></span></code></pre></div><h3 id=双端队列deque>双端队列(Deque)</h3><p>Deque(Double Ended Queue)，可以在队头和队尾进行插入和删除操作的数据结构</p><table><thead><tr><th>操作</th><th>含义</th><th>时间复杂度</th></tr></thead><tbody><tr><td><code>push_front</code></td><td>从头部插入</td><td>O(1)</td></tr><tr><td><code>push_back</code></td><td>从尾部插入</td><td>O(1)</td></tr><tr><td><code>pop_front</code></td><td>从头部删除</td><td>O(1)</td></tr><tr><td><code>pop_back</code></td><td>从尾部删除</td><td>O(1)</td></tr></tbody></table><h4 id=逻辑结构-1>逻辑结构</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>┌─────────────────────────────────────────┐
</span></span><span style=display:flex><span>│               Deque                     │
</span></span><span style=display:flex><span>├───────┬─────────┬─────────┬─────────────┤
</span></span><span style=display:flex><span>│ Front │         │         │     Rear    │
</span></span><span style=display:flex><span>│ (Head)│         │         │    (Tail)   │
</span></span><span style=display:flex><span>├───────┴─────────┴─────────┴─────────────┤
</span></span><span style=display:flex><span>│  ← 出/入队方向        出/入队方向 →     │
</span></span><span style=display:flex><span>└─────────────────────────────────────────┘
</span></span></code></pre></div><h4 id=状态演变-1>状态演变</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>初始状态:
</span></span><span style=display:flex><span>┌───┬───┬───┬───┬───┐
</span></span><span style=display:flex><span>│   │   │   │   │   │
</span></span><span style=display:flex><span>└───┴───┴───┴───┴───┘
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>从前端添加 X，从后端添加 Y:
</span></span><span style=display:flex><span>┌───┬───┬───┬───┬───┐
</span></span><span style=display:flex><span>│ X │   │   │   │ Y │
</span></span><span style=display:flex><span>└───┴───┴───┴───┴───┘
</span></span><span style=display:flex><span> ↑               ↑
</span></span><span style=display:flex><span>front          rear
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>继续从前端添加 A，从后端添加 B:
</span></span><span style=display:flex><span>┌───┬───┬───┬───┬───┐
</span></span><span style=display:flex><span>│ A │ X │   │ Y │ B │
</span></span><span style=display:flex><span>└───┴───┴───┴───┴───┘
</span></span><span style=display:flex><span> ↑           ↑
</span></span><span style=display:flex><span>front      rear
</span></span></code></pre></div><h4 id=实现-1>实现</h4><h5 id=双向链表实现>双向链表实现</h5><h6 id=结构>结构</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>node &lt;-&gt; node &lt;-&gt; node
</span></span></code></pre></div><h6 id=优点>优点</h6><ul><li>实现简单</li><li>任意长度</li><li>插入删除绝对O(1)</li></ul><h6 id=缺点>缺点</h6><ul><li>每个节点两个指针 -> 内存大</li><li>cache miss 非常严重</li><li>实际性能差</li></ul><p>高性能场景不会使用这个版本</p><h5 id=循环数组>循环数组</h5><p>这是最常见的手写实现</p><h6 id=核心思想>核心思想</h6><p>用一个数组 + 两个索引</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>[ _ _ A B C D _ _ ]
</span></span><span style=display:flex><span>      ↑       ↑
</span></span><span style=display:flex><span>    head    tail
</span></span></code></pre></div><p>索引取模</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span>next <span style=color:#ff79c6>=</span> (i <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>%</span> capacity;
</span></span></code></pre></div><h6 id=结构-1>结构</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>buffer[]
</span></span><span style=display:flex><span>head index
</span></span><span style=display:flex><span>tail index
</span></span><span style=display:flex><span>size
</span></span></code></pre></div><h6 id=优点-1>优点</h6><ul><li>连续内存</li><li>cache 极友好</li><li>实现简单</li><li>实际工程最常用</li></ul><h6 id=缺点-1>缺点</h6><ul><li>需要扩容</li><li>扩容需要整体搬移</li></ul><h5 id=stl风格分段数组>STL风格分段数组</h5><p>这是<code>std::deque</code>的真实实现方式</p><p>结构类似这样</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-text data-lang=text><span style=display:flex><span>[block][block][block][block]
</span></span><span style=display:flex><span>   ↓      ↓
</span></span><span style=display:flex><span> [64]   [64]
</span></span></code></pre></div><p>本质是<code>指针数组 -> 每个指针指向一个小块连续内存</code></p><h6 id=优点-2>优点</h6><ul><li>两端扩容不用整体搬迁</li><li>连续块 + 灵活</li><li>综合性能最强</li></ul><h6 id=缺点-2>缺点</h6><ul><li>实现复杂</li><li>手写成本高</li></ul><h4 id=使用场景>使用场景</h4><p>Deque的接口简单，底层实现高度工程化<br>适合用于两端高频操作的场景<br>Deque是系统级最重要的数据结构之一<br>简单程度像队列，工程价值像内存管理器<br>算法领域Deque是万金油</p><p>不该使用Deque的场景</p><ul><li>只尾部push/pop -> vector</li><li>只FIFO -> queue</li><li>需要随机访问 -> vector</li><li>任意位置插删 -> list</li><li>按优先级 -> priority_queue</li></ul><p>一旦开始用Deque的中间索引访问元素，说明选错结构了</p><h3 id=优先队列priority-queue>优先队列(Priority Queue)</h3><h3 id=循环队列circular-queue>循环队列(Circular Queue)</h3><h3 id=阻塞队列blocking-queue>阻塞队列(Blocking Queue)</h3><h2 id=应用场景>应用场景</h2><ol><li>BFS</li><li>生产者/消费者模型</li><li>任务调度/消息系统</li><li>单调队列</li></ol></div><nav class=post-nav><a href=/leftbrain/file/datastrcture/priorityqueue/ class=hover:underline>pre: Priority Queue</a>
<a href=/leftbrain/file/datastrcture/skiplist/ class=hover:underline>next: Skip List</a></nav></article><aside class=toc><h3>TOC</h3><nav id=TableOfContents><ul><li><ul><li><a href=#基本特性>基本特性</a><ul><li><a href=#逻辑结构>逻辑结构</a></li><li><a href=#状态演变>状态演变</a></li></ul></li><li><a href=#操作>操作</a></li><li><a href=#实现>实现</a><ul><li><a href=#基本队列naive-queue>基本队列(Naive Queue)</a><ul><li><a href=#基于数组的实现>基于数组的实现</a></li><li><a href=#基于链表的实现>基于链表的实现</a></li></ul></li><li><a href=#双端队列deque>双端队列(Deque)</a><ul><li><a href=#逻辑结构-1>逻辑结构</a></li><li><a href=#状态演变-1>状态演变</a></li><li><a href=#实现-1>实现</a><ul><li><a href=#双向链表实现>双向链表实现</a><ul><li><a href=#结构>结构</a></li><li><a href=#优点>优点</a></li><li><a href=#缺点>缺点</a></li></ul></li><li><a href=#循环数组>循环数组</a><ul><li><a href=#核心思想>核心思想</a></li><li><a href=#结构-1>结构</a></li><li><a href=#优点-1>优点</a></li><li><a href=#缺点-1>缺点</a></li></ul></li><li><a href=#stl风格分段数组>STL风格分段数组</a><ul><li><a href=#优点-2>优点</a></li><li><a href=#缺点-2>缺点</a></li></ul></li></ul></li><li><a href=#使用场景>使用场景</a></li></ul></li><li><a href=#优先队列priority-queue>优先队列(Priority Queue)</a></li><li><a href=#循环队列circular-queue>循环队列(Circular Queue)</a></li><li><a href=#阻塞队列blocking-queue>阻塞队列(Blocking Queue)</a></li></ul></li><li><a href=#应用场景>应用场景</a></li></ul></li></ul></nav></aside><script defer src=/js/scrollspy.js></script><script type=module>
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ 
    startOnLoad: true, theme: "default" });
</script><footer><div class=container><p>© 2026 Jeff Lee(ljf12825). All rights reserved |
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>Article: CC BY-NC-SA 4.0</a> |
<a href=https://creativecommons.org/licenses/by-sa/4.0/>Content: CC BY-SA 4.0</a> |
<a href=https://opensource.org/licenses/MIT>Code: MIT License</a> |
<a href=/LICENSES.md>Full License</a></p></div></footer></body></html>